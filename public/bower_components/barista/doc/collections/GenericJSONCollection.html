<!DOCTYPE html><html lang="en"><head><title>collections/GenericJSONCollection</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../"><meta name="groc-document-path" content="collections/GenericJSONCollection"><meta name="groc-project-path" content="source/collections/GenericJSONCollection.js"><link rel="stylesheet" type="text/css" media="all" href="../assets/style.css"><script type="text/javascript" src="../assets/behavior.js"></script><body><div id="meta"><div class="file-path">source/collections/GenericJSONCollection.js</div></div><div id="document"><div class="segment"><div class="comments"><div class="wrapper"><h1 id="genericjsoncollection"><strong>GenericJSONCollection</strong></h1>

<p>A Backbone.Collection that represents and arbitrary set of objects stored
in a JSON file. The JSON file is assumed to contain a top level array
containing objects.  Each object in the array is modeled as a base
Backbone.Model inside of the collection</p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>optional arguments:</p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><ol>
<li>{Backbone.Model}  <strong>model</strong>  the model used for the collection objects. defaults to <em>PertModel</em></li>
<li>{String}  <strong>url</strong>  the url from which model data is fetched. defaults  to <em>'data.json'</em></li>
<li>{String}  <strong>skip</strong>  the skip parameter used in method calls when the collection is updated. defaults to <em>0</em></li>
<li>{Boolean}  <strong>isLoading</strong>  indicates wether or not the collection is in the middle of a fetch operation. defaults to <em>false</em></li>
</ol></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><pre><code>pert_collection = new PertCollection({model: PertModel,
                                    url: 'http://api.lincscloud.org/a2/pertinfo?callback=?',
                                    skip: 0,
                                    isLoading: false});
</code></pre></div></div><div class="code"><div class="wrapper"><span class="nx">Barista</span><span class="p">.</span><span class="nx">Collections</span><span class="p">.</span><span class="nx">GenericJSONCollection</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h3 id="model">model</h3>

<p>the model used for collection objects</p></div></div><div class="code"><div class="wrapper">  <span class="nx">model</span><span class="o">:</span> <span class="nx">Barista</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">PertModel</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h4 id="url">url</h4>

<p>the url from which model data is fetched</p></div></div><div class="code"><div class="wrapper">    <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;data.json&#39;</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h4 id="skip">skip</h4>

<p>the skip parameter used in api calls when the collection is updated. </p></div></div><div class="code"><div class="wrapper">    <span class="nx">skip</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h4 id="isloading">isLoading</h4>

<p>indicates wether or not the collection is in the middle of a fetch operation. </p></div></div><div class="code"><div class="wrapper">    <span class="nx">isLoading</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h3 id="maxcount">maxCount</h3>

<p>the maximum size of the collection. defaults to Infinity</p></div></div><div class="code"><div class="wrapper">    <span class="nx">maxCount</span><span class="o">:</span> <span class="kc">Infinity</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><h2 id="getdata">getData</h2>

<p><code>GenericJSONCollection.getData(search_string,search_type,limit)</code></p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Gets additional data from the specified url and stores them as models in the collection</p></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>arguments</p>

<ol>
<li>{string}  <strong>search_string</strong>  the string on which a regex search into the api at the collections url will be performed, defaults to <em>""</em></li>
<li>{string}  <strong>search_type</strong>  the type of search that will be performed, defaults to <em>"single"</em></li>
<li>{number}  <strong>limit</strong>  the number of models to be fetched, defaults to <em>30</em></li>
</ol></div></div><div class="code"><div class="wrapper">    <span class="nx">getData</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">search_string</span><span class="p">,</span><span class="nx">search_type</span><span class="p">,</span><span class="nx">limit</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set <strong>isLoading</strong> to true so we don't constantly make api calls before the data comes back</p></div></div><div class="code"><div class="wrapper">        <span class="k">this</span><span class="p">.</span><span class="nx">isLoading</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>store the value of <strong>search_string</strong>, <strong>search_type</strong>, and <strong>limit</strong> on the collection object</p></div></div><div class="code"><div class="wrapper">        <span class="k">this</span><span class="p">.</span><span class="nx">search_string</span> <span class="o">=</span> <span class="p">(</span><span class="nx">search_string</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">?</span> <span class="nx">search_string</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">search_type</span> <span class="o">=</span> <span class="p">(</span><span class="nx">search_type</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">?</span> <span class="nx">search_type</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">limit</span> <span class="o">=</span> <span class="p">(</span><span class="nx">limit</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">)</span> <span class="o">?</span> <span class="nx">limit</span> <span class="o">:</span> <span class="mi">30</span><span class="p">;</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>fetch data from the given url.  If the url attribute is a string, fetch data via an ajax
request. Read each returned item in the response into a new PertModel.  If it is an object, 
assume it is an array of data and read each array item into a new PertModel</p></div></div><div class="code"><div class="wrapper">        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">){</span><span class="nx">self</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">Barista</span><span class="p">.</span><span class="nx">Models</span><span class="p">.</span><span class="nx">PertModel</span><span class="p">(</span><span class="nx">o</span><span class="p">));});</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set the collection's maxCount attribute to the length of the collection</p></div></div><div class="code"><div class="wrapper">            <span class="k">this</span><span class="p">.</span><span class="nx">maxCount</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
            <span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">res</span><span class="p">){</span>
                <span class="nx">res</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">o</span><span class="p">){</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">new</span> <span class="nx">PertModel</span><span class="p">(</span><span class="nx">o</span><span class="p">));</span>
                <span class="p">});</span></div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>set the collection's maxCount attribute to the length of the collection</p></div></div><div class="code"><div class="wrapper">                <span class="k">this</span><span class="p">.</span><span class="nx">maxCount</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
            <span class="p">});</span>
        <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span></div></div></div></div></body></html>