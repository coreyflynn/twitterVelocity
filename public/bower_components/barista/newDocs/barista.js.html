<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width" charset="utf-8">
    <title>barista</title>
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap.css">
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/bootstrap-responsive.css">
    <link rel="stylesheet" href="http://getbootstrap.com/2.3.2/assets/css/docs.css">
    <link rel="stylesheet" href="./doxx_template.css">
    <link href="http://fonts.googleapis.com/css?family=Roboto+Slab|Open+Sans" rel="stylesheet" type="text/css">
    <script src="jquery-2.1.3.min.js"></script>
    <script src="collapse.js" type="text/javascript"></script>
    <script type="text/javascript">
      $(document).ready(function(){
       $(document).on("click", "span", (function(e) {
         $(e.target).find("pre").toggle(400);
       }));
      });
    </script>
    <style>
      body > .navbar .brand {
        float:left;
        text-shadow: rgba(255, 255, 255, 0.0980392) 0px 1px 0px, rgba(255, 255, 255, 0.4) 0px 0px 30px;
        color: white;
        margin-left:0px;
        font-weight:normal;
      }
      .bs-docs-sidenav.affix {
        box-shadow: 0 0 20px 1px rgba(0, 0, 0, 0.5);
        z-index: 10;
      }
      .bs-docs-sidenav i{
        width: 8px;
        height: 8px;
        padding: 0px;
        margin: 0px;
        display: inline-block;
        margin-right:0.5em;
      }
      .bs-docs-sidenav > li > a {
          word-wrap: break-word;
      }
      .bs-docs-sidenav > li:first-child > a {
        border-top-right-radius: 6px;
        border-top-left-radius: 6px;
      }
      code[class*="language-"],pre[class*="language-"]{color:black;text-shadow:0 1px white;font-family:Consolas,Monaco,'Andale Mono',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*="language-"]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*="language-"],pre[class*="language-"]{background:#f5f2f0}:not(pre)>code[class*="language-"]{padding:.1em;border-radius:.3em}.token.comment,.token.prolog,.token.doctype,.token.cdata{color:slategray}.token.punctuation{color:#999}.namespace{opacity:.7}.token.property,.token.tag,.token.boolean,.token.number{color:#905}.token.selector,.token.attr-name,.token.string{color:#690}.token.operator,.token.entity,.token.url,.language-css .token.string,.style .token.string{color:#a67f59;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.regex,.token.important{color:#e90}.token.important{font-weight:bold}.token.entity{cursor:help}
      div.description {margin: 14px 0; padding-top: 14px; border-bottom:1px solid #eee; }
      .tags {}
      .ctx-type {
        display:inline-block;
        margin-right:0.5em;
        //- float:right; margin-top:8px
      }
      footer iframe{vertical-align:middle;}
    </style>
  </head>
  <body data-spy="scroll" data-target=".scrollspy">
    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container"><a class="brand">Doxx</a>
          <div class="nav-collapse collapse">
            <ul class="nav pull-right sponsored"></ul>
          </div>
        </div>
      </div>
    </div>
    <!-- getting rid of this gets rid of the entire header area-->
    <!-- removing subhead class centers everything-->
    <!-- @todo look into using a different image for the header-->
    <header id="overview" class="jumbotron">
      <div class="container">
        <h1>barista</h1>
        <p class="lead"></p>
      </div>
    </header>
    <div class="container">
      <div class="row">
        <div class="span3 bs-docs-sidebar">
          <ul class="nav nav-list bs-docs-sidenav affix-top">
            <li><a href="index.html" class="upper">Main</a>
            </li>
            <li><a href="afterword.js.html" class="upper">afterword</a>
            </li>
            <li><a href="preamble.js.html" class="upper">preamble</a>
            </li>
            <li><a href="tile.js.html" class="upper">tile</a>
            </li>
            <li><a onclick="listCollapse(this, 'Collections')" class="lower_outer">Collections &darr;
                <ul style="display: none" class="mycoll">
                  <li class="inner"><a href="collections/AnalysisHistoryCollection.js.html" class="lower_inner">AnalysisHistoryCollection  </a></li>
                  <li class="inner"><a href="collections/CellCollection.js.html" class="lower_inner">CellCollection  </a></li>
                  <li class="inner"><a href="collections/GenericJSONCollection.js.html" class="lower_inner">GenericJSONCollection  </a></li>
                  <li class="inner"><a href="collections/PertCollection.js.html" class="lower_inner">PertCollection  </a></li>
                  <li class="inner"><a href="collections/SignatureCollection.js.html" class="lower_inner">SignatureCollection  </a></li>
                  <li class="inner"><a href="collections/SummlyResultCollection.js.html" class="lower_inner">SummlyResultCollection  </a></li>
                </ul></a>
            </li>
            <li><a onclick="listCollapse(this, 'Datasets')" class="lower_outer">Datasets &darr;
                <ul style="display: none" class="mycoll">
                  <li class="inner"><a href="datasets/CellHistologyDataset.js.html" class="lower_inner">CellHistologyDataset  </a></li>
                  <li class="inner"><a href="datasets/CellIDDataset.js.html" class="lower_inner">CellIDDataset  </a></li>
                  <li class="inner"><a href="datasets/CellLineageDataset.js.html" class="lower_inner">CellLineageDataset  </a></li>
                  <li class="inner"><a href="datasets/CellMutationDataset.js.html" class="lower_inner">CellMutationDataset  </a></li>
                  <li class="inner"><a href="datasets/CompoundPertINameDataset.js.html" class="lower_inner">CompoundPertINameDataset  </a></li>
                  <li class="inner"><a href="datasets/GeneticPertINameDataset.js.html" class="lower_inner">GeneticPertINameDataset  </a></li>
                  <li class="inner"><a href="datasets/JobIDDataset.js.html" class="lower_inner">JobIDDataset  </a></li>
                  <li class="inner"><a href="datasets/JobNameDataset.js.html" class="lower_inner">JobNameDataset  </a></li>
                  <li class="inner"><a href="datasets/JobStatusDataset.js.html" class="lower_inner">JobStatusDataset  </a></li>
                  <li class="inner"><a href="datasets/P100PertINameDataset.js.html" class="lower_inner">P100PertINameDataset  </a></li>
                  <li class="inner"><a href="datasets/PRISMPertINameDataset.js.html" class="lower_inner">PRISMPertINameDataset  </a></li>
                  <li class="inner"><a href="datasets/PertINameDataset.js.html" class="lower_inner">PertINameDataset  </a></li>
                  <li class="inner"><a href="datasets/ToolIDDataset.js.html" class="lower_inner">ToolIDDataset  </a></li>
                  <li class="inner"><a href="datasets/UserIDDataset.js.html" class="lower_inner">UserIDDataset  </a></li>
                </ul></a>
            </li>
            <li><a onclick="listCollapse(this, 'Models')" class="lower_outer">Models &darr;
                <ul style="display: none" class="mycoll">
                  <li class="inner"><a href="models/AnalysisHistoryModel.js.html" class="lower_inner">AnalysisHistoryModel  </a></li>
                  <li class="inner"><a href="models/BarPlotModel.js.html" class="lower_inner">BarPlotModel  </a></li>
                  <li class="inner"><a href="models/CellCountModel.js.html" class="lower_inner">CellCountModel  </a></li>
                  <li class="inner"><a href="models/CellModel.js.html" class="lower_inner">CellModel  </a></li>
                  <li class="inner"><a href="models/CompoundDetailModel.js.html" class="lower_inner">CompoundDetailModel  </a></li>
                  <li class="inner"><a href="models/GeneDetailModel.js.html" class="lower_inner">GeneDetailModel  </a></li>
                  <li class="inner"><a href="models/GenericCountModel.js.html" class="lower_inner">GenericCountModel  </a></li>
                  <li class="inner"><a href="models/GenericMongoModel.js.html" class="lower_inner">GenericMongoModel  </a></li>
                  <li class="inner"><a href="models/HeatmapModel.js.html" class="lower_inner">HeatmapModel  </a></li>
                  <li class="inner"><a href="models/PertCellBreakdownModel.js.html" class="lower_inner">PertCellBreakdownModel  </a></li>
                  <li class="inner"><a href="models/PertCountModel.js.html" class="lower_inner">PertCountModel  </a></li>
                  <li class="inner"><a href="models/PertDetailModel.js.html" class="lower_inner">PertDetailModel  </a></li>
                  <li class="inner"><a href="models/PertModel.js.html" class="lower_inner">PertModel  </a></li>
                  <li class="inner"><a href="models/ScatterPlotModel.js.html" class="lower_inner">ScatterPlotModel  </a></li>
                  <li class="inner"><a href="models/SigCountModel.js.html" class="lower_inner">SigCountModel  </a></li>
                  <li class="inner"><a href="models/SignatureModel.js.html" class="lower_inner">SignatureModel  </a></li>
                  <li class="inner"><a href="models/SummlyResultModel.js.html" class="lower_inner">SummlyResultModel  </a></li>
                  <li class="inner"><a href="models/TickModel.js.html" class="lower_inner">TickModel  </a></li>
                  <li class="inner"><a href="models/sequenceModel.js.html" class="lower_inner">sequenceModel  </a></li>
                </ul></a>
            </li>
            <li><a onclick="listCollapse(this, 'Utils')" class="lower_outer">Utils &darr;
                <ul style="display: none" class="mycoll">
                  <li class="inner"><a href="utils/CMapTypeAlias.js.html" class="lower_inner">CMapTypeAlias  </a></li>
                  <li class="inner"><a href="utils/NumbersToSubscript.js.html" class="lower_inner">NumbersToSubscript  </a></li>
                  <li class="inner"><a href="utils/arrayAverage.js.html" class="lower_inner">arrayAverage  </a></li>
                  <li class="inner"><a href="utils/getEmSizeInPixels.js.html" class="lower_inner">getEmSizeInPixels  </a></li>
                  <li class="inner"><a href="utils/getQueryVariable.js.html" class="lower_inner">getQueryVariable  </a></li>
                  <li class="inner"><a href="utils/numberWithCommas.js.html" class="lower_inner">numberWithCommas  </a></li>
                  <li class="inner"><a href="utils/setAPIPrefilter.js.html" class="lower_inner">setAPIPrefilter  </a></li>
                  <li class="inner"><a href="utils/setAPIURL.js.html" class="lower_inner">setAPIURL  </a></li>
                  <li class="inner"><a href="utils/setUserKey.js.html" class="lower_inner">setUserKey  </a></li>
                </ul></a>
            </li>
            <li><a onclick="listCollapse(this, 'Views')" class="lower_outer">Views &darr;
                <ul style="display: none" class="mycoll">
                  <li class="inner"><a href="views/BarPlotView.js.html" class="lower_inner">BarPlotView  </a></li>
                  <li class="inner"><a href="views/BaristaBaseView.js.html" class="lower_inner">BaristaBaseView  </a></li>
                  <li class="inner"><a href="views/BaristaCardView.js.html" class="lower_inner">BaristaCardView  </a></li>
                  <li class="inner"><a href="views/BaristaUserCardView.js.html" class="lower_inner">BaristaUserCardView  </a></li>
                  <li class="inner"><a href="views/BubbleView.js.html" class="lower_inner">BubbleView  </a></li>
                  <li class="inner"><a href="views/CMapFooterView.js.html" class="lower_inner">CMapFooterView  </a></li>
                  <li class="inner"><a href="views/CMapHeaderView.js.html" class="lower_inner">CMapHeaderView  </a></li>
                  <li class="inner"><a href="views/CMapNavigationView.js.html" class="lower_inner">CMapNavigationView  </a></li>
                  <li class="inner"><a href="views/CellSearchBar.js.html" class="lower_inner">CellSearchBar  </a></li>
                  <li class="inner"><a href="views/CompoundDetailView.js.html" class="lower_inner">CompoundDetailView  </a></li>
                  <li class="inner"><a href="views/CompoundSearchBar.js.html" class="lower_inner">CompoundSearchBar  </a></li>
                  <li class="inner"><a href="views/FlatTreeMapView.js.html" class="lower_inner">FlatTreeMapView  </a></li>
                  <li class="inner"><a href="views/GenericCountView.js.html" class="lower_inner">GenericCountView  </a></li>
                  <li class="inner"><a href="views/GridView.js.html" class="lower_inner">GridView  </a></li>
                  <li class="inner"><a href="views/HTMLCellView.js.html" class="lower_inner">HTMLCellView  </a></li>
                  <li class="inner"><a href="views/HeatMapView.js.html" class="lower_inner">HeatMapView  </a></li>
                  <li class="inner"><a href="views/LDMapView.js.html" class="lower_inner">LDMapView  </a></li>
                  <li class="inner"><a href="views/PertCountView.js.html" class="lower_inner">PertCountView  </a></li>
                  <li class="inner"><a href="views/PertDetailView.js.html" class="lower_inner">PertDetailView  </a></li>
                  <li class="inner"><a href="views/PertSearchBar.js.html" class="lower_inner">PertSearchBar  </a></li>
                  <li class="inner"><a href="views/PlatformSummaryView.js.html" class="lower_inner">PlatformSummaryView  </a></li>
                  <li class="inner"><a href="views/ScatterPlotView.js.html" class="lower_inner">ScatterPlotView  </a></li>
                  <li class="inner"><a href="views/TagListView.js.html" class="lower_inner">TagListView  </a></li>
                  <li class="inner"><a href="views/TickView.js.html" class="lower_inner">TickView  </a></li>
                  <li class="inner"><a href="views/ViolinPlotView.js.html" class="lower_inner">ViolinPlotView  </a></li>
                  <li class="inner"><a href="views/sequenceView.js.html" class="lower_inner">sequenceView  </a></li>
                </ul></a>
            </li>
          </ul>
        </div>
        <div class="span9">
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'CellHistology',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: &quot;&quot;,</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use cellinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/cellinfo?',
		'q={&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]},&quot;cell_histology&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
		'&amp;l=10',
		'&amp;s={&quot;cell_id&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract cell histology from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its cell_histology and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.cell_histology);
		object_map[element.cell_histology] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		_.extend(datum,{
			type: 'Cell Histology',
			search_column: 'cell_histology',
			color: '#BB4D8A',
		});
		datum_list.push(datum);
	});

	// return the processed list of datums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Cellular Contexts available<br />in the Connectivity Map<br />CellIDDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets<br />in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ CellID:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'CellID',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use cellinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url, query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/cellinfo?',
		'q={&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]},&quot;cell_id&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
		'&amp;l=10',
		'&amp;s={&quot;cell_id&quot;:1}'].join('')
} ,

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract cell id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its cell_id and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.cell_id);
		object_map[element.cell_id] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		_.extend(datum,{
			type: 'Cell ID',
			search_column: 'cell_id',
			color: '#CC79A7',
		});
		datum_list.push(datum);
	});

	// return the processed list of datums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Cellular Contexts available<br />in the Connectivity Map<br />CellLineageDataset is typically not used directly, rather it&#39;s content is extracted from<br />Barista.Datasets in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ CellLineage:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'CellLineage',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use cellinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/cellinfo?',
		'q={&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]},&quot;cell_lineage&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
		'&amp;l=10',
		'&amp;s={&quot;cell_id&quot;:1}'].join('');
} ,

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract cell lineage from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its cell_lineage and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.cell_lineage);
		object_map[element.cell_lineage] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		_.extend(datum,{
			type: 'Cell Lineage',
			search_column: 'cell_lineage',
			color: '#DDA6C4',
		});
		datum_list.push(datum);
	});

	// return the processed list of datums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Cellular mutation<br />annotations available in the Connectivity Map<br />CellMutationDataset is typically not used directly, rather it&#39;s content is extracted from<br />Barista.Datasets in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ CellMutation:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'CellMutation',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use cellinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/cellinfo?',
		'q={&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]}}',
		'&amp;d=mutations'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract mutation data from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = response;

	// filter the list based on the query.  self comes from the closure in the view that calls the
	// dataset. It shold be a reference to the view that is consuming the dataset.  That view should
	// have a typeahead elment in it somewhere
	var re = new RegExp($(&quot;.typeahead&quot;,self.div_string).val(),&quot;i&quot;);
	auto_data = _.filter(auto_data,function(mutation){return re.test(mutation);});

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: item
		}
		_.extend(datum,{
			type: 'Cell Mutation',
			search_column: 'mutations',
			color: '#999999',
		});
		datum_list.push(datum);
	});

	// return the processed list of datums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Perturbation IDs available<br />in the Connectivity Map<br />CompoundPertINameDataset is typically not used directly, rather it&#39;s content is extracted from<br />Barista.Datasets in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ CompoundPertIName:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'CompoundPertIName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use pertinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/pertinfo?',
		'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}, &quot;pert_type&quot;:&quot;trt_cp&quot;}',
		'&amp;f={&quot;pert_iname&quot;:1,&quot;pert_type&quot;:1}',
		'&amp;l=100',
		'&amp;s={&quot;pert_iname&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract pert_iname from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var genetic_types = [&quot;trt_sh&quot;,&quot;trt_oe&quot;,&quot;trt_sh.cgs&quot;];
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// add cell lines if required
	// if (self.match_cell_lines){
	// 	auto_data = auto_data.concat(self.cell_lines);
	// }

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		if (genetic_types.indexOf(object_map[item].pert_type) != -1){
			_.extend(datum,{
				type: 'Genetic Reagent',
				color: '#0072B2',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_cp' ){
			_.extend(datum,{
				type: 'Chemical Reagent',
				color: '#E69F00',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_sh.css' ){
			_.extend(datum,{
				type: 'Seed Sequence',
				color: '#009E73',
			});
			datum_list.push(datum);
			return datum_list;
		}else{
			_.extend(datum,{
				type: object_map[item].pert_type,
				color: '#999',
			});
			datum_list.push(datum);
			return datum_list;
		}
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Perturbation IDs available<br />in the Connectivity Map<br />GeneticPertINameDataset is typically not used directly, rather it&#39;s content is extracted from<br />Barista.Datasets in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ GeneticPertIName:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'GeneticPertIName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use pertinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/pertinfo?',
		'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}, &quot;pert_type&quot;:{&quot;$in&quot;:[&quot;trt_sh&quot;,&quot;trt_oe&quot;,&quot;trt_oe.mut&quot;]}}',
		'&amp;f={&quot;pert_iname&quot;:1,&quot;pert_type&quot;:1}',
		'&amp;l=100',
		'&amp;s={&quot;pert_iname&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract pert_iname from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var genetic_types = [&quot;trt_sh&quot;,&quot;trt_oe&quot;,&quot;trt_sh.cgs&quot;];
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// add cell lines if required
	// if (self.match_cell_lines){
	// 	auto_data = auto_data.concat(self.cell_lines);
	// }

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		if (genetic_types.indexOf(object_map[item].pert_type) != -1){
			_.extend(datum,{
				type: 'Genetic Reagent',
				color: '#0072B2',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_cp' ){
			_.extend(datum,{
				type: 'Chemical Reagent',
				color: '#E69F00',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_sh.css' ){
			_.extend(datum,{
				type: 'Seed Sequence',
				color: '#009E73',
			});
			datum_list.push(datum);
			return datum_list;
		}else{
			_.extend(datum,{
				type: object_map[item].pert_type,
				color: '#999',
			});
			datum_list.push(datum);
			return datum_list;
		}
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for job IDs available in the<br />Connectivity Map<br />JobIDDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets in<br />views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
    { JobID:
            {</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'JobID',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
    url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use compute_status with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
    query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
    return [Barista.APIURL + '/compute_status?',
          'q={&quot;job_id&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
          '&amp;l=10',
          '&amp;s={&quot;job_id&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract job id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
            var datum_list = [];
            var auto_data = [];
            var object_map = {};

            // for each item, pull out its job_id and use that for the
            // autocomplete value. Build a datum of other relevant data
            // for use in suggestion displays
            response.forEach(function(element){
                auto_data.push(element.job_id);
                object_map[element.job_id] = element;
            });

            // make sure we only show unique items
            auto_data = _.uniq(auto_data);

            // build a list of datum objects
            auto_data.forEach(function(item){
                var datum = {
                    value: item,
                    tokens: [item],
                    data: object_map[item]
                }
                _.extend(datum,{
                    type: 'Job',
                    search_column: 'job_id',
                    color: '#BDBDBD',
                });
                datum_list.push(datum);
            });

            // return the processed list of datums for the autocomplete
            return datum_list;
        }
    }
}
    }
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for job IDs available in the<br />Connectivity Map<br />JobNameDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets<br />in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
    { JobName:
            {</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'JobName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
    url: '',</code></pre></span>
          <section id="remote">
            <h1>remote</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>remote()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use compute_status with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">remote: function(url,query){
    query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
    return [Barista.APIURL + '/compute_status?',
          'q={&quot;params.rpt&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
          '&amp;l=10',
          '&amp;s={&quot;job_id&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract job id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
            var datum_list = [];
            var auto_data = [];
            var object_map = {};

            // for each item, pull out its job_id and use that for the
            // autocomplete value. Build a datum of other relevant data
            // for use in suggestion displays
            response.forEach(function(element){
                auto_data.push(element.params.rpt);
                object_map[element.params.rpt] = element;
            });

            // make sure we only show unique items
            auto_data = _.uniq(auto_data);

            // build a list of datum objects
            auto_data.forEach(function(item){
                var datum = {
                    value: item,
                    tokens: [item],
                    data: object_map[item]
                }
                _.extend(datum,{
                    type: 'Job Name',
                    search_column: 'params.rpt',
                    color: '#77A2A6',
                });
                datum_list.push(datum);
            });

            // return the processed list of datums for the autocomplete
            return datum_list;
        }
    }
}
    }
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for job Statuses available in the<br />Connectivity Map<br />JobStatusDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets<br />in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
    { JobStatus:
            {</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'JobStatus',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
    url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use compute_status with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
    query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
    return [Barista.APIURL + '/compute_status?',
          'q={&quot;status&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
          '&amp;l=10',
          '&amp;s={&quot;status&quot;:1}'].join('')
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract status from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
            var datum_list = [];
            var auto_data = [];
            var object_map = {};

            // for each item, pull out its status and use that for the
            // autocomplete value. Build a datum of other relevant data
            // for use in suggestion displays
            response.forEach(function(element){
                auto_data.push(element.status);
                object_map[element.status] = element;
            });

            // make sure we only show unique items
            auto_data = _.uniq(auto_data);

            // build a list of datum objects
            auto_data.forEach(function(item){
                var datum = {
                    value: item,
                    tokens: [item],
                    data: object_map[item]
                }
                _.extend(datum,{
                    type: 'Status',
                    search_column: 'status',
                    color: '#B14A4E',
                });
                datum_list.push(datum);
            });

            // return the processed list of datums for the autocomplete
            return datum_list;
        }
    }
}
    }
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for P100 Perturbation IDs available<br />in the Connectivity Map<br />P100PertINameDataset is typically not used directly, rather it&#39;s content is extracted from<br />Barista.Datasets in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ P100PertIName:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'P100PertIName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: #7bd9e4&quot;&gt;P100&lt;/span&gt;&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use profileinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return ['//prefix:8080/p100/v1/profileinfo?',
		'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
		'&amp;f={&quot;pert_iname&quot;:1}',
		'&amp;l=100',
		'&amp;s={&quot;pert_iname&quot;:1}'].join('');
},

dataType: 'jsonp',
/**
 * returns the processed list of data for the autocomplete
 * @param {array} response  array of data to extract pert_iname from
 */
filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// add cell lines if required
	// if (self.match_cell_lines){
	// 	auto_data = auto_data.concat(self.cell_lines);
	// }

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		_.extend(datum,{
			type: 'Chemical Reagent',
			color: '#E69F00',
		});
		datum_list.push(datum);
		return datum_list;
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}
			}
		}
	}
);

/**
 * An object that extends Barista.Datasets to specify a backing dataset for PRISM Perturbation IDs available
 * in the Connectivity Map
 * PRISMPertINameDataset is typically not used directly, rather it's content is extracted from
 * Barista.Datasets in views such as CMapSearchView
 */

Barista.Datasets = _.extend(Barista.Datasets,
	{ PRISMPertIName:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'PRISMPertIName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: #8387e6&quot;&gt;PRISM&lt;/span&gt;&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use profileinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/prism/v1/profileinfo?',
		'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
		'&amp;f={&quot;pert_iname&quot;:1}',
		'&amp;l=100',
		'&amp;s={&quot;pert_iname&quot;:1}'].join('')
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract pert_iname from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// add cell lines if required
	// if (self.match_cell_lines){
	// 	auto_data = auto_data.concat(self.cell_lines);
	// }

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		_.extend(datum,{
			type: 'Chemical Reagent',
			color: '#E69F00',
		});
		datum_list.push(datum);
		return datum_list;
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Perturbation IDs available in<br />the Connectivity Map<br />PertINameDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets<br />in views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
	{ PertIName:
			{</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'PertIName',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
	url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use pertinfo with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
	query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
	return [Barista.APIURL + '/a2/pertinfo?',
		'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}, &quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}',
		'&amp;f={&quot;pert_iname&quot;:1,&quot;pert_type&quot;:1}',
		'&amp;l=100',
		'&amp;s={&quot;pert_iname&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract pert_iname from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var genetic_types = [&quot;trt_sh&quot;,&quot;trt_oe&quot;,&quot;trt_sh.cgs&quot;];
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// add cell lines if required
	// if (self.match_cell_lines){
	// 	auto_data = auto_data.concat(self.cell_lines);
	// }

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		}
		if (genetic_types.indexOf(object_map[item].pert_type) != -1){
			_.extend(datum,{
				type: 'Genetic Reagent',
				color: '#0072B2',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_cp' ){
			_.extend(datum,{
				type: 'Chemical Reagent',
				color: '#E69F00',
			});
			datum_list.push(datum);
			return datum_list;
		}
		if (object_map[item].pert_type === 'trt_sh.css' ){
			_.extend(datum,{
				type: 'Seed Sequence',
				color: '#009E73',
			});
			datum_list.push(datum);
			return datum_list;
		}else{
			_.extend(datum,{
				type: object_map[item].pert_type,
				color: '#999',
			});
			datum_list.push(datum);
			return datum_list;
		}
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}
			}
		}
	}
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for Tool IDs available in the<br />Connectivity Map<br />ToolIDDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets in<br />views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
    { ToolID:
            {</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'ToolID',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
    url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use compute_status with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
    query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
    return [Barista.APIURL + '/compute_status?',
          'q={&quot;tool_id&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
          '&amp;l=10',
          '&amp;s={&quot;tool_id&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract tool id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
            var datum_list = [];
            var auto_data = [];
            var object_map = {};

            // for each item, pull out its tool_id and use that for the
            // autocomplete value. Build a datum of other relevant data
            // for use in suggestion displays
            response.forEach(function(element){
                auto_data.push(element.tool_id);
                object_map[element.tool_id] = element;
            });

            // make sure we only show unique items
            auto_data = _.uniq(auto_data);

            // build a list of datum objects
            auto_data.forEach(function(item){
                var datum = {
                    value: item,
                    tokens: [item],
                    data: object_map[item]
                }
                _.extend(datum,{
                    type: 'Tool',
                    search_column: 'tool_id',
                    color: '#005CF2',
                });
                datum_list.push(datum);
            });

            // return the processed list of datums for the autocomplete
            return datum_list;
        }
    }
}
    }
);</code></pre></span>
          <section id="Datasets">
            <h1>Datasets</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Datasets</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An object that extends Barista.Datasets to specify a backing dataset for user IDs available in the<br />Connectivity Map<br />UserIDDataset is typically not used directly, rather it&#39;s content is extracted from Barista.Datasets in<br />views such as CMapSearchView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Datasets = _.extend(Barista.Datasets,
    { UserID:
            {</code></pre></span>
          <section id="limit">
            <h1>limit</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>limit</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>only return 6 items at a time in the autocomplete dropdown</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">limit: 6,</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>provide a name for the default typeahead data source</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: 'UserID',</code></pre></span>
          <section id="template">
            <h1>template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>template</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the template to render for all results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',</code></pre></span>
          <section id="engine">
            <h1>engine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>engine</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use twitter&#39;s hogan.js to compile the template for the typeahead results</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">engine: Hogan,

remote: {
    url: '',</code></pre></span>
          <section id="replace">
            <h1>replace</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set the remote data source to use compute_status with custom query params</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>@todo this parameter is never used, consider removing                          from function</p></td>
              </tr>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>custom query</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace: function(url,query){
    query = (query[0] === &quot;*&quot;) ? query.replace(&quot;*&quot;,&quot;.*&quot;) : query;
    return [Barista.APIURL + '/compute_status?',
          'q={&quot;user_id&quot;:{&quot;$regex&quot;:&quot;^' + query + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
          '&amp;l=10',
          '&amp;s={&quot;user_id&quot;:1}'].join('');
},

dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract job id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
            var datum_list = [];
            var auto_data = [];
            var object_map = {};

            // for each item, pull out its job_id and use that for the
            // autocomplete value. Build a datum of other relevant data
            // for use in suggestion displays
            response.forEach(function(element){
                auto_data.push(element.user_id);
                object_map[element.user_id] = element;
            });

            // make sure we only show unique items
            auto_data = _.uniq(auto_data);

            // build a list of datum objects
            auto_data.forEach(function(item){
                var datum = {
                    value: item,
                    tokens: [item],
                    data: object_map[item]
                }
                _.extend(datum,{
                    type: 'Username',
                    search_column: 'user_id',
                    color: '#B348DA',
                });
                datum_list.push(datum);
            });

            // return the processed list of datums for the autocomplete
            return datum_list;
        }
    }
}
    }
);</code></pre></span>
          <section id="CMapPertTypeAlias">
            <h1>CMapPertTypeAlias</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.CMapPertTypeAlias()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>var pert_type_object = CMapPertTypeAlias(&quot;trt_cp&quot;);<br />pert_type_object.name;<br />pert_type_object.acronym;</p><p>a utility function to convert standard perturbagen type descriptors into more human friendly strings<br />Given an input type string, an object is returned with field names of &#39;name&#39; and &#39;acronym&#39;<br />If the passed string is not a recoqnized type, the &#39;name&#39; and &#39;acronym&#39; fields are set to the passed<br />string</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>input_type</td>
                <td>string</td>
                <td><p>type of perturbagen (must be recognized type from cases below, or an error                             will occur)</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.CMapPertTypeAlias = function(input_type){
	switch(input_type){
		case &quot;trt_cp&quot;:
			return {name: &quot;small molecule compound&quot;, acronym: &quot;SMC&quot;};
		case &quot;trt_sh&quot;:
			return {name: &quot;knock down&quot;, acronym: &quot;KD&quot;};
		case &quot;trt_oe&quot;:
			return {name: &quot;over expression&quot;, acronym: &quot;OE&quot;};
		case &quot;trt_oe.mut&quot;:
			return {name: &quot;variant&quot;, acronym: &quot;VAR&quot;};
		case &quot;DOS&quot;:
			return {name: &quot;tool compounds&quot;, acronym: &quot;DOS&quot;};
		case &quot;BIOA&quot;:
			return {name: &quot;drugs and bioactives&quot;, acronym: &quot;BIOA&quot;};
		default:
			return {name: input_type, acronym: input_type};
	}
};</code></pre></span>
          <section id="NumbersToSubscript">
            <h1>NumbersToSubscript</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.NumbersToSubscript()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a utility to map numbers in an input string to subscript</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>s</td>
                <td>string</td>
                <td><p>input string to apply subscript to</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.NumbersToSubscript = function(s) {
    if (!s){
        return s;
    }
    var subscript = &quot;&quot;;
    var re = new RegExp('^[0-9]$');
    var new_s = &quot;&quot;;
    s.split(&quot;&quot;).forEach(function(char){
        if (re.test(char)){
            new_s += subscript[char];
        }else{
            new_s += char;
        }
    });
    return new_s;
}</code></pre></span>
          <section id="arrayAverage">
            <h1>arrayAverage</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.arrayAverage()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a utility function to take the average of an array of numeric values<br />the following evaluates to 2:<br />var a = arrayAverage([1,2,3]);</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>arr</td>
                <td>array</td>
                <td><p>array of numeric values</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.arrayAverage = function arrayAverage (arr){
	return _.reduce(arr, function(memo, num){
		return memo + num;
	}, 0) / arr.length;
};</code></pre></span>
          <section id="getEmSizeInPixels">
            <h1>getEmSizeInPixels</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.getEmSizeInPixels()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a utility function to find the size of 1em for the given element id</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>id</td>
                <td>string</td>
                <td><p>element id</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.getEmSizeInPixels = function(id) {
    var el = document.body;
    return Number(getComputedStyle(el, &quot;&quot;).fontSize.match(/(\d+)px/)[1]);
}</code></pre></span>
          <section id="getQueryVariable">
            <h1>getQueryVariable</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.getQueryVariable()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>taken from <a href="http://css-tricks.com/snippets/javascript/get-url-variables/">http://css-tricks.com/snippets/javascript/get-url-variables/</a><br />utility function to grab url parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>the</td>
                <td>string</td>
                <td><p>attribute whose value we want returned</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.getQueryVariable = function(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split(&quot;&amp;&quot;);
       for (var i=0;i&lt;vars.length;i++) {
               var pair = vars[i].split(&quot;=&quot;);
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}</code></pre></span>
          <section id="numberWithCommas">
            <h1>numberWithCommas</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.numberWithCommas()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>credit to Elias Zamaria <a href="http://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-">http://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-</a><br />thousands-separators-in-javascript<br />a utility function to return a number with commas every three digits</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>x</td>
                <td>number</td>
                <td><p>number to add commas to</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.numberWithCommas = function(x){
    // first check to see if something was passed. if so, convert it
    if (x){
      if (x == 0) {
        return '0';
      } else {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, &quot;,&quot;);
      }
    } else {
      return '0';
    }
};</code></pre></span>
          <section id="setAPIPrefilter">
            <h1>setAPIPrefilter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.setAPIPrefilter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a utility function to set up ajax calls to api.lincscloud.org to pass Barista.user_key as a parameter</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>api_endpoint</td>
                <td>string</td>
                <td><p>The location of the API endpoint to prefilter call from, defaults to                               &quot;api.lincscloud.org&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.setAPIPrefilter = function(api_endpoint) {
    api_endpoint = (api_endpoint !== undefined) ? api_endpoint : 'api.lincscloud.org';
    // configure ajax calls to add the user key parameter on calls to api.lincscloud.org
    $.ajaxPrefilter(function( options, originalOptions, jqXHR ){
        var re = new RegExp(api_endpoint);
        var re_default = new RegExp('api.lincscloud.org');
        if (re.test(options.url) || re_default.test(options.url)){
            options.data = $.param($.extend(originalOptions.data,{user_key:Barista.user_key}));
        }
    });
};</code></pre></span>
          <section id="setAPIURL">
            <h1>setAPIURL</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Barista.setAPIURL()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a utility function to set an APIURL attribute on the Barista object</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url for an API endpoint that your would like barista to hit for all API calls,                      defaults to &#39;//api.lincscloud.org&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.setAPIURL = function(url) {
    url = (url !== undefined) ? url : '//api.lincscloud.org';
    // truncate explicit protocols
    url.replace('https://','//');
    url.replace('http://','//');

    // make sure that the first two characters of the url are '//'
    if (url[0].slice(0,2) !== '//'){
        url = '//' + url;
    }
    Barista.APIURL = url;
    Barista.setAPIPrefilter(url);
};

/**
 * a utility function to set a user_key attribute on the Barista object and set up ajax calls to
 * api.lincscloud.org to pass that user_key as a parameter
 * @param {string} key  The user_key to use or a path to a JSON file containing a user_key attribute,
 *                      defaults to &quot;&quot;
 */
Barista.setUserKey = function(key) {
	Barista.setAPIPrefilter();

	// grab the user_key from the url given by string passed in 'key' or set the string itself
	// as user_key if an ajax call to the string fails
	var key_request = $.ajax(key,{dataType: 'json',async: false});
	key_request.done(function(res){
		Barista.user_key = res.user_key;
		return Barista.user_key;
	});
	key_request.fail(function(){
		console.log(&quot;could not find a file at &quot; + key + &quot;; setting Barista.user_key to &quot; + key);
		Barista.user_key = key;
		return null;
	});
};

/**
 * `pert_model = new AnalysisHistoryModel()`
 * 
 * A Backbone.Model that represents an analysis history object.
 */
Barista.Models.AnalysisHistoryModel = Backbone.Model.extend({
    /**
     * Overides the base Model's initialize method to add the models date attribute and set the cid to the
     * mongo _id field
     * @todo these parameters are never used, consider removing from function
     * @param  {object}  attributes
     * @param  {object}  options
     */
    initialize: function(attributes, options) {
        this.cid = this.get('_id')
        this.set(&quot;date&quot;, new Date(parseInt(this.cid.substring(0,8), 16)*1000));
        this.set(&quot;rpt&quot;,this.get(&quot;params&quot;).rpt);
        if (this.get(&quot;status&quot;) === &quot;completed&quot;){
            this.set({view_result_link: '&lt;a href=&quot;' + this.get(&quot;standard_result&quot;) + '&quot;&gt;&lt;i class=&quot;fa fa-eye&quot;&gt;&lt;/i&gt;&lt;/a&gt;'});
        }else{
            this.set({view_result_link: ''});
        }
        this.set({edit: '&lt;i class=&quot;fa fa-times-circle cmap-grid-delete-button&quot; onclick=&quot;Backbone.trigger(' + &quot;'AnalysisHistoryModel:delete'&quot; + ',' + &quot;'&quot; +  this.get(&quot;job_id&quot;) + &quot;'&quot; + ')&quot;&gt;&lt;/i&gt;'});
  }
});</code></pre></span>
          <section id="BarPlotModel">
            <h1>BarPlotModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.BarPlotModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Model to hold the information needed to make a simple bar plot<br />The model includes a title, axis title, data, data_labels, and an optional object for metadata on the<br />points in the data<br />The meta data object should contain attributes for each meta data category and an array of values<br />matching the size of the points in the data</p><p>for example:<br />meta_data = {&#39;dose: [1,2,3]&#39;, timepoint: [&#39;6H&#39;,&#39;6H&#39;,&#39;6H&#39;]}</p><p>   usage:</p><pre><code>    summly_result = new SummlyResultModel();
</code></pre> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.BarPlotModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set of model defaults</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title of the plot, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>axis_title</td>
                <td>string</td>
                <td><p>the title of the x_axis, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>data</td>
                <td>array</td>
                <td><p>an array of data for the x_axis, defaults to []</p></td>
              </tr>
              <tr>
                <td>data_labels</td>
                <td>array</td>
                <td><p>an array of data for the y_axis, defaults to []</p></td>
              </tr>
              <tr>
                <td>meta_data</td>
                <td>object</td>
                <td><p>object containing meta data for the points in the plot,                               defaults to {}</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
	title: &quot;&quot;,
	axis_title: &quot;&quot;,
	data: [],
	data_labels: [],
	meta_data: {}
}
});</code></pre></span>
          <section id="CellCountModel">
            <h1>CellCountModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.CellCountModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>cell_count_model = new CellCountModel({type_string: &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;})</code></p><p>A Backbone.Model that represents the count of a set of cell_lines<br />The data model captures both the total count of cell lines that meet a search criteria and the count of<br />each annotation category for the set of cell lines<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>type_string</td>
                <td>string</td>
                <td><p>the string of pert_types that will be search upon fetching data, defaults                              to &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.CellCountModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>count</td>
                <td>number</td>
                <td><p>the number of perturbagens matching an api query, defaults to 0</p></td>
              </tr>
              <tr>
                <td>pert_types</td>
                <td>array</td>
                <td><p>an array of objects representing pert_type categories to keep track of,                              defaults to [{}}]</p></td>
              </tr>
              <tr>
                <td>last_update</td>
                <td>date</td>
                <td><p>a timestamp of the latest model update, defaults to the current time</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  count: 0,
  pert_types: [{}],
  g: &quot;cell_type&quot;,
  last_update: (new Date()).getTime()
},</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the cell_info api<br />the count and pert_types data is replaced with new data coming from the api call</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string,search_type){
  // depending on the type of query we are making, set up the pert_params for the api call.
  // if we are doing a single query, match that query as a regular expression. If we are
  // doing a multi query, match exact names. If we are doing a cell line query, only match
  // cell_ids
  var sig_info = Barista.APIURL + '/a2/siginfo?callback=?';
  var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
  var cell_info = Barista.APIURL + '/a2/cellinfo?callback=?';
  var params = {};
  if (search_type === &quot;multi&quot;){
    search_string = '[&quot;' + search_string.split(/[:, ]/).join('&quot;,&quot;') + '&quot;]';
    pert_params = {q:'{&quot;pert_iname&quot;:{&quot;$in&quot;:' + search_string + '},&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}', d:&quot;cell_id&quot;};
  }
  if (search_type === &quot;single&quot; || search_type === undefined){
    pert_params = {q:'{&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;},&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}', d:&quot;cell_id&quot;};
  }
  if (search_type === &quot;cell&quot;) {
    pert_params = {q:'{&quot;cell_id&quot;:&quot;' + search_string + '&quot;}', f:'{&quot;cell_id&quot;:1}', l:1};
  }

  // run the api request to get the total count of cell lines.
  var self = this;
  var num_perts;
  var t = (new Date()).getTime();
  // if the search type is a &quot;cell&quot;, leverage siginfo and cellinfo apis
  if (search_type === &quot;cell&quot;) {
    $.getJSON(sig_info,pert_params,function(sig_res) {
      // if there is no reponse, set pert_count: num_perts and pert_types: [{}]
      if (sig_res === 0){
        num_perts = 0;
        self.set({count: num_perts, pert_types: [{}], last_update: t});
      }else{
        // if there is a reponse, update *pert\_count* and *pert\_types*
        num_perts = sig_res.length;
        var cell_lines = '[&quot;' + sig_res.join('&quot;,&quot;') + '&quot;]';
        var cell_params = {q:'{&quot;cell_id&quot;:&quot;' + search_string + '&quot;}', g:&quot;cell_type&quot;};
        $.getJSON(cell_info,cell_params,function(cell_res){
          self.set({count: num_perts, pert_types: cell_res, last_update: t});
        });
      }
    });
  }else{
      // if the search type is not &quot;cell&quot;, leverage the pertinfo api
      $.getJSON(pert_info,pert_params,function(pert_res) {
      if (pert_res === 0){
        // if there is no reponse, set pert_count: num_perts and pert_types: [{}]
        num_perts = 0;
        self.set({count: num_perts, pert_types: [{}], last_update: t});
      }else{
        // if there is a reponse, update pert_count and pert_types
        num_perts = pert_res.length;
        var cell_lines = '[&quot;' + pert_res.join('&quot;,&quot;') + '&quot;]';
        var cell_params = {q:'{&quot;cell_id&quot;:{&quot;$in&quot;:' + cell_lines + '}}', g:self.get(&quot;g&quot;)};
        $.getJSON(cell_info,cell_params,function(cell_res){
          self.set({count: num_perts, pert_types: cell_res, last_update: t});
        });
      }
    });
   }
}
});</code></pre></span>
          <section id="CellModel">
            <h1>CellModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.CellModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_model = new CellModel()</code></p><p>A Backbone.Model that represents a cell line</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.CellModel = Backbone.Model.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Overides the base Model&#39;s initialize method to set the model&#39;s cid to the cell_id of the perturbagen</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>attributes</td>
                <td>string</td>
                <td></td>
              </tr>
              <tr>
                <td>options</td>
                <td>string</td>
                <td></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(attributes, options) {
	this.cid = this.get('cell_id');
  }
});</code></pre></span>
          <section id="CompoundDetailModel">
            <h1>CompoundDetailModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.CompoundDetailModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_detail_model = new CompoundDetailModel()</code></p><p>A Backbone.Model that represents a single compound&#39;s description<br />The data model captures a number of fields including</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.CompoundDetailModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>pert_id</td>
                <td>string</td>
                <td><p>the compound&#39;s perturbagen identifier</p></td>
              </tr>
              <tr>
                <td>pert_iname</td>
                <td>string</td>
                <td><p>the compound&#39;s standardized name</p></td>
              </tr>
              <tr>
                <td>pert_summary</td>
                <td>string</td>
                <td><p>a short description of the compound</p></td>
              </tr>
              <tr>
                <td>pubchem_cid</td>
                <td>string</td>
                <td><p>the PubChem identifier associated with the compound</p></td>
              </tr>
              <tr>
                <td>wiki_url</td>
                <td>string</td>
                <td><p>wikipedia url</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  pert_id: &quot;&quot;,
  pert_iname: &quot;&quot;,
  pert_summary: null,
  pubchem_cid: null,
  wiki_url: null,
  molecular_formula: null,
  molecular_wt: null,
  pert_vendor: null,
  num_gold: 0,
  num_sig: 0,
  cell_id: [],
  inchi_key: &quot;&quot;,
  structure_url: &quot;&quot;
},</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info api</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string){
  // set up a deferred object that can be used by outside functions.  This deferred will be
  // resolved with the contents of the model attributes
  var deferred = $.Deferred();

  // set up the api parameters to make a regular expression matched query against
  // pert_inames in pertinfo and retrieve the first result's pert_iname and pert_desc
  var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
  var params = params = {q:'{&quot;pert_type&quot;:&quot;trt_cp&quot;,&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
                        l:1};

  // run the api request.  If the search string is &quot;&quot;, set the short and long
  // description to undefined and trigger a &quot;CompoundDetailModel:ModelIsNull&quot; event.
  // Otherwise, retrive the pert_iname and pert_desc of the response and set
  // them to the model and trigger a &quot;CompoundDetailModel:ModelIsNotNull&quot; event
  var self = this;
  $.getJSON(pert_info,params,function(perts) {
    if (perts == 0 || search_string == &quot;&quot;){
      self.set({pert_id: &quot;&quot;,
                pert_iname: &quot;&quot;,
                pert_summary: null,
                pubchem_cid: null,
                wiki_url: null,
                molecular_formula: null,
                molecular_wt: null,
                pert_vendor: null,
                num_gold: 0,
                num_sig: 0,
                cell_id: [],
                inchi_key: &quot;&quot;,
                structure_url: &quot;&quot;})
      self.trigger(&quot;CompoundDetailModel:ModelIsNull&quot;);
    }else{
      //   set all fields on the model
      self.set(perts[0]);

      // grab the wikipedia link if it is there
      var wiki_url = null;
      if (perts[0].pert_url){
        var links = perts[0].pert_url.split(',');
        var wiki_re = /wikipedia/
        links.forEach(function(link){
          if (wiki_re.exec(link)){
            wiki_url = link;
          }
        });
      }

      // grab the PubChem ID if it is there.
      var pubchem_cid = null;
      if (perts[0].pubchem_cid){
        pubchem_cid = perts[0].pubchem_cid;
      }

      // grab the pert summary if it is there
      var pert_summary = null;
      if (perts[0].pert_summary){
        pert_summary = perts[0].pert_summary;
      }

      // grab the sstructure_url if it is there and there is a pubchem_cid (i.e. it is public).
      var structure_url = null;
      if (perts[0].structure_url &amp;&amp; pubchem_cid){
        structure_url = perts[0].structure_url;
      }

      // set the fields on the model
      self.set({pert_id: perts[0].pert_id,
                pert_iname: perts[0].pert_iname,
                pert_summary: pert_summary,
                pubchem_cid: pubchem_cid,
                wiki_url: wiki_url,
                molecular_formula: perts[0].molecular_formula,
                molecular_wt: perts[0].molecular_wt,
                pert_vendor: perts[0].pert_vendor,
                num_gold: perts[0].num_gold,
                num_sig: perts[0].num_sig,
                cell_id: perts[0].cell_id,
                inchi_key: perts[0].inchi_key,
                structure_url: structure_url,
                last_update: (new Date()).getTime()});

      // trigger an event to tell us that the model is not null
      self.trigger(&quot;CompoundDetailModel:ModelIsNotNull&quot;);
    }
    deferred.resolve(self.attributes);
  });
  return deferred;
}
});</code></pre></span>
          <section id="GeneDetailModel">
            <h1>GeneDetailModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.GeneDetailModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_detail_model = new GeneDetailModel()</code></p><p>A Backbone.Model that represents a single compound&#39;s description<br />The data model captures a number of fields including</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.GeneDetailModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>pert_id</td>
                <td>string</td>
                <td><p>the compound&#39;s perturbagen identifier</p></td>
              </tr>
              <tr>
                <td>pert_iname</td>
                <td>string</td>
                <td><p>the compound&#39;s standardized name</p></td>
              </tr>
              <tr>
                <td>pert_summary</td>
                <td>string</td>
                <td><p>a short description of the compound</p></td>
              </tr>
              <tr>
                <td>pubchem_cid</td>
                <td>string</td>
                <td><p>the PubChem identifier associated with the compound</p></td>
              </tr>
              <tr>
                <td>wiki_url</td>
                <td>string</td>
                <td><p>wikipedia url</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  cell_id: [],
  clone_name: null,
  has_kd: false,
  has_oe: false,
  num_gold: null,
  num_inst: null,
  num_sig: null,
  oligo_seq: null,
  pert_id: null,
  pert_iname: null,
  pert_summary: null,
  seed_seq6: null,
  seed_seq7: null,
  sig_id: [],
  sig_id_gold: [],
  target_region: null,
  target_seq: null,
  vector_id: null
},</code></pre></span>
          <section id="kd_fields">
            <h1>kd_fields</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>kd_fields</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>kd specific model fields</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">kd_fields: ['clone_name','oligo_seq','seed_seq6','seed_seq7','target_region','target_seq','vector_id'],</code></pre></span>
          <section id="array_fields">
            <h1>array_fields</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>array_fields</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fields that are arrays</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">array_fields: ['cell_id','sig_id','sig_id_gold'],</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info api<br />All fields are replaced by the first item that matches the api search_string</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string){
  // set up a deferred object that can be used by outside functions.  This deferred will be
  // resolved with the contents of the model attributes
  var deferred = $.Deferred();

  // set up the api parameters to make a regular expression matched query against
  // pert_inames in pertinfo
  var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
  var params = params = {
      q:'{&quot;pert_type&quot;:{&quot;$in&quot;:[&quot;trt_sh&quot;,&quot;trt_oe&quot;]},&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;}}',
      f:'{&quot;pert_iname&quot;:1}',
      l:1
  };

  // get annotations for both KD and OE experiments of the matched gene name
  var self = this;
  $.getJSON(pert_info,params,function(perts) {
        if (perts == 0 || search_string == &quot;&quot;){
          // if there is no matched gene, go back to defaults
          self.set(self.defaults);
          self.trigger(&quot;GeneDetailModel:ModelIsNull&quot;);
        }else{
          // otherwise, populate the model with a combination of KD and OE annotations

          // set up the deferred objects for calls to the pertinfo API
          var search_string = perts[0].pert_iname;
          KD_deferred = self.fetch_pert_type(search_string,&quot;trt_sh&quot;);
          OE_deferred = self.fetch_pert_type(search_string,&quot;trt_oe&quot;);

          // act on the deferred objects once they are resolved
          $.when(KD_deferred,OE_deferred).done(function(kd_annots, oe_annots){
              if ( kd_annots === null &amp;&amp; oe_annots === null ){
                  self.set(self.defaults);
                  self.trigger(&quot;GeneDetailModel:ModelIsNull&quot;);
              }else{
                  var annots = {pert_type:&quot;gene&quot;};
                  if (kd_annots === null){
                      annots.has_kd = false;
                      annots.has_oe = true;
                      self.set(_.extend(oe_annots.unprefixed,oe_annots.prefixed,annots));
                  }else if (oe_annots === null){
                      annots.has_kd = true;
                      annots.has_oe = false;
                      self.set(_.extend(kd_annots.unprefixed,kd_annots.prefixed,annots));
                  }else{
                      annots.has_kd = true;
                      annots.has_oe = true;
                      self.set(_.extend(kd_annots.unprefixed,kd_annots.prefixed,oe_annots.prefixed,annots));
                  }
                  // trigger an event to tell us that the model is not null
                  self.trigger(&quot;GeneDetailModel:ModelIsNotNull&quot;);
              }
              deferred.resolve(self.attributes);
          });
        }
      });
      return deferred;
  },</code></pre></span>
          <section id="fetch_pert_type">
            <h1>fetch_pert_type</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch_pert_type()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info API for the given pert_type</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>pert_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch_pert_type: function(search_string,pert_type){
    // set up a deferred object that we can use in the fetch function above
    var deferred = $.Deferred();

    // set up the api parameters to make an exact matched query against
    // pert_inames in pertinfo and retrieve the first result
    var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
    var params = params = {q:'{&quot;pert_type&quot;:&quot;'+ pert_type + '&quot;,&quot;pert_iname&quot;:&quot;' + search_string + '&quot;}',
                          l:1};

    // run the api request.  If the search string is &quot;&quot;, resolve the generated promise
    // with a null value, otherwise resolve it with the returned pert annotations
    var self = this;
    $.getJSON(pert_info,params,function(perts) {
        if (perts == 0 || search_string == &quot;&quot;){
            deferred.resolve(null);
        }else{
            var annots = {};
            for (field in perts[0]){
                annots[pert_type + '_' + field] = perts[0][field];
            }
            deferred.resolve({prefixed: annots, unprefixed: perts[0]});
        }
    });

    return deferred;
}
});</code></pre></span>
          <section id="GenericCountModel">
            <h1>GenericCountModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.GenericCountModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>generic_count_model = new GenericCountModel()</code></p><p>A Backbone.Model that represents the count of a set CMap databbase items<br />The data model captures the total count of perturbagens that meet a search criteria<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_field</td>
                <td>string</td>
                <td><p>the document field the model with count over upon fetching data,                               defaults to &quot;pert_iname&quot;</p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url of the api service to fetch data from, defaults to                               &quot;//api.lincscloud.org/a2/pertinfo&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.GenericCountModel = Backbone.Model.extend({

  defaults:{
    count:0,

  },</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>custom initialization to make sure we have the correct url for jsonp</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize:function(attrs){
  this.setListeners();
},</code></pre></span>
          <section id="setListeners">
            <h1>setListeners</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>setListeners()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>add description</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">setListeners: function() {
  var source = this.get('source');
  if (source) {
    this.listenTo(source,'update',function(){
      if(attrs.source.getCount(attrs.key)) {
        this.set('count',attrs.source.getCount(attrs.key));
      } else {
        this.set('count',0);
      }
    });
  };
}

});

Barista.Models.GenericSourceModel = Backbone.Model.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>custom initialization to make sure we have the correct url for jsonp</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize:function(attrs){
  this.setKey();
},</code></pre></span>
          <section id="setKey">
            <h1>setKey</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>setKey()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>add description</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">setKey: function() {
  var key = this.get('key');
  this.url = 'http://10.125.171.42:8080/' + key;
},

/**
 * add description
 * @param  {[type]} inputKey [description]
 */
getCount:function(inputKey){
  return this.data[inputKey.group][inputKey.name];
},

/**
 * add description
 */
update:function(){
  var self = this;
  $.getJSON(this.url,function(data){
    self.data = data;
    self.trigger('update');
  })
}
});


/**
 * `pert_model = new GenericMongoModel()`
 * 
 * A Backbone.Model that represents a generic MongoDB object
 * All fields in the document are passed to the model as normal and a date attribute is set from the _id
 * field of the mongo document
 */
Barista.Models.GenericMongoModel = Backbone.Model.extend({
  /**
	 * Overides the base Model's initialize method to add the models date attribute and set the cid to
 * the mongo _id field
 * @todo these parameters are never used, consider removing from function
	 * @param  {string}  attributes
	 * @param  {string}  options
	 */
  initialize: function(attributes, options) {
      this.cid = this.get('_id')
      this.set(&quot;date&quot;, new Date(parseInt(this.cid.substring(0,8), 16)*1000));
}
});</code></pre></span>
          <section id="HeatmapModel">
            <h1>HeatmapModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.HeatmapModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>heatmap_model = new HeatmapModel({data: [[1,2],[3,4]],<br />                                            rid: [&#39;1&#39;,&#39;2&#39;],<br />                                            cid: [&#39;1&#39;,&#39;2&#39;],<br />                                            annots: [&#39;1&#39;,&#39;2&#39;],<br />                                            title: &quot;&quot;});</p><p>A Backbone.Model that represents the data in a heatmap<br />The model contains a two dimensional array of numbers, row and columns labels, and a title<br />example usage:</p><pre><code>         heatmap_model = new HeatmapModel();
</code></pre><p>optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>data</td>
                <td>array</td>
                <td><p>the data object to use in the heatmap, defualts to [[1,2],[3,4]]</p></td>
              </tr>
              <tr>
                <td>rid</td>
                <td>array</td>
                <td><p>the row labels to use in the heatmap, defualts to [&#39;1&#39;,&#39;2&#39;]</p></td>
              </tr>
              <tr>
                <td>cid</td>
                <td>array</td>
                <td><p>the column labels to use in the heatmap, defualts to [&#39;1&#39;,&#39;2&#39;]</p></td>
              </tr>
              <tr>
                <td>annots</td>
                <td>array</td>
                <td><p>optional annotations categories to show under the heatmap, defualts to                               undefined</p></td>
              </tr>
              <tr>
                <td>annote_label</td>
                <td>array</td>
                <td><p>optional label for annotations. defualts to undefined</p></td>
              </tr>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title to use in the plot, defaults to &quot;&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.HeatmapModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up defaults for model values</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>data</td>
                <td>array</td>
                <td><p>the data object to use in the heatmap, defualts to [[1,2],[3,4]]</p></td>
              </tr>
              <tr>
                <td>rid</td>
                <td>array</td>
                <td><p>the row labels to use in the heatmap, defualts to [&#39;1&#39;,&#39;2&#39;]</p></td>
              </tr>
              <tr>
                <td>cid</td>
                <td>array</td>
                <td><p>the column labels to use in the heatmap, defualts to [&#39;1&#39;,&#39;2&#39;]</p></td>
              </tr>
              <tr>
                <td>annots</td>
                <td>array</td>
                <td><p>optional annotations categories to show under the heatmap, defualts to                         undefined</p></td>
              </tr>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title to use in the plot, defaults to &quot;&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
	data: [[1,2],[3,4]],
	rid: ['1','2'],
	cid: ['1','2'],
	annots: undefined,
	title: &quot;&quot;,
	last_update: (new Date()).getTime()
}
})</code></pre></span>
          <section id="PertCellBreakdownModel">
            <h1>PertCellBreakdownModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.PertCellBreakdownModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_cell_breakdown_model = new PertCellBreakdownModel()</code></p><p>A Backbone.Model that represents the cell line based breakdown of a set of perturbagens<br />the number of perturbagens matching a query is counted for each cell line<br />Data for all cell lines that contain a match to the query are represented in the model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.PertCellBreakdownModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>filter</td>
                <td>string</td>
                <td><p>the current filter to be used with api calls, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>tree_object</td>
                <td>object</td>
                <td><p>an object that describes the structured tree data representing cell_line                              counts, defaults to {children:[]}</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  &quot;filter&quot;: &quot;&quot;,
  &quot;tree_object&quot;: {children:[]}
},</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info api<br />the tree_object data is updated</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string,search_type){
  // depending on the type of query we are making, set up the q param for the api call.
  // if we are doing a single query, match that query as a regular expression. If we are
  // doing a multi query, match exact names. If we are doing a cell line query, only match
  // cell_ids
  var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
  var params = {};
  if (search_type === &quot;multi&quot;){
    search_string = '[&quot;' + search_string.split(/[:, ]/).join('&quot;,&quot;') + '&quot;]';
    params = {q:'{' + this.get('filter') + '&quot;pert_iname&quot;:{&quot;$in&quot;:' + search_string + '}}', g:&quot;cell_id&quot;};
  }
  if (search_type === &quot;single&quot; || search_type === undefined){
    params = {q:'{' + this.get('filter') + '&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;}}', g:&quot;cell_id&quot;};
  }
  if (search_type === &quot;cell&quot;) {
    params = {q:'{' + this.get('filter') + '&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;&quot;}}', g:&quot;cell_id&quot;};
  }


  // run the api request
  var self = this;
  $.getJSON(pert_info,params,function(response) {
    if (response === 0){
      children = [];
    }else{
      children = response;
    }
    if (search_type === &quot;cell&quot;) {
      children = _.filter(children,function(o){return o._id == search_string;});
    }
    var t = (new Date()).getTime();
    self.set({tree_object: {name:&quot;root&quot;, children:children}, last_update: t});
  });
}
});</code></pre></span>
          <section id="PertCountModel">
            <h1>PertCountModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.PertCountModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>count_model = new PertCountModel({type_string: &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;})</code></p><p>A Backbone.Model that represents the count of a set of perturbagens<br />The data model captures both the total count of perturbagens that meet a search criteria and the count<br />of each annotation category for the set of perturbagens<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>type_string</td>
                <td>string</td>
                <td><p>the string of pert_types that will be search upon fetching data, defaults                              to &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.PertCountModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>type_string</td>
                <td>string</td>
                <td><p>the string of pert_types that will be search upon fetching data,                                   defaults to &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;</p></td>
              </tr>
              <tr>
                <td>count</td>
                <td>number</td>
                <td><p>the number of perturbagens matching an api query, defaults to 0</p></td>
              </tr>
              <tr>
                <td>pert_types</td>
                <td>array</td>
                <td><p>an array of objects representing pert_type categories to keep track                                   of, defaults to [{}}]</p></td>
              </tr>
              <tr>
                <td>pert_type_field</td>
                <td>string</td>
                <td><p>a field name over which to look for pert_types. This runs an                                   aggregated count over the specified field name in the Connectivity<br />                                  Map database, defaults to &#39;pert_icollection&#39;</p></td>
              </tr>
              <tr>
                <td>last_update</td>
                <td>date</td>
                <td><p>a timestamp of the latest model update, defaults to the current time</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  &quot;type_string&quot;: '[&quot;trt_cp&quot;]',
  &quot;count&quot;: 0,
  &quot;pert_types&quot;: [{}],
  &quot;pert_type_field&quot;: &quot;pert_icollection&quot;,
  &quot;last_update&quot;: (new Date()).getTime()
},</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info api<br />the count and pert_types data is replaced with new data coming from the api call</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string,search_type){
  // depending on the type of query we are making, set up the q param for the api call.
  // if we are doing a single query, match that query as a regular expression. If we are
  // doing a multi query, match exact names. If we are doing a cell line query, only match
  // cell_ids
  var pert_info = Barista.APIURL + '/a2/pertinfo?callback=?';
  var params = {};
  if (search_type === &quot;multi&quot;) {
    search_string = '[&quot;' + search_string.split(/[:, ]/).join('&quot;,&quot;') + '&quot;]';
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$in&quot;:' + search_string + '}}',c:true};
  }
  if (search_type === &quot;single&quot; || search_type === undefined){
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;}}',c:true};
  }
  if (search_type === &quot;cell&quot;) {
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;&quot;,&quot;$options&quot;:&quot;i&quot;},&quot;cell_id&quot;:&quot;' + search_string + '&quot;}', c:true};
  }

  // run the api request
  var self = this;
  var num_perts;
  $.getJSON(pert_info,params,function(perts) {
    if (perts === 0){
      num_perts = 0;
    }else{
      num_perts = perts.count;
    }
    var t = (new Date()).getTime();
    params = _.omit(params,'c');
    params = _.extend(params,{g:self.get('pert_type_field')});
    $.getJSON(pert_info, params, function(pert_types){
      self.set({count: num_perts, pert_types: pert_types, last_update: t});
    });
  });
}
});</code></pre></span>
          <section id="PertDetailModel">
            <h1>PertDetailModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.PertDetailModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Model that represents a single perturbagen&#39;s description<br />The data model captures annotation data from compounds or genes<br />To do this, the model uses CompoundDetailModel and GeneDetailModel under the hood and pulls in their<br />attributes depending on how the model&#39;s fetch method is called</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.PertDetailModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters<br />this an incomplete list of defaults, only those that are common to all perturbagens</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  cell_id: [],
  num_gold: null,
  num_inst: null,
  num_sig: null,
  pert_id: null,
  pert_iname: null,
  pert_type: null,
  sig_id: [],
  sig_id_gold: []
},</code></pre></span>
          <section id="compound_sub_model">
            <h1>compound_sub_model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>compound_sub_model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a sub-model to be used when the PertDetailModel model needs to fetch Compound annotations</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compound_sub_model: new Barista.Models.CompoundDetailModel(),</code></pre></span>
          <section id="gene_sub_model">
            <h1>gene_sub_model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>gene_sub_model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a sub-model to be used when the PertDetailModel model needs to fetch Gene annotations</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">gene_sub_model: new Barista.Models.GeneDetailModel(),</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the pert_info api<br />depending on the model_type parameter,the method calls the appropriate fetch method for the given sub<br />model type and fills the PertDetailModel&#39;s attributes with that of the sub model</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string, model_type){
    var self = this;
    var deferred = $.Deferred();
    switch (model_type){
    case &quot;compound&quot;:
        this.compound_sub_model.fetch(search_string).then(function(attributes){
            self.clear().set(attributes);
            deferred.resolve();
        });
        break;
    case &quot;gene&quot;:
        this.gene_sub_model.fetch(search_string).then(function(attributes){
            self.clear().set(attributes);
            deferred.resolve();
        });
        break;
    }
    return deferred;
}
});</code></pre></span>
          <section id="PertModel">
            <h1>PertModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.PertModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_model = new PertModel()</code></p><p>A Backbone.Model that represents a single perturbagen</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.PertModel = Backbone.Model.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Overrides the base Model&#39;s initialize method to set the model&#39;s cid to the pert_id of the perturbagen</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>attributes</td>
                <td>string</td>
                <td></td>
              </tr>
              <tr>
                <td>options</td>
                <td>string</td>
                <td></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(attributes, options) {
	this.cid = this.get('pert_id');
	var pert_type = this.get('pert_type');
	switch(pert_type){
		case &quot;trt_cp&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #E69F00&quot;&gt;SMC&lt;/span&gt;'}); break;
		case &quot;trt_oe&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #D55E00&quot;&gt;OE&lt;/span&gt;'}); break;
		case &quot;trt_sh&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #56B4E9&quot;&gt;KD&lt;/span&gt;'}); break;
		default: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #BDBDBD&quot;&gt;' + pert_type + '&lt;/span&gt;'});
	}
  }
});</code></pre></span>
          <section id="ScatterPlotModel">
            <h1>ScatterPlotModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.ScatterPlotModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Model to hold the information needed to make a simple scatter plot<br />The model includes a title, x and y axis titles, x and y data, and an optional object for metadata on<br />the points in the data<br />The meta data object should contain attributes for each meta data category and an array of values<br />matching the size of the points in the data<br />for example:<br />meta_data = {&#39;dose: [1,2,3]&#39;, timepoint: [&#39;6H&#39;,&#39;6H&#39;,&#39;6H&#39;]}<br />usage:<br />summly_result = new SummlyResultModel();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.ScatterPlotModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set of model defaults</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title of the plot. Defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>x_axis-title</td>
                <td>string</td>
                <td><p>the title of the x_axis. Defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>y_axis-title</td>
                <td>string</td>
                <td><p>the title of the y_axis. Defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>x_data</td>
                <td>array</td>
                <td><p>an array of data for the x_axis. Defaults to []</p></td>
              </tr>
              <tr>
                <td>y_data</td>
                <td>array</td>
                <td><p>an array of data for the y_axis. Defaults to []</p></td>
              </tr>
              <tr>
                <td>meta-data</td>
                <td>object</td>
                <td><p>object containing meta data for the points in the plot. Defaults to {}</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
	title: &quot;&quot;,
	x_axis_title: &quot;&quot;,
	y_axis_title: &quot;&quot;,
	x_data: [],
	y_data: [],
	meta_data: {}
}
});</code></pre></span>
          <section id="SigCountModel">
            <h1>SigCountModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.SigCountModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Model that represents the count of a set of signatures<br />he data model captures both the total count of signatures that meet a search criteria and the count of<br />each annotation category for the set of signatures<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>type_string</td>
                <td>string</td>
                <td><p>the string of pert_types that will be search upon fetching data, defaults                              to &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.SigCountModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>describes the model&#39;s default parameters</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>type_string</td>
                <td>string</td>
                <td><p>the string of pert_types that will be search upon fetching data,                                  defaults to &#39;[&quot;trt_sh&quot;,&quot;trt_oe&quot;]&#39;</p></td>
              </tr>
              <tr>
                <td>count</td>
                <td>number</td>
                <td><p>the number of perturbagens matching an api query, defaults to 0</p></td>
              </tr>
              <tr>
                <td>pert_types</td>
                <td>array</td>
                <td><p>an array of objects representing pert_type categories to keep track                                  of, defaults to [{}}]</p></td>
              </tr>
              <tr>
                <td>pert_type_field</td>
                <td>string</td>
                <td><p>a field name over which to look for pert_types. This runs an                                  aggregated count over the specified field name in the Connectivity<br />                                 Map database, defaults to &#39;pert_icollection&#39;</p></td>
              </tr>
              <tr>
                <td>last_update</td>
                <td>date</td>
                <td><p>a timestamp of the latest model update, defaults to the current time</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  &quot;type_string&quot;: '[&quot;trt_sh&quot;,&quot;trt_oe&quot;,&quot;trt_oe.mut&quot;]',
  &quot;count&quot;: 0,
  &quot;pert_types&quot;: [{}],
  &quot;pert_type_field&quot;: &quot;pert_icollection&quot;,
  &quot;last_update&quot;: (new Date()).getTime()
},</code></pre></span>
          <section id="fetch">
            <h1>fetch</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fetch()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetches new data from the sig_info api<br />the count and sig_types data is replaced with new data coming from the api call</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>one of &#39;multi&#39;, &#39;single&#39;, or &#39;cell&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fetch: function(search_string,search_type){
  // depending on the type of query we are making, set up the q param for the api call.
  // if we are doing a single query, match that query as a regular expression. If we are
  // doing a multi query, match exact names. If we are doing a cell line query, only match
  // cell_ids
  var sig_info = Barista.APIURL + '/a2/siginfo?callback=?';
  var params = {};
  if (search_type === &quot;multi&quot;) {
    search_string = '[&quot;' + search_string.split(/[:, ]/).join('&quot;,&quot;') + '&quot;]';
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$in&quot;:' + search_string + '}}',c:true};
  }
  if (search_type === &quot;single&quot; || search_type === undefined){
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;}}',c:true};
  }
  if (search_type === &quot;cell&quot;) {
    params = {q:'{&quot;pert_type&quot;:{&quot;$in&quot;:' + this.get('type_string') + '},&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;&quot;,&quot;$options&quot;:&quot;i&quot;},&quot;cell_id&quot;:&quot;' + search_string + '&quot;}', c:true};
  }

  // run the api request
  var self = this;
  var num_perts;
  $.getJSON(sig_info,params,function(perts) {
    if (perts === 0){
      num_perts = 0;
    }else{
      num_perts = perts.count;
    }
    var t = (new Date()).getTime();
    params = _.omit(params,'c');
    params = _.extend(params,{g:self.get('pert_type_field')});
    $.getJSON(sig_info, params, function(pert_types){
      self.set({count: num_perts, pert_types: pert_types, last_update: t});
    });
  });
}
});</code></pre></span>
          <section id="SignatureModel">
            <h1>SignatureModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.SignatureModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_model = new SignatureModel()</code></p><p>A Backbone.Model that represents a single signature</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.SignatureModel = Backbone.Model.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Overides the base Model&#39;s initialize method to add the model&#39;s cid to the sig_id of the perturbagen</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>attributes</td>
                <td>string</td>
                <td></td>
              </tr>
              <tr>
                <td>options</td>
                <td>string</td>
                <td></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(attributes, options) {
	// set the unique collection identifier to match the sig_id
	this.cid = this.get('sig_id');
	
	// generate an html label for pert_type
	var pert_type = this.get('pert_type');
	switch(pert_type){
		case &quot;trt_cp&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #E69F00&quot;&gt;SMC&lt;/span&gt;'}); break;
		case &quot;trt_oe&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #D55E00&quot;&gt;OE&lt;/span&gt;'}); break;
		case &quot;trt_sh&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #56B4E9&quot;&gt;KD&lt;/span&gt;'}); break;
		this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #BDBDBD&quot;&gt;' + pert_type + '&lt;/span&gt;'});
	}

	// generate an html label for is_gold
	var is_gold = this.get('is_gold');
	if (is_gold){
		this.set({is_gold_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #F0E442; color:gray&quot;&gt;Gold&lt;/span&gt;'});
	}else{
		this.set({is_gold_label: '&lt;span class=&quot;label&quot;&gt;Not Gold&lt;/span&gt;'});
	}
  }
});</code></pre></span>
          <section id="SummlyResultModel">
            <h1>SummlyResultModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.SummlyResultModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>summly_result = new SummlyResultModel();<br />A Backbone.Model that represents the a single CMap Summly result<br />A single result is composed of the connection between two pert_inames (a query and a target), the<br />component data that went into computing the summly result, and the statistics  of the summly computation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.SummlyResultModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up defaults for model values</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>query</td>
                <td>string</td>
                <td><p>the query perturbagen (pert_iname), defaults to <em>&quot;&quot;</em></p></td>
              </tr>
              <tr>
                <td>target</td>
                <td>string</td>
                <td><p>the target perturbagen (pert_iname), defaults to <em>&quot;&quot;</em></p></td>
              </tr>
              <tr>
                <td>summly_score</td>
                <td>number</td>
                <td><p>summarized connectivity score across cell types, defaults to <em>-666</em></p></td>
              </tr>
              <tr>
                <td>summly_rank</td>
                <td>number</td>
                <td><p>summarized percent rank across cell types, defaults to <em>-666</em></p></td>
              </tr>
              <tr>
                <td>specificity</td>
                <td>number</td>
                <td><p>fraction of background queries that score/rank higher than the                                   observed connection, defaults to <em>-666</em></p></td>
              </tr>
              <tr>
                <td>cell_line_scores</td>
                <td>object</td>
                <td><p>the connectivity map scores in each cell line for the target                                   perturbagen, defaults to <em>{}</em></p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
	query: &quot;&quot;,
	target: &quot;&quot;,
	summly_score: -666,
	summly_rank: -666,
	specificity: -666,
	cell_line_scores: {}
},</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Overides the base Model&#39;s initialize method to add the model&#39;s cid to the summly_id</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>attributes</td>
                <td>string</td>
                <td></td>
              </tr>
              <tr>
                <td>options</td>
                <td>string</td>
                <td></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(attributes,options){
	this.cid = this.get('target');
	var pert_type = this.get('pert_type');
	switch(pert_type){
		case &quot;trt_cp&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #E69F00&quot;&gt;SMC&lt;/span&gt;'}); break;
		case &quot;trt_oe&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #D55E00&quot;&gt;OE&lt;/span&gt;'}); break;
		case &quot;trt_sh&quot;: this.set({pert_type_label: '&lt;span class=&quot;label&quot; style=&quot;background-color: #56B4E9&quot;&gt;KD&lt;/span&gt;'}); break;
		default: this.set({pert_type_label: '&lt;span class=&quot;label&quot;&gt;' + pert_type + '&lt;/span&gt;'});
	}
}
});</code></pre></span>
          <section id="TickModel">
            <h1>TickModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.TickModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Model that represents the data required to build a CMapTickView<br />The model contains a data object that has keys for each row to display in the view and array values for<br />each tick to display in each row<br />An example data object might look like this:</p><pre><code>        {PC3: [.23,-.28], MCF7: [-0.6]}
</code></pre><p>example usage:<br />tick_model = new TickModel();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.TickModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up defaults for model values</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title to use in the plot, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>data_object</td>
                <td>object</td>
                <td><p>the data object to use when plotting. defualts to {}</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
	title: &quot;&quot;,
	data_object: {}
}
});</code></pre></span>
          <section id="SequenceModel">
            <h1>SequenceModel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Models.SequenceModel</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Model to represent a sequence and the modifications on that sequence</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Models.SequenceModel = Backbone.Model.extend({</code></pre></span>
          <section id="defaults">
            <h1>defaults</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>defaults</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the default options for the model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">defaults: {
  sequence: '',
  displaySequence: '',
  modifications: new Backbone.Collection()
},</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the model to listen to its own model changes</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function() {
  this.listenTo(this, 'change:sequence', this.parseSequence);
},</code></pre></span>
          <section id="parseSequence">
            <h1>parseSequence</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>parseSequence()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>function to populate the derived model attributes of displaySequence and modifications</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">parseSequence: function() {
  var sequence = this.get('sequence'),
      modifications = this.get('modifications'),
      indices = [],
      numMods = 0;
      modObjects = [];

  // reset the modifications collection
  modifications.reset();

  // remove leading and trailing underscores
  sequence = sequence.replace(/_/g,'');

  // find all occurances of '(' in the sequence, these are the modifications
  for(var i=0; i&lt;sequence.length;i++) {
    if (sequence[i] === '(') {
      indices.push(i);
    }
  }

  // for each modification, pop it out of the sequence string and add a new
  // model to the modifications collection
  indices.forEach(function(index) {
    var mod;
    index -= numMods * 4;
    mod = sequence.slice(index + 1,index + 3);
    sequence = [sequence.slice(0,index),sequence.slice(index + 4,sequence.length)].join('');
    modObjects.push({index: index, modification: mod});
    numMods += 1;
  });

  modifications.add(modObjects);

  // set the derived attributes on the model
  this.set({'modifications': modifications, 'displaySequence': sequence});
}
});</code></pre></span>
          <section id="AnalysisHistoryCollection">
            <h1>AnalysisHistoryCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.AnalysisHistoryCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.Collection that represents a set of analysis history objects<br />This collection is suitable for internal use in GridView<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to PertModel</p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation, defaults to false</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.AnalysisHistoryCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetch model data from assigned url</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
    // the url from which model data is fetched
    this.url =  Barista.APIURL + '/compute_status?callback=?';
},</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for the collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.AnalysisHistoryModel,</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="maxCount">
            <h1>maxCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>maxCount</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the maximum size of the collection<br />defaults to Infinity</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">maxCount: Infinity,</code></pre></span>
          <section id="user">
            <h1>user</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>user</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the user_id to search jobs for<br />Forcing this to be set prevents us from searching other users jobs</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">user: undefined,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br /><code>AnalysisHistoryCollection.getData(search_string,search_type,limit)</code><br />the count and pert_types data is replaced with new data coming from the api call</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_type,limit){
    var self = this;
    // set isLoading to true so we don't constantly make api calls before the data comes back
    this.isLoading = true;

    // store the value of search_string, search_type, and limit on the collection object
    this.search_string = (search_string !== undefined) ? search_string : '';
    this.search_type = (search_type !== undefined) ? search_type : '';
    this.limit = (limit !== undefined) ? limit : 30;

    // set up the query parameter for user_id
    var user_q = &quot;&quot;;
    if (self.user){
        user_q = '&quot;user_id&quot;:&quot;' + self.user + '&quot;,';
    }
    switch (search_type){
    case &quot;job_id&quot;:
        this.q_param = '{' + user_q + '&quot;job_id&quot;:{&quot;$regex&quot;:&quot;' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;},&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
        break;
    case &quot;status&quot;:
        this.q_param = '{' + user_q + '&quot;status&quot;:{&quot;$regex&quot;:&quot;' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;},&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
        break;
    case &quot;tool_id&quot;:
        this.q_param = '{' + user_q + '&quot;tool_id&quot;:{&quot;$regex&quot;:&quot;' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;},&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
        break;
    case &quot;job_name&quot;:
        this.q_param = '{' + user_q + '&quot;params.rpt&quot;:&quot;' + search_string + '&quot;,&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
        break;
    case &quot;user_id&quot;:
        this.q_param = '{' + user_q + '&quot;user_id&quot;:{&quot;$regex&quot;:&quot;' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;},&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
        break;
    default:
        this.q_param = '{' + user_q + '&quot;job_id&quot;:{&quot;$regex&quot;:&quot;' + search_string + '&quot;, &quot;$options&quot;:&quot;i&quot;},&quot;status&quot;:{&quot;$ne&quot;:&quot;deleted&quot;}}';
    }


    // build a parameter object for the api call
    var params = {q: this.q_param,
        l: this.limit,
        sk: this.skip,
        s: '{&quot;_id&quot;:-1}'};

    // make the api call and store the results as individual models in the collection.
    // we don't remove old models in this case as we want to support continuous building
    // of the model list from a remote api.  On success, set isLoading back to false
    // and resolve a deferred that we set up as a return value
    var def = $.Deferred();
    $.getJSON(this.url, params, function(res){
        self.set(res,{remove: false});
        self.isLoading = false;
        def.resolve();
    });

    // make a second api call to find the maximum number of items in the collection
    // and set that as an attribute on it
    if (this.maxCount == Infinity){
        params = _.omit(params,['l','sk','s']);
        params = _.extend(params,{c: true});
        $.getJSON(this.url,params,function(res){
            self.maxCount = res.count;
        });
    }

    return def;
}
});</code></pre></span>
          <section id="CellCollection">
            <h1>CellCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.CellCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_collection = new CellCollection({model: PertModel,<br />                                           url: Barista.APIURL + &#39;/a2/pertinfo?callback=?&#39;,<br />                                           skip: 0,<br />                                           isLoading: false});</p><p>A Backbone.Collection that represents a set of cell types<br />This collection is suitable for internal use in GridView<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to <em>PertModel</em></p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated,                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation, defaults to false`</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.CellCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetch model data from assigned url</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
    // the url from which model data is fetched
    this.url =  Barista.APIURL + '/a2/cellinfo?callback=?';
},</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for the collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.CellModel,</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br />the count and pert_types data is replaced with new data coming from the api call<br /><code>PertCollection.getData(search_string,search_type,limit)</code></p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_column,limit){
    var self = this;
    // set isLoading to true so we don't constantly make api calls before the data comes back
    this.isLoading = true;

    this.search_string = (search_string !== undefined) ? search_string : '';
    this.search_column = (search_column !== undefined) ? search_column : 'cell_id';
    //TODO big hack to adapt to GridView implementation
    if (this.search_column == 'single') {
      this.search_column = 'cell_id';
    }
    // this.search_type = (search_type !== undefined) ? search_type : '';
    this.limit = (limit !== undefined) ? limit : 30;

    if (this.search_column == 'mutations'){
        this.q_param = '{&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]},&quot;mutations&quot;:&quot;' + this.search_string + '&quot;}';
    }else{
        this.q_param = '{&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]},&quot;' + this.search_column + '&quot;:' + '{&quot;$regex&quot;:&quot;^' + this.search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;}}';
    }

    // build a parameter object for the api call
    // TODO-remove: alert(this.q_param);
    var params = {q: this.q_param,
        l: this.limit,
        // s: this.s_param, // no sorting yet
        sk: this.skip};

    $.getJSON(this.url, params, function(res){
        self.set(res,{remove: false});
        self.isLoading = false;
        self.trigger(&quot;fetch&quot;);
    });
}
});</code></pre></span>
          <section id="GenericJSONCollection">
            <h1>GenericJSONCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.GenericJSONCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_collection = new PertCollection({model: PertModel,<br />                                        url: Barista.APIURL + &#39;/a2/pertinfo?callback=?&#39;,<br />                                        skip: 0,<br />                                        isLoading: false});</p><p>A Backbone.Collection that represents an arbitrary set of objects stored in a JSON file<br />The JSON file is assumed to contain a top level array containing objects<br />Each object in the array is modeled as a base Backbone.Model inside of the collection<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to <em>PertModel</em></p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation. defaults to false</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.GenericJSONCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.PertModel,</code></pre></span>
          <section id="url">
            <h1>url</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>url</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the url from which model data is fetched</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">url: 'data.json',</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="maxCount">
            <h1>maxCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>maxCount</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the maximum size of the collection<br />defaults to Infinity</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">maxCount: Infinity,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br />the count and pert_types data is replaced with new data coming from the api call<br /><code>GenericJSONCollection.getData(search_string,search_type,limit)</code></p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_type,limit){
    var self = this;
    // set isLoading to true so we don't constantly make api calls before the data comes back
    this.isLoading = true;

    // store the value of search_string, search_type, and limit on the collection object
    this.search_string = (search_string !== undefined) ? search_string : '';
    this.search_type = (search_type !== undefined) ? search_type : '';
    this.limit = (limit !== undefined) ? limit : 30;

    // fetch data from the given url.  If the url attribute is a string, fetch data via an ajax
    // request. Read each returned item in the response into a new PertModel.  If it is an object, 
    // assume it is an array of data and read each array item into a new PertModel
    if (typeof(this.url) == 'object'){
        this.url.forEach(function(o){self.add(new Barista.Models.PertModel(o));});
        // set the collection's maxCount attribute to the length of the collection
        this.maxCount = this.models.length;
    }else{
        $.getJSON(this.url,function(res){
            res.forEach(function(o){
                self.add(new PertModel(o));
            });
            // set the collection's maxCount attribute to the length of the collection
            this.maxCount = this.models.length;
        });
    }
	}
});</code></pre></span>
          <section id="PertCollection">
            <h1>PertCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.PertCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_collection = new PertCollection({model: PertModel,
                                        // url: Barista.APIURL + &#39;/a2/pertinfo?callback=?&#39;,
                                        // skip: 0,
                                        // isLoading: false});</code></p><p>A Backbone.Collection that represents a set of perturbagens<br />This collection is suitable for internal use in GridView<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to <em>PertModel</em></p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated,                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation, defaults to false</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.PertCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetch model data from assigned url</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
    // the url from which model data is fetched
    this.url =  Barista.APIURL + '/a2/pertinfo?callback=?';
},</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for the collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.PertModel,</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="maxCount">
            <h1>maxCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>maxCount</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the maximum size of the collection<br />defaults to Infinity</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">maxCount: Infinity,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br />the count and pert_types data is replaced with new data coming from the api call<br /><code>PertCollection.getData(search_string,search_type,limit)</code></p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_type,limit){
    var self = this;
    // set isLoading to true so we don't constantly make api calls before the data comes back
    this.isLoading = true;

    // store the value of search_string, search_type, and limit on the collection object
    this.search_string = (search_string !== undefined) ? search_string : '';
    this.search_type = (search_type !== undefined) ? search_type : '';
    this.limit = (limit !== undefined) ? limit : 30;

    // depending on the type of query we are making, set up the q param for the api call.
    // if we are doing a single query, match that query as a regular expression. If we are
    // doing a multi query, match exact names. If we are doing a cell line query, only match
    // cell\_ids
    if (search_type === &quot;single&quot; || search_type === undefined){
        this.q_param = '{&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;^' + search_string + '&quot;,&quot;$options&quot;:&quot;i&quot;},&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}';
    }
    if (search_type === &quot;multi&quot;){
        search_string = '[&quot;' + search_string.split(&quot;:&quot;).join('&quot;,&quot;') + '&quot;]';
        this.q_param = '{&quot;pert_iname&quot;:{&quot;$in&quot;:&quot;' + search_string + '&quot;},&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}';
    }
    if (search_type === &quot;cell&quot;){
        this.q_param = '{&quot;cell_id&quot;:&quot;' + search_string + '&quot;}';
    }

    // set up the sorting paramter for the api call
    this.s_param = '{&quot;pert_iname&quot;:1}';

    // set up a filtering parameter for the api call
    this.f_param = '{&quot;pert_iname&quot;:1,&quot;pert_type&quot;:1,&quot;pert_id&quot;:1,&quot;num_sig&quot;:1}';

    // build a parameter object for the api call
    var params = {q: this.q_param,
        l: this.limit,
        s: this.s_param,
        f: this.f_param,
        sk: this.skip};

    // make the api call and store the results as individual models in the collection.
    // we don't remove old models in this case as we want to support continuous building
    // of the model list from a remote api.  On success, set isLoading back to false
		$.getJSON(this.url, params, function(res){
        self.set(res,{remove: false});
        self.isLoading = false;
    });

    // make a second api call to find the maximum number of items in the collection
    // and set that as an attribute on it
    if (this.maxCount == Infinity){
        params = _.omit(params,['l','s','f','sk']);
        params = _.extend(params,{c: true});
        $.getJSON(this.url,params,function(res){
            self.maxCount = res.count;
        });
    }
}
});</code></pre></span>
          <section id="SignatureCollection">
            <h1>SignatureCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.SignatureCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p><code>pert_collection = new SignatureCollection({model: PertModel,
                                        // url: Barista.APIURL + &#39;/a2/siginfo?callback=?&#39;,
                                        // skip: 0,
                                        // isLoading: false});</code></p><p>A Backbone.Collection that represents a set of signatures<br />This collection is suitable for internal use in GridView<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to <em>PertModel</em></p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated,                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation, defaults to false</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.SignatureCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetch model data from assigned url</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
    // the url from which model data is fetched
    this.url =  Barista.APIURL + '/a2/siginfo?callback=?';
},</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for the collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.SignatureModel,</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="maxCount">
            <h1>maxCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>maxCount</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the maximum size of the collection<br />defaults to Infinity</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">maxCount: Infinity,</code></pre></span>
          <section id="gold_only">
            <h1>gold_only</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>gold_only</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>boolean flag telling the collection to only include gold Connectivity Map signatures</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">gold_only: true,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br />the count and pert_types data is replaced with new data coming from the api call<br /><code>SignatureCollection.getData(search_string,search_type,limit)</code></p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_type,limit){
    var self = this;
    // set isLoading to true so we don't constantly make api calls before the data comes back
    this.isLoading = true;

    // store the value of search_string, search_type, and limit on the collection object
    this.search_string = (search_string !== undefined) ? search_string : &quot;&quot;;
    this.search_type = (search_type !== undefined) ? search_type : &quot;&quot;;
    this.limit = (limit !== undefined) ? limit : 30;

    // depending on the type of query we are making, set up the q param for the api call.
    // if we are doing a single query, match that query as a regular expression. If we are
    // doing a multi query, match exact names. If we are doing a cell line query, only match
    // cell_ids
    if (search_type === &quot;single&quot; || search_type === &quot;&quot;){
        if (this.gold_only){
            this.q_param = '{&quot;pert_id&quot;:&quot;' + search_string + '&quot;,&quot;is_gold&quot;:1}';
        }else{
            this.q_param = '{&quot;pert_id&quot;:&quot;' + search_string + '&quot;}';
        }
    }
    if (search_type === &quot;multi&quot;){
        search_string = '[&quot;' + search_string.split(&quot;:&quot;).join('&quot;,&quot;') + '&quot;]';
        if (this.gold_only){
            this.q_param = '{&quot;pert_id&quot;:{&quot;$in&quot;:&quot;' + search_string + '&quot;},&quot;is_gold&quot;:1,&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}';
        }else{
            this.q_param = '{&quot;pert_id&quot;:{&quot;$in&quot;:&quot;' + search_string + '&quot;},&quot;pert_type&quot;:{&quot;$regex&quot;:&quot;^(?!.*c[a-z]s$).*$&quot;}}';
        }
    }
    if (search_type === &quot;cell&quot;){
        if (this.gold_only){
            this.q_param = '{&quot;cell_id&quot;:&quot;' + search_string + '&quot;,&quot;is_gold&quot;:1}';
        }else{
            this.q_param = '{&quot;cell_id&quot;:&quot;' + search_string + '&quot;}';
        }
    }

    // set up the sorting paramter for the api call
    this.s_param = '{&quot;pert_id&quot;:1}';

    // set up a filtering parameter for the api call
    this.f_param = '{&quot;pert_id&quot;:1,&quot;pert_type&quot;:1,&quot;pert_iname&quot;:1,&quot;pert_itime&quot;:1,&quot;pert_idose&quot;:1,&quot;cell_id&quot;:1,&quot;sig_id&quot;:1,&quot;is_gold&quot;:1,&quot;distil_ss&quot;:1,&quot;distil_cc_q75&quot;:1,&quot;ngenes_modulated_dn_lm&quot;:1,&quot;ngenes_modulated_up_lm&quot;:1}';

    // build a parameter object for the api call
    var params = {q: this.q_param,
        l: this.limit,
        s: this.s_param,
        f: this.f_param,
        sk: this.skip};

    // make the api call and store the results as individual models in the collection.
    // we don't remove old models in this case as we want to support continuous building
    // of the model list from a remote api.  On success, set isLoading back to false
		var getData_promise = $.getJSON(this.url, params, function(res){
        self.set(res,{remove: false});
        self.isLoading = false;
    });

    // make a second api call to find the maximum number of items in the collection
    // and set that as an attribute on it
    if (this.maxCount == Infinity){
        params = _.omit(params,['l','s','f','sk']);
        params = _.extend(params,{c: true});
        $.getJSON(this.url,params,function(res){
            self.maxCount = res.count;
        });
    }

    // return the getData_promise for use with downstream functions if we want
    return getData_promise;
}
});</code></pre></span>
          <section id="SummlyResultCollection">
            <h1>SummlyResultCollection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Collections.SummlyResultCollection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_collection = new PertCollection({model: PertModel,<br />                                        url: Barista.APIURL + &#39;/a2/pertinfo?callback=?&#39;,<br />                                        skip: 0,<br />                                        isLoading: false});</p><p>A Backbone.Collection that represents a set of CMap Summly results<br />This collection is suitable for internal use in GridView<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>model</td>
                <td>Backbone.model</td>
                <td><p>the model used for the collection objects, defaults to <em>PertModel</em></p></td>
              </tr>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the url from which model data is fetched, defaults to                                    &#39;//api.lincscloud.org/a2/pertinfo?callback=?&#39;</p></td>
              </tr>
              <tr>
                <td>skip</td>
                <td>string</td>
                <td><p>the skip parameter used in api calls when the collection is updated,                                    defaults to 0</p></td>
              </tr>
              <tr>
                <td>isLoading</td>
                <td>boolean</td>
                <td><p>indicates wether or not the collection is in the middle of a fetch                                    operation, defaults to false</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Collections.SummlyResultCollection = Backbone.Collection.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fetch model data from assigned url</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// the url from which model data is fetched
	this.url =  Barista.APIURL + '/a2/pertinfo?callback=?';
},</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the model used for collection objects</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: Barista.Models.SummlyResultModel,</code></pre></span>
          <section id="skip">
            <h1>skip</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>skip</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the skip parameter used in api calls when the collection is updated</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">skip: 0,</code></pre></span>
          <section id="isLoading">
            <h1>isLoading</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>isLoading</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>indicates wether or not the collection is in the middle of a fetch operation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">isLoading: false,</code></pre></span>
          <section id="maxCount">
            <h1>maxCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>maxCount</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the maximum size of the collection<br />defaults to Infinity</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">maxCount: Infinity,</code></pre></span>
          <section id="getData">
            <h1>getData</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getData()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets additional data from the specified url and stores them as models in the collection<br />the count and pert_types data is replaced with new data coming from the api call</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_string</td>
                <td>string</td>
                <td><p>the string on which a regex search into the api at the collections                                  url will be performed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed, defaults to &quot;single&quot;</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched, defaults to 30</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getData: function(search_string,search_type,limit){
		var self = this;
		// set isLoading to true so we don't constantly make api calls before the data comes back
		this.isLoading = true;

		// store the value of search_string, search_type, and limit on the collection object
    this.search_string = search_string;
    this.search_type = search_type;
    this.limit = (limit !== undefined) ? limit : 30;

		// depending on the type of query we are making, set up the q param for the api call.
    // if we are doing a single query, match that query as a regular expression. If we are
    // doing a multi query, match exact names. If we are doing a cell line query, only match
    // cell_ids
    if (search_type === &quot;single&quot; || search_type === undefined){
        this.q_param = '{&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;' + &quot;&quot; + '&quot;,&quot;$options&quot;:&quot;i&quot;}}';
    }
    if (search_type === &quot;multi&quot;){
        search_string = '[&quot;' + search_string.split(&quot;:&quot;).join('&quot;,&quot;') + '&quot;]';
        this.q_param = '{&quot;pert_iname&quot;:{&quot;$in&quot;:&quot;' + search_string + '&quot;}}';
    }

		// build a parameter object for the api call
    var params = {q: this.q_param,
        l: this.limit,
        s: '{&quot;num_gold&quot;:1}',
        sk: Math.round(Math.random() * (40000 - 30))};

		// make the api call and store the results as individual models in the collection.
    // we don't remove old models in this case as we want to support continuous building
    // of the model list from a remote api.  On success, set isLoading back to false
		$.getJSON(this.url,params,function(res){
			var data = [];
			var cell_lines = [&quot;ASC&quot;,&quot;HA1E&quot;,&quot;HCC515&quot;,&quot;NEU&quot;,&quot;NPC&quot;,&quot;PHH&quot;,&quot;SKL&quot;,
							&quot;MCF7&quot;,&quot;HEPG2&quot;,&quot;VCAP&quot;,&quot;A549&quot;,&quot;A375&quot;,&quot;HT29&quot;,&quot;PC3&quot;];
			res.forEach(function(o){
				var random_lines = cell_lines.slice(0, Math.round(Math.random()*14) + 1);
				var random_line_scores = {};
				random_lines.forEach(function(line){
					random_line_scores[line] = [Math.random()*2 - 1];
				});
				data.push({query: search_string,
							target: o.pert_iname,
							pert_type: o.pert_type,
							summly_score: Math.random(),
							summly_rank: Math.random(),
							specificity: Math.random(),
							cell_line_scores: random_line_scores});
			});
			self.add(data);
			self.isLoading = false;
		});

    // make a second api call to find the maximum number of items in the collection
    // and set that as an attribute on it
    if (this.maxCount &lt; Infinity){
        params = _.omit(params,['l','s','f','sk']);
        params = _.extend(params,{c: true});
        $.getJSON(this.url,params,function(res){
            self.maxCount = res.count;
        });
    }
}
});</code></pre></span>
          <section id="BaristaBaseView">
            <h1>BaristaBaseView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.BaristaBaseView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>base_view = new BaristaBaseView({el: $(&quot;target_selector&quot;,<br />                                    bg_color:&quot;#ffffff&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;col-lg-12&quot;,<br />                                    plot_height: 120});<br />to extend BaristaBaseView, use</p><pre><code>    extended_view = BaristaBaseView.extend({
                                    ...
                                    });
</code></pre><p>A Backbone.View the serves as the base view for other views in the barista library<br />BaristaBaseView provides common functionality for views including standard initialization, redraw,<br />render, template compilation, and png export functions<br />This view by itself will construct a single panel with a png export option, but it is meant to be used<br />as the base view that more complex views extend<br />basic use:<br />base_view = new BaristaBaseView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                               #ffffff</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults                               to #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                               &quot;col-lg-12&quot;</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the plot in pixels, defaults to 120</p></td>
              </tr>
              <tr>
                <td>png</td>
                <td>boolean</td>
                <td><p>show the png export button. defaults to true</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.BaristaBaseView = Backbone.View.extend({</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the view<br />Views that extend BaristaBaseView should impliment code overiding this method<br />If extended BaristaBaseViews want to use the built in base_initialize method of BaristaBaseView, they<br />should call it in their redraw method<br />As an example:<br />initialize: function(){<br />                this.base_initialize();<br />                //your code here<br />                }</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	this.base_initialize();
},</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;BaristaBaseView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>default model to Backbone.Model<br />This default is only provided to make the view functional as a un-extended standalone<br />An appropriate data model should be supplied for all views that extend BaristaBaseView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Backbone.Model(),</code></pre></span>
          <section id="base_initialize">
            <h1>base_initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>base_initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view<br />This method is provided so it can be used in view that extend BaristaBaseView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">base_initialize: function(){
	// set up color options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#ffffff&quot;;
	this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : &quot;#1b9e77&quot;;

	// set up the default height for the plot
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 120;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;col-lg-12&quot;;

	// set up the png option
	this.png = (this.options.png !== undefined) ? this.options.png : true;

	// bind render to model changes
	this.listenTo(this.model,'change', this.update);

	// compile the default template for the view
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).outerWidth();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// make sure that the top level div target is set to hide overflow content
	$(&quot;#&quot; + this.div_string).css(&quot;overflow&quot;,&quot;hidden&quot;);

	// render the vis
	this.render();

	// bind window resize events to redraw
	var self = this;
	$(window).resize(function() {self.render();} );

	return this;
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	this.div_string = 'barista_view' + new Date().getTime();
	this.compiled_template = BaristaTemplates.d3_target;
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view<br />Views that extend BaristaBaseView should impliment draw code overiding this method<br />If extended BaristaBaseViews want to use the built in base_render method of BaristaBaseView, they should<br />call it in their render method<br />As an example:<br />render: function(){<br />            this.base_render();<br />            //your code here<br />            }</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	this.base_render();
	return this;
},</code></pre></span>
          <section id="base_render">
            <h1>base_render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>base_render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view<br />Updates both static and dynamic content in the view<br />This method is provided so it can be used in view that extend BaristaBaseView</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">base_render: function(){
	// stuff this into a variable for later use
	var self = this;

	// check to see if the container is visible, if not, make it visible, but transparent so we draw it with
	// the proper dimensions
	if (this.$el.is(&quot;:hidden&quot;)){
		this.$el.animate({opacity:0},1);
		this.$el.show();
	}

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	this.vis.selectAll('.controls_layer').data([]).exit().remove();
	this.controls_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;controls_layer&quot;);

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).outerWidth();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();

	// rescale the width of the vis
	this.vis.transition().attr(&quot;width&quot;,this.width);
	this.vis.transition().attr(&quot;height&quot;,this.height);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// add a png export overlay
	if (this.png) {
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});
	}


	return this;
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic portions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
	return this;
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	// do any pre save work that the child class may require
	this.save_png_pre();

	//set the animate the div containing the view by applying and then removing
	// css classes that defined the transitions we want
	var $div = $(&quot;#&quot; + this.div_string);
	$div.addClass(&quot;barista-base-view&quot;);
	$div.toggleClass(&quot;exporting&quot;);
	setTimeout(function(){$div.toggleClass(&quot;exporting&quot;);},500);

	// build a canvas element to store the image temporarily while we save it
	var width = this.width;
	var height = this.height;
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = this.name + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){
		canvas.toBlob(function(blob){
			saveAs(blob,filename);
			});
	}
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);

	// do any post save work that the child class may require
	this.save_png_post();
},</code></pre></span>
          <section id="save_png_pre">
            <h1>save_png_pre</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png_pre()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>dummy method that should be overridden if there is any work to do before saving the png image of<br />the view<br />For example, removing elements that will not render properly could be done before saving the image<br />This function is called as the first step of save_png</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png_pre: function(){},</code></pre></span>
          <section id="save_png_post">
            <h1>save_png_post</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png_post()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>dummy method that should be overridden if there is any work to do after saving the png image of<br />the view<br />For example, restoring elements that were removed before saving could be done after saving the image<br />This function is called as the last step of save_png</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png_post: function(){},</code></pre></span>
          <section id="hide">
            <h1>hide</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>hide()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hides the view by dimming the opacity and hiding it in the DOM</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the time in ms for the hide animation. defualts to 1 pert_detail_view.hide(duration);</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">hide: function(duration){
	duration = (duration !== undefined) ? duration : 1;
	var self = this;
	this.$el.animate({opacity:0},duration);
	setTimeout(function(){self.$el.hide()},duration);
},</code></pre></span>
          <section id="show">
            <h1>show</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>show()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>shows the view by brightening the opacity and showing it in the DOM</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the time in ms for the hide animation, defualts to <em>1</em> pert_detail_view.show(duration);</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">show: function(duration){
	duration = (duration !== undefined) ? duration : 1;
	this.$el.show();
	this.$el.animate({opacity:1},duration);
}
});</code></pre></span>
          <section id="BarPlotView">
            <h1>BarPlotView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.BarPlotView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>bar_plot_view = new BarPlotView({el: $(&quot;target_selector&quot;,<br />                                    bg_color:&quot;#ffffff&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;span4&quot;,<br />                                    scale_by: undefined,<br />                                    range: undefined,<br />                                    log: false,<br />                                    min_lock: undefined,<br />                                    max_lock: undefined,<br />                                    min_expand: false,<br />                                    max_expand: false,<br />                                    plot_height: 120});</p><p>A Backbone.View that displays a scatter plot<br />the view&#39;s model is assumed to have the same defaults as specified in BarPlotModel<br />basic use:<br />bar_plot_view = new BarPlotView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                               #ffffff</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults to                               #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                               &quot;span12&quot;</p></td>
              </tr>
              <tr>
                <td>range</td>
                <td>array</td>
                <td><p>a two element array specifying the plotting bounds of the plot, defaults                               to [min(data),max(data)]</p></td>
              </tr>
              <tr>
                <td>log</td>
                <td>boolean</td>
                <td><p>if set to true, plots the data on a log scale, defaults to false</p></td>
              </tr>
              <tr>
                <td>min_lock</td>
                <td>number</td>
                <td><p>if set, locks the minimum of the range at the given value. Ignored if                               range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>max_lock</td>
                <td>number</td>
                <td><p>if set, locks the maximum of the range at the given value. Ignored if                               range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>min_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the minimum of the range to expand if data is found below                               it. defaults to false</p></td>
              </tr>
              <tr>
                <td>max_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the maximum of the range to expand if data is found above                               it. defaults to false</p></td>
              </tr>
              <tr>
                <td>orientation</td>
                <td>string</td>
                <td><p>sets the orientation of the bar plot. options are &#39;horizontal&#39; or                               &#39;vertical&#39;. defaults to &#39;vertical&#39;</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the plot in pixels, defaults to <em>120</em></p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.BarPlotView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.BarPlotModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up x and y range and determine if are going to draw the axes dynamically
	this.range = (this.options.range !== undefined) ? this.options.x_range : undefined;
	this.dynamic_range = (this.range === undefined) ? true : false;

	// set up axis expansion and lock features
	this.min_lock = (this.options.min_lock !== undefined) ? this.options.min_lock : undefined;
	this.max_lock = (this.options.max_lock !== undefined) ? this.options.max_lock : undefined;

	this.min_expand = (this.options.min_expand !== undefined) ? this.options.min_expand : undefined;
	this.max_expand = (this.options.max_expand !== undefined) ? this.options.max_expand : undefined;

	// set up log flag
	this.log = (this.options.log !== undefined) ? this.options.log : false;

	// set up the margin
	this.margin = (this.options.margin !== undefined) ? this.options.margin : 50;

	// set up the orientation
	this.orientation = (this.options.orientation !== undefined) ? this.options.orientation : 'vertical';

	// set up x and y ranges
	this.set_ranges();

	// set up x and y scaling
	this.set_scales();		

	// run BaristaBaseView's base_initialize method to handle boilerplate view construction
	// and initial view rendering
	this.base_initialize();

	// build Axes
	this.build_axes();

},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	this.base_render();
	this.init_plot();
	this.update();
},</code></pre></span>
          <section id="init_plot">
            <h1>init_plot</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_plot()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_plot: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up x and y ranges
	this.set_ranges();

	// set up x and y scaling
	this.set_scales();		

	// build Axes
	this.build_axes();

	// style the axis
	this.style_axes();

	// render the bar data
	if (this.orientation === 'horizontal'){
		this.render_horizontal_bars();
	}else{
		this.render_vertical_bars();
	}

	// plot the title
	this.bg_layer.selectAll('.title').data([]).exit().remove();
	this.bg_layer.selectAll('.title').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;title title&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.margin/2)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('title'));
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
	var self = this;
	
	// get model data
	this.data = this.model.get('data');
	
	// set up x and y ranges
	this.set_ranges();

	// set up x and y scaling
	this.set_scales();

	// build Axes
	this.build_axes();

	// update the bar data
	if (this.orientation === 'horizontal'){
		this.update_horizontal_bars();
	}else{
		this.update_vertical_bars();
	}
},</code></pre></span>
          <section id="set_ranges">
            <h1>set_ranges</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_ranges()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to get the x and y ranges used in the plot</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_ranges: function(){
	var data,min,max;
	// calculate the range. If we need to caluclate it dynamically, check the lock and expand
	// parameters for the axis
	if (this.dynamic_range === true){
		data = this.model.get('data');

		// if the data is of length larger than 1, calculate the range, otherwise set the range to [0,0]
		if (data.length &gt; 0 ){
			// check the min lock and expand flags and report the min of the range accordingly
			if (this.min_lock === undefined){
				min = _.min(data);
			}else{
				if (this.min_expand){
					data_min = _.min(data);
					min = (this.min_lock &gt; data_min) ? data_min : this.min_lock;
				}else{
					min = this.min_lock;
				}
			}

			// check the max lock and expand flags and report the max of the range accordingly
			if (this.max_lock === undefined){
				max = _.max(data);
			}else{
				if (this.max_expand){
					data_max = _.max(data);
					max = (this.max_lock &lt; data_max) ? data_max : this.max_lock;
				}else{
					max = this.max_lock;
				}
			}
			this.range = [min,max];
		}else{
			this.range = [0,0];
		}
	}
},</code></pre></span>
          <section id="set_scales">
            <h1>set_scales</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_scales()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to get the x and y scales used in the plot</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_scales: function(){
	if (this.log){
		this.x_scale=d3.scale.log().domain([this.range[0],this.range[1]]).range([this.margin, this.width - this.margin]);
	}else{
		this.x_scale=d3.scale.linear().domain([this.range[0],this.range[1]]).range([this.margin, this.width - this.margin]);
	}
	if (this.log){
		this.y_scale=d3.scale.log().domain([this.range[1],this.range[0]]).range([this.margin, this.height - this.margin]);
	}else{
		this.y_scale=d3.scale.linear().domain([this.range[1],this.range[0]]).range([this.margin, this.height - this.margin]);
	}
},</code></pre></span>
          <section id="build_axes">
            <h1>build_axes</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>build_axes()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to build x and y axes</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">build_axes: function(){
	var self = this;

	this.xAxis = d3.svg.axis()
		.scale(this.x_scale)
		.orient(&quot;bottom&quot;);
	this.yAxis = d3.svg.axis()
		.scale(this.y_scale)
		.orient(&quot;left&quot;);

	// plot the appropriate axis depending on the orientation of the plot
	this.bg_layer.selectAll('.axis').data([]).exit().remove();
	if (this.orientation === 'horizontal'){
			self.bg_layer.append(&quot;g&quot;)
				.attr(&quot;class&quot;, &quot;axis x-axis&quot;)
				.attr(&quot;transform&quot;, &quot;translate(0,&quot; + (self.height - self.margin) + &quot;)&quot;)
				.call(self.xAxis);
	}else{
		self.bg_layer.append(&quot;g&quot;)
			.attr(&quot;class&quot;, &quot;axis y-axis&quot;)
			.attr(&quot;transform&quot;, &quot;translate(&quot; + self.margin + &quot;,0)&quot;)
			.call(self.yAxis);
	}
},</code></pre></span>
          <section id="style_axes">
            <h1>style_axes</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>style_axes()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to apply custom styles to axis components</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">style_axes: function(){
	this.vis.selectAll('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);
},</code></pre></span>
          <section id="render_vertical_bars">
            <h1>render_vertical_bars</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render_vertical_bars()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws bars in vertical mode</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render_vertical_bars: function(){
	var self = this;
	// get the model's data
	this.data = this.model.get('data');

	// figure out how wide each bar will be
	this.x_domain = this.x_scale.range();
	this.bar_width = (this.x_domain[1] - this.x_domain[0]) / this.data.length;

	// plot the data points
	this.bg_layer.selectAll('.data_bar').data([]).exit().remove();
	this.bg_layer.selectAll('.data_bar').data(this.data).enter().append('rect')
		.attr(&quot;class&quot;,&quot;data_bar&quot;)
		.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin;})
		.attr(&quot;y&quot;,this.y_scale(this.range[0]))
		.attr(&quot;width&quot;,this.bar_width)
		.attr(&quot;height&quot;,0)
		.attr(&quot;opacity&quot;,0)
		.attr(&quot;stroke&quot;,&quot;white&quot;)
		.attr(&quot;fill&quot;,this.fg_color);

	// plot the x axis title
	this.bg_layer.selectAll('.x_axis_label').data([]).exit().remove();
	this.bg_layer.selectAll('.x_axis_label').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;x_axis_label axis_label&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.height-10)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('axis_title'));

	// plot the labels if they are there
	var labels = this.model.get('data_labels');
	if (labels.length &gt; 0){
		this.bg_layer.selectAll('.bar_label').data([]).exit().remove();
		this.bg_layer.selectAll('.bar_label').data(labels).enter().append('text')
			.attr('class','bar_label')
			.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin + self.bar_width/2;})
			.attr('y',this.height - this.margin)
			.attr('dy','1em')
			.attr('opacity',0)
			.style(&quot;text-anchor&quot;,&quot;middle&quot;)
			.text(function(d){return d;});
	}

	// style the axis
	this.style_axes();
},</code></pre></span>
          <section id="render_horizontal_bars">
            <h1>render_horizontal_bars</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render_horizontal_bars()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws bars in horizontal mode</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render_horizontal_bars: function(){
	var self = this;
	// get the model's data
	this.data = this.model.get('data');

	// figure out how tall each bar will be
	this.y_domain = this.y_scale.range();
	this.bar_height = (this.y_domain[1] - this.y_domain[0]) / this.data.length;

	// plot the data points
	this.bg_layer.selectAll('.data_bar').data([]).exit().remove();
	this.bg_layer.selectAll('.data_bar').data(this.data).enter().append('rect')
		.attr(&quot;class&quot;,&quot;data_bar&quot;)
		.attr(&quot;y&quot;,function(d,i){return self.bar_height*i;})
		.attr(&quot;x&quot;,this.margin + 2)
		.attr(&quot;height&quot;,this.bar_height)
		.attr(&quot;width&quot;,0)
		.attr(&quot;opacity&quot;,0)
		.attr(&quot;stroke&quot;,&quot;white&quot;)
		.attr(&quot;fill&quot;,this.fg_color);

	// plot the x axis title
	this.bg_layer.selectAll('.x_axis_label').data([]).exit().remove();
	this.bg_layer.selectAll('.x_axis_label').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;x_axis_label axis_label&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.height-10)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('axis_title'));
},</code></pre></span>
          <section id="update_vertical_bars">
            <h1>update_vertical_bars</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update_vertical_bars()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>updates the data in the bars in vertical orientation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update_vertical_bars: function(){
	var self = this;
	// build Axes
	this.build_axes();

	// figure out how wide each bar will be
	this.x_domain = this.x_scale.range();
	this.bar_width = (this.x_domain[1] - this.x_domain[0]) / this.data.length;

	// plot new data points
	var bar_selection = this.bg_layer.selectAll('.data_bar').data(this.data);
	bar_selection.enter().append('rect')
		.attr(&quot;class&quot;,&quot;data_bar&quot;)
		.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin;})
		.attr(&quot;y&quot;,this.y_scale(this.range[0]))
		.attr(&quot;width&quot;,this.bar_width)
		.attr(&quot;height&quot;,0)
		.attr(&quot;opacity&quot;,0)
		.attr(&quot;stroke&quot;,&quot;white&quot;)
		.attr(&quot;fill&quot;,this.fg_color);

	// transition points
	bar_selection.transition().duration(500)
		.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin;})
		.attr(&quot;y&quot;,this.y_scale)
		.attr(&quot;width&quot;,this.bar_width)
		.attr(&quot;height&quot;,function(d){return self.y_scale(self.range[0]) - self.y_scale(d)})
		.attr(&quot;opacity&quot;,1);

	// remove excess points 
	bar_selection.exit().remove();

	// update the labels if they are there
	var labels = this.model.get('data_labels');
	if (labels.length &gt; 0){
		var bar_label_selection = this.bg_layer.selectAll('.bar_label').data(labels);
		bar_label_selection.enter().append('text')
			.attr('class','bar_label')
			.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin + self.bar_width/2;})
			.attr('y',this.height - this.margin)
			.attr('dy','1em')
			.attr('opacity',0)
			.style(&quot;text-anchor&quot;,&quot;middle&quot;)
			.text(function(d){return d;});

		bar_label_selection.transition().duration(500)
			.attr(&quot;x&quot;,function(d,i){return self.bar_width*i + self.margin + self.bar_width/2;})
			.attr('y',this.height - this.margin)
			.attr('dy','1em')
			.attr('opacity',1);

		bar_label_selection.exit().remove();
	}else{
		this.bg_layer.selectAll('.bar_label').data([]).exit().remove();
	}

	// transition the axes
	this.vis.selectAll('.y-axis').transition().duration(500).call(this.yAxis);
	this.style_axes();
},</code></pre></span>
          <section id="update_horizontal_bars">
            <h1>update_horizontal_bars</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update_horizontal_bars()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>updates the data in the bars in vertical orientation</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update_horizontal_bars: function(){
	var self = this;
	// figure out how tall each bar will be
	this.y_domain = this.y_scale.range();
	this.bar_height = (this.y_domain[1] - this.y_domain[0]) / this.data.length;

	// plot new data points
	var bar_selection = this.bg_layer.selectAll('.data_bar').data(this.data);
	bar_selection.enter().append('rect')
		.attr(&quot;class&quot;,&quot;data_bar&quot;)
		.attr(&quot;y&quot;,function(d,i){return self.bar_height*i;})
		.attr(&quot;x&quot;,this.margin + 2)
		.attr(&quot;height&quot;,this.bar_height)
		.attr(&quot;width&quot;,0)
		.attr(&quot;opacity&quot;,0)
		.attr(&quot;stroke&quot;,&quot;white&quot;)
		.attr(&quot;fill&quot;,this.fg_color);

	// transition points
	bar_selection.transition().duration(500)
		.attr(&quot;width&quot;,this.x_scale)
		.attr(&quot;opacity&quot;,1);

	// remove excess points 
	bar_selection.exit().remove();

	// transition the axes
	this.vis.selectAll('.x-axis').transition().duration(500).call(this.xAxis);
	this.style_axes();
}
});</code></pre></span>
          <section id="BaristaCardView">
            <h1>BaristaCardView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.BaristaCardView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>card_view = new BaristaCardView({el: $(&quot;target_selector&quot;,<br />                                    url:&quot;&quot;,<br />                                    title:&quot;&quot;,<br />                                    subtitle:&quot;&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    image:&quot;&quot;,<br />                                    span_class: &quot;col-lg-12&quot;});</p><p>A Backbone View that displays a card of information wrapped in link<br />The view is meant to be a top level entry point to other pages<br />basic use:<br />        card_view = new BaristaCardView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>url</td>
                <td>string</td>
                <td><p>the link to navigate to if the card is clicked, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>the title of the card. defaults to &quot;title&quot;</p></td>
              </tr>
              <tr>
                <td>subtitle</td>
                <td>string</td>
                <td><p>the subtitle of the card. defaults to &quot;subtitle&quot;</p></td>
              </tr>
              <tr>
                <td>image</td>
                <td>string</td>
                <td><p>the link to an image to show as the cards main content. defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults to                             #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                             &quot;col-lg-12&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.BaristaCardView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;BaristaCardView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>supply a base model for the view<br />Overide this if you need to use it for dynamic content</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Backbone.Model(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the view&#39;s default initialize method in order to catch options and render a custom template</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : &quot;#1b9e77&quot;;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;col-lg-12&quot;;

	// set up the url
	this.url = (this.options.url !== undefined) ? this.options.url : &quot;&quot;;

	// set up the title
	this.title = (this.options.title !== undefined) ? this.options.title : &quot;Title&quot;;

	// set up the subtitle
	this.subtitle = (this.options.subtitle !== undefined) ? this.options.subtitle : &quot;subtitle&quot;;

	// set up the image
	this.image = (this.options.image !== undefined) ? this.options.image : &quot;&quot;;

	// bind render to model changes
	this.listenTo(this.model,'change', this.update);

	// compile the default template for the view
	this.compile_template();
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	this.div_string = 'barista_view' + new Date().getTime();;
	this.$el.append(BaristaTemplates.CMapCard({div_string: this.div_string,
											span_class: this.span_class,
											url: this.url,
											title: this.title,
											subtitle: this.subtitle,
											image: this.image,
											fg_color: this.fg_color}));
}
});</code></pre></span>
          <section id="BaristaUserCardView">
            <h1>BaristaUserCardView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.BaristaUserCardView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone View that displays a card of information about a user<br />basic use:<br />card_view = new BaristaUserCardView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>realName</td>
                <td>string</td>
                <td><p>the name to display, defaults to &quot;Name&quot;</p></td>
              </tr>
              <tr>
                <td>username</td>
                <td>string</td>
                <td><p>the name to display, defaults to &quot;Username&quot;</p></td>
              </tr>
              <tr>
                <td>email</td>
                <td>string</td>
                <td><p>the email to display, defaults to &quot;user@mail.com&quot;</p></td>
              </tr>
              <tr>
                <td>badges</td>
                <td>string</td>
                <td><p>an array of badge images to display, defaults to []</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.BaristaUserCardView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;BaristaUserCardView&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the view&#39;s default initialize method in order to catch options and render a custom template</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
    // set up defaults
    this.realName = (this.options.realName !== undefined) ? this.options.realName : &quot;Name&quot;;
    this.username = (this.options.username !== undefined) ? this.options.username : &quot;UserName&quot;;
    this.email = (this.options.email !== undefined) ? this.options.email : &quot;user@email.com&quot;;
    this.badges = (this.options.badges !== undefined) ? this.options.badges : [];

    // compile the default template for the view
    this.map_badges();
    this.compile_template();
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
    var self = this;
    this.div_string = 'barista_view' + new Date().getTime();;
    this.$el.append(BaristaTemplates.CMapUserCard({div_string: this.div_string,
                                            name: this.realName,
                                            username: this.username,
                                            email: this.email,
                                            badges: this.badge_urls}));
},</code></pre></span>
          <section id="map_badges">
            <h1>map_badges</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>map_badges()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>translate the passed array of badge names into image urls</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">map_badges: function(){
    var self = this;
    this.badge_urls = [];
    this.badges.forEach(function(badge){
        switch(badge){
            case &quot;active&quot;:
                self.badge_urls.push(&quot;https://coreyflynn.github.io/Bellhop/ai/badges/active.svg&quot;);
                break;
            case &quot;developer&quot;:
                self.badge_urls.push(&quot;https://coreyflynn.github.io/Bellhop/ai/badges/developer.svg&quot;);
                break;
            case &quot;explorer&quot;:
                self.badge_urls.push(&quot;https://coreyflynn.github.io/Bellhop/ai/badges/explorer.svg&quot;);
                break;
        }
    });
}
});</code></pre></span>
          <section id="BubbleView">
            <h1>BubbleView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.BubbleView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>bubble_view = new BubbleView({el: $(&quot;target_selector&quot;),<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;span4&quot;});</p><p>A Backbone.View that displays a single level tree of data as a bubble plot<br />The view should be bound to a model such as a <strong>PertCellBreakdownModel</strong> that captures tree data in a<br />tree_object attribute<br />basic use:<br />bubble_view = new BubbleView({el: $(&quot;target_selector&quot;)});<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults to                             #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to &quot;span4&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.BubbleView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;BubbleView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.PertCellBreakdownModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : &quot;#1b9e77&quot;;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;span4&quot;;

	// set up the plot height
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 120;

	// set up the bubble minimum and maximum scale values
	this.min_val = (this.options.min_val !== undefined) ? this.options.min_val : undefined;
	this.max_val = (this.options.max_val !== undefined) ? this.options.max_val : undefined;

	// set up splitting categories
	this.v_split = (this.options.v_split !== undefined) ? this.options.v_split : undefined;
	this.h_split = (this.options.h_split !== undefined) ? this.options.h_split : undefined;

	// set up splitting category centers
	this.category_centers = (this.options.category_centers !== undefined) ? this.options.category_centers : {up: {x:0,y:-10},dn: {x:0,y:10}};

	// set up category colors
	this.category_colors = (this.options.category_colors !== undefined) ? this.options.category_colors : {up: &quot;#D55E00&quot;,dn: &quot;#56B4E9&quot;};

	// bind render to model changes
	this.listenTo(this.model,'change', this.update);

	// compile the default template for the view
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).outerWidth();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// render the vis
	this.render();

	// bind window resize events to redraw
	var self = this;
	$(window).resize(function() {self.render();} );
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	this.div_string = 'd3_target' + new Date().getTime();;
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draw the view from scratch</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).outerWidth();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.v_center = this.height / 2;
	this.h_center = this.width / 2;

	// rescale the width of the vis
	this.vis.transition().duration(1).attr(&quot;width&quot;,this.width);

	// grab the data from the model
	this.data = this.model.get('tree_object').children;

	// set up some data scaling
	var max_count, min_count;
	if (this.max_val !== undefined){
		max_count = this.max_val;
	}else{
		max_count = _.max(_.pluck(this.data,'count'));
	}
	if (this.min_val !== undefined){
		min_count = this.min_val;
	}else{
		min_count = _.min(_.pluck(this.data,'count'));
	}
	this.data_scale = d3.scale.linear().domain([min_count,max_count])
					.range([5,30]);

	// define the force directed graph layout
	this.force = d3.layout.force()
					.nodes(this.data)
					.gravity(0.1)
					.friction(0.9)
					.size([this.width, this.height])
					.on(&quot;tick&quot;,function(e){tick(e);})
					.charge(function(d){return -Math.pow(self.data_scale(d.count),2)/6;})
					.start();

	// draw the initial layout
	this.vis.selectAll(&quot;circle&quot;).data(this.force.nodes()).exit().remove();
	this.vis.selectAll(&quot;circle&quot;).data(this.force.nodes())
			.enter().append(&quot;circle&quot;)
			.attr(&quot;class&quot;,this.div_string + &quot;_circle&quot;)
			.attr(&quot;fill&quot;,function(d){
				if (self.category_colors[d[self.v_split]] !== undefined){
					return self.category_colors[d[self.v_split]];
				}else{
					return self.fg_color;
				}
			})
			.attr(&quot;v_category&quot;,function(d){
				if (self.v_split !== undefined){
					return d[self.v_split];
				}else{
					return null;
				}
			})
			.attr(&quot;cx&quot;, Math.random() * 300)
			.attr(&quot;cy&quot;, Math.random() * 300)
			.attr(&quot;stroke&quot;,&quot;white&quot;)
			.attr(&quot;_id&quot;,function(d){return d._id;})
			.attr(&quot;r&quot;,function(d){return Math.sqrt(self.data_scale(d.count)/Math.PI);});

	// specify the nodes selection so we don't have to repeat the selection on each tick
        this.nodes = this.vis.selectAll(&quot;circle&quot;);
        this.nodes.call(this.force.drag());

	// reset a dampening variable for simulation
	this.damp = 0.1;</code></pre></span>
          <section id="tick">
            <h1>tick</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">function</div><span>tick()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>tick function for use in the force class, decrements alpha value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>e</td>
                <td>object</td>
                <td><p>data from tick event</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function tick(e){
	self.vertical_split(e.alpha);
	self.nodes.attr(&quot;cx&quot;, function(d) {return d.x;})
                .attr(&quot;cy&quot;, function(d) {return d.y;})
                // .attr(&quot;r&quot;,function(d){return self.data_scale(d.count);});

        }
	},</code></pre></span>
          <section id="vertical_split">
            <h1>vertical_split</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>vertical_split()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>push bubbles vertically based on an attribute property</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>alpha</td>
                <td>number</td>
                <td><p>in combination with damp value, creates spring constant for bubble animation</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">vertical_split: function(alpha){
	var self = this;
	//select all circles on the page
	bubble_selection = this.vis.selectAll('circle');
	bubble_selection
	//edit the center y attribute
		.attr(&quot;cy&quot;,function(d){
			//if the vertical split category is undefined, return the y value of d
			if (self.category_centers[d[self.v_split]] === undefined){
				return(d.y);
			}
			//if the value of the vertical split category is 0, return the y value of d
			var category_y = self.category_centers[d[self.v_split]].y;
			if (category_y === 0){
				return(d.y);
			}
			//otherwise, add the current d.y value to the product of equations involving the vertical
			//center, vertical split category, dampening value, and alpha value
			else{
				d.y = d.y + (self.v_center + category_y - d.y) * (self.damp + 0.03) * alpha * 1.1;
				return(d.y);
			}
		})
		//edit the center x attribute
		.attr(&quot;cx&quot;,function(d){
			//if the vertical split category is undefined, return the y value of d
			if (self.category_centers[d[self.v_split]] === undefined){
				return(d.x);
			}
			//if the value of the vertical split category is 0, return the x value of d
			var category_x = self.category_centers[d[self.v_split]].x;
			if (category_x === 0){
				return(d.x);
			}
			//otherwise, add the current d.x value to the product of equations involving the horizontal
			//center, vertical split category, dampening value, and alpha value
			else{
				d.x = d.x + (self.h_center - category_x - d.x) * (self.damp + 0.03) * alpha * 1.1;
				return (d.x);
			}
		});
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the plot with new data</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
	// stuff this into a variable for later use
	var self = this;

	// grab the data from the model
	var new_data = this.model.get('tree_object').children;

	// grab the current nodes
	var nodes = this.force.nodes();

	// update the nodes in this.force
	if (this.force.nodes().length &lt;= new_data.length){
		this.force.nodes().forEach(function(o,i){
			_.extend(o,new_data[i]);
			_.extend(o,{x:nodes[i]['x'],y:nodes[i]['y']});
		});
		if (this.force.nodes().length &lt; new_data.length){
			this.force.nodes(this.force.nodes().concat(new_data.slice(this.force.nodes().length,new_data.length)));
		}
	}else{
		this.force.nodes(this.force.nodes().slice(0,new_data.length));
		this.force.nodes().forEach(function(o,i){
			_.extend(o,new_data[i]);
			_.extend(o,{x:nodes[i]['x'],y:nodes[i]['y']});
		});
	}

	// draw the initial layout for new bubbles
	bubble_selection = this.vis.selectAll(&quot;circle&quot;).data(this.force.nodes());
	bubble_selection.enter()
			.append(&quot;circle&quot;)
			.attr(&quot;class&quot;,this.div_string + &quot;_circle&quot;)
			.attr(&quot;fill&quot;,function(d){
				if (self.category_colors[d[self.v_split]] !== undefined){
					return self.category_colors[d[self.v_split]];
				}else{
					return self.fg_color;
				}
			})
			.attr(&quot;cx&quot;, function(d){return d.x;})
			.attr(&quot;cy&quot;, function(d){return d.y;})
			.attr(&quot;stroke&quot;,&quot;white&quot;)
			.attr(&quot;_id&quot;,function(d){return d._id;})
			.attr(&quot;r&quot;,0);

	// transition bubbles
	bubble_selection.transition().duration(500)
			.attr(&quot;r&quot;,function(d){return self.data_scale(d.count);});

	// remove bubbles with no data
	bubble_selection.exit().remove();

	// start the simulation again
	this.force.start();

	// specify the nodes selection so we don't have to repeat the selection on each tick
        this.nodes = this.vis.selectAll(&quot;circle&quot;);
        this.nodes.call(this.force.drag());</code></pre></span>
          <section id="tick">
            <h1>tick</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">function</div><span>tick()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>tick function for use in the force class, decrements alpha value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>e</td>
                <td>object</td>
                <td><p>data from tick event</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function tick(e){
	self.vertical_split(e.alpha);
	self.nodes.attr(&quot;cx&quot;, function(d) {return d.x;})
                .attr(&quot;cy&quot;, function(d) {return d.y;})
                .attr(&quot;r&quot;,function(d){return self.data_scale(d.count);});

        }

	}
});</code></pre></span>
          <section id="CMapFooterView">
            <h1>CMapFooterView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.CMapFooterView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>header = new CMapFooterView({el:&quot;footer_target&quot;,<br />                                    organization: &quot;Broad Institute&quot;,<br />                                    terms_url: &quot;//lincscloud.org/terms-and-conditions/&quot;,<br />                                     logo: [&#39;../img/broad_logo_small.png&#39;,&#39;../img/cmap_logo_small.png&#39;],<br />                                     logo_url: [&#39;//www.broadinstitute.org/&#39;,&#39;//lincscloud.org/&#39;],<br />                                    template: &quot;../templates/CMapFooter.handlebars&quot;});</p><p>A view that provides the standard Connectivity map page footer for apps built on apps.lincscloud.org<br />the view provides standard copyright text and customizable organization name, terms and conditions link,<br />and organization logo/link<br />basic use:<br />header = new CMapHeaderView({el:&quot;header_target&quot;});<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>organization</td>
                <td>string</td>
                <td><p>the name of the organization that claims copyright. Defaults to Broad                               Institute</p></td>
              </tr>
              <tr>
                <td>terms_url</td>
                <td>string</td>
                <td><p>The url on which to find terms and conditions. Defaults to                               &#39;//lincscloud.org/terms-and-conditions/&#39;</p></td>
              </tr>
              <tr>
                <td>logo</td>
                <td>array</td>
                <td><p>The urls to organization logos to use. Defaults to                               [&#39;//coreyflynn.github.io/Bellhop/img/broad_logo_small.png&#39;,<br />                              &#39;//coreyflynn.github.io/Bellhop/img/cmap_logo_small.png&#39;]</p></td>
              </tr>
              <tr>
                <td>logo_url</td>
                <td>array</td>
                <td><p>The urls to organization links to use. Defaults to                               [&#39;//www.broadinstitute.org/&#39;,&#39;//lincscloud.org/&#39;]</p></td>
              </tr>
              <tr>
                <td>template</td>
                <td>string</td>
                <td><p>The path to a handlebars template to use. Defaults to                               templates/CMapFooter.handlebars</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.CMapFooterView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CMapFooterView&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize function to compile a built in template and then render<br />the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// store passed parameters as attributes of the view
	this.organization = (this.options.organization !== undefined) ? this.options.organization : &quot;Broad Institute&quot;;
	this.terms_url = (this.options.terms_url !== undefined) ? this.options.terms_url : &quot;/terms&quot;;
	this.logo = (this.options.logo !== undefined) ? this.options.logo : ['//coreyflynn.github.io/Bellhop/img/broad_logo_small_text.png','//coreyflynn.github.io/Bellhop/img/CMap-logox.png','//coreyflynn.github.io/Bellhop/img/skunkworks-logo.png'];
	this.logo_url = (this.options.logo_url !== undefined) ? this.options.logo_url : ['//www.broadinstitute.org/','//clue.io/','//www.broadinstitute.org/vis'];
	this.template = (this.options.template !== undefined) ? this.options.template : &quot;templates/CMapFooter.handlebars&quot;;

	// compile the default template for the view
	this.compile_template();

	// render the template
	this.render();
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the specified template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	// grab the template
	this.compiled_template = BaristaTemplates.CMapFooter;

	// package logos and log_urls into a set of object to iterate over
	var logo_objects = []
	for (var i=0; i &lt; this.logo.length; i++){
		logo_objects.push({logo: this.logo[i], url: this.logo_url[i]});
	}
	this.$el.append(this.compiled_template({organization: this.organization,
									terms_url: this.terms_url,
									logo_objects: logo_objects,
									year: new Date().getFullYear()}));
}
});</code></pre></span>
          <section id="CMapHeaderView">
            <h1>CMapHeaderView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.CMapHeaderView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>header = new CMapHeaderView({el:&quot;header_target&quot;,<br />                                    title: &quot;&quot;,<br />                                    subtitle: &quot;&quot;,<br />                                    template: &quot;templates/CMapHeader.handlebars&quot;});</p><p>A view the provides the standard Connectivity map page header for apps built on apps.lincscloud.org<br />the header provides links in the view to navigate back to apps.lincscloud.org as well as links for<br />sharing, settings, and information<br />The view accepts as parameters a page title, subtitle, and handlebars template<br />basic use:<br />header = new CMapHeaderView({el:&quot;header_target&quot;});<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>title</td>
                <td>string</td>
                <td><p>The title of the page. Defaults to Title</p></td>
              </tr>
              <tr>
                <td>subtitle</td>
                <td>string</td>
                <td><p>The title of the page. Defaults to Sub Title</p></td>
              </tr>
              <tr>
                <td>template</td>
                <td>string</td>
                <td><p>The path to a handlebars template to use. Defaults to                           templates/CMapHeader.handlebars</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.CMapHeaderView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CMapHeaderView&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize function to compile a built in template and then render<br />the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
        var self = this;

        // store passed parameters as attributes of the view
	this.title = (this.options.title !== undefined) ? this.options.title : undefined;
	this.subtitle = (this.options.subtitle !== undefined) ? this.options.subtitle : &quot;&quot;;
	this.user = (this.options.user !== undefined) ? this.options.user : Barista.Utils.cookie(&quot;user_id&quot;);
	this.support_link = (this.options.support_link !== undefined) ? this.options.support_link : &quot;//support.lincscloud.org&quot;;
	this.app_color = (this.options.app_color !== undefined) ? this.options.app_color : undefined;
	this.tour = (this.options.tour !== undefined) ? this.options.tour : true;

	// compile the default template for the view
	this.compile_template();

	// register an event for clicking on the menu button
        $(&quot;.cmapHeaderMenuButton&quot;,this.$el).on(&quot;click&quot;,function(){
            self.trigger(&quot;cmapHeaderMenuButton:DidClick&quot;);
		$(&quot;.cmap-navigation-wrapper&quot;).toggleClass(&quot;show-nav&quot;);
        });

	//color the app name bar if a color is specified
	if (this.app_color){
		$('#cmapHeaderMenuAppName').css('border-bottom','5px solid ' + this.app_color);
	}
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the specified template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	// grab the template
	this.compiled_template = BaristaTemplates.CMapHeader;
	this.$el.append(this.compiled_template({title: this.title,
									subtitle: this.subtitle,
									user: this.user,
									support_link: this.support_link,
									tour: this.tour
								}));
}
});</code></pre></span>
          <section id="CMapNavigationView">
            <h1>CMapNavigationView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.CMapNavigationView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A view the provides the standard Connectivity map application navigation for apps built on<br />apps.lincscloud.org<br />basic use:<br />nav = new CMapNavigationView({el:&quot;header_target&quot;});</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.CMapNavigationView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CMapNavigationView&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize function to compile a built in template and then render<br />the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
        var self = this;

        // store passed parameters as attributes of the view
			this.items = (this.options.items !== undefined) ? this.options.items : [&quot;all apps&quot;,&quot;data synopsis&quot;,&quot;query&quot;,&quot;compound digest&quot;,&quot;gene digest&quot;,&quot;PCL&quot;,&quot;Concordance&quot;,&quot;history&quot;];
        this.links = (this.options.links !== undefined) ? this.options.links : [&quot;/app_list&quot;,&quot;/data_synopsis&quot;,&quot;/query&quot;,&quot;/compound_digest&quot;,&quot;/gene_digest&quot;,&quot;/pcl&quot;,&quot;/concordance&quot;,&quot;/history&quot;];


        // wrap the content
        this.wrap_content();

        // build the navigation panel
        this.build_navigation();

	// make sure the height of the html and body element is set to 100%
	// so our pull out menu looks like it extends all the way down the
	// page even if the browser window is larger than the content of the
	// page
	$(&quot;html&quot;).css(&quot;height&quot;,&quot;100%&quot;);
	$(&quot;body&quot;).css(&quot;height&quot;,&quot;100%&quot;);

},</code></pre></span>
          <section id="wrap_content">
            <h1>wrap_content</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>wrap_content()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>wrap all existing content in the elements we need to work the slide out navigation that we are going<br />to build</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">wrap_content: function(){
    $(&quot;body&quot;).children().wrapAll('&lt;div class=&quot;cmap-navigation-content&quot;/&gt;');
    $(&quot;.cmap-navigation-content&quot;).wrapAll('&lt;div class=&quot;cmap-navigation-wrapper&quot;/&gt;');
},</code></pre></span>
          <section id="build_navigation">
            <h1>build_navigation</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>build_navigation()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>build the navigation pane using all reuested menu items and links</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">build_navigation: function(){
    var self = this;
    $(&quot;.cmap-navigation-wrapper&quot;).prepend('&lt;div class=&quot;cmap-navigation-menu&quot;&gt;&lt;/div&gt;');
    var $el = $(&quot;.cmap-navigation-menu&quot;);
    this.items.forEach(function(item,i){
			$el.append('&lt;a href=&quot;' + self.links[i] + '&quot; class=&quot;col-xs-12 cmap-navigation-menu-item&quot;&gt;' + item + '&lt;/a&gt;');
		});
		$el.prepend(&quot;&lt;div class='cmap-spacer-large'&gt;&lt;/div&gt;&quot;);
		$el.prepend(&quot;&lt;p id='cmap-navigation-menu-close' title='close' class='cmap-navigation-menu-item cmap-header-link-no-border class=col-xs-12'&gt;X&lt;/p&gt;&quot;);
		$(&quot;.cmap-navigation-menu-item&quot;,$el).on(&quot;click&quot;,function(){
			$(&quot;.cmap-navigation-wrapper&quot;).toggleClass(&quot;show-nav&quot;);
		});
	},</code></pre></span>
          <section id="addLink">
            <h1>addLink</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>addLink()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>adds a new attribute to the element that is comprised of an href with link text, and visible text</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>text</td>
                <td>string</td>
                <td><p>visible text of the element</p></td>
              </tr>
              <tr>
                <td>route</td>
                <td>string</td>
                <td><p>href value of the element</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">addLink: function(text,route) {
	var $el = $(&quot;.cmap-navigation-menu&quot;);
	$el.append('&lt;a href=&quot;' + route + '&quot; class=&quot;col-xs-12 cmap-navigation-menu-item&quot;&gt;' + text + '&lt;/a&gt;');
}
});</code></pre></span>
          <section id="CellSearchBar">
            <h1>CellSearchBar</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>Barista.Views.CellSearchBar</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.View that exposes a custom search bar.  The search bar provides autocomplete<br />functionality for Connectivity Map pert_inames and cell_ids.  When the user types in the<br />search view&#39;s input, a &quot;search:DidType&quot; event is fired.</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.CellSearchBar = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CellSearchBar&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overrides the default Backbone.View initialize method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	var self = this;</code></pre></span>
          <div style="font-family:Roboto Slab" class="description"><p>determines whether or not the search view will match cell lines for autocomplete</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">// determine whether or not we will match cell line strings in the autocomplete
this.match_cell_lines = (this.options.match_cell_lines !== undefined) ? this.options.match_cell_lines : true;

// custom placeholder if specified
this.placeholder = (this.options.placeholder !== undefined) ? this.options.placeholder : &quot;search cell lines&quot;;

// grab cell_ids and store them as an atribute of the view
var cellinfo = Barista.APIURL + '/a2/cellinfo?callback=?';
var params = {q:'{&quot;cell_id&quot;:{&quot;$regex&quot;:&quot;&quot;}}',d:&quot;cell_id&quot;};
$.getJSON(cellinfo,params,function(res){
	self.cell_lines = res;
	self.render();

	// once the view is rendered, bind a change event to trigger a &quot;search:DidType&quot; event from the view</code></pre></span>
          <section id="change_callback">
            <h1>change_callback</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">function</div><span>change_callback()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>once the view is rendered, bind a change event to trigger a &quot;search:DidType&quot; event from<br />the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">var change_callback = function () {
	var val  = $(&quot;#search&quot;,self.el).val();
	var type = &quot;&quot;;
	if (self.cell_lines.indexOf(val) != -1 &amp;&amp; self.match_cell_lines){
		type = &quot;cell&quot;;
	}</code></pre></span>
          <div style="font-family:Roboto Slab" class="description"><p>Fired when the text in the view&#39;s search box changes</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[msg={val:&quot;&quot;,type:&quot;&quot;}]</td>
                <td>Object</td>
                <td><p>an object containing the message of the event</p></td>
              </tr>
              <tr>
                <td>[msg.val=&quot;&quot;]</td>
                <td>String</td>
                <td><p>the string val of the views search bar at the time of                              the event</p></td>
              </tr>
              <tr>
                <td>[msg.type=&quot;&quot;]</td>
                <td>String</td>
                <td><p>the type of message being passed, either &quot;&quot; or &quot;cell&quot;                               &quot;cell&quot;is passed, if the string matches a cell line and<br />                              match_cell_lines is set</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">self.trigger(&quot;search:DidType&quot;,{val: val,search_column: undefined});
			};

			$(&quot;#search&quot;,self.el).bind('input propertychange change', _.throttle(change_callback,500));

			// bind a search:DidType event to the typeahead events coming out of typeahead.js
			$(&quot;.typeahead&quot;,self.el).bind('typeahead:selected typeahead:autocompleted', function (obj,datum) {
var val = datum.value;
var search_column = datum.search_column;
self.trigger(&quot;search:DidType&quot;,{val: val,search_column: search_column});
			});
		});

	},</code></pre></span>
          <section id="get_val">
            <h1>get_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>get_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets the current text entered in the view&#39;s search bar</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">get_val: function(){
	return $(&quot;#search&quot;,this.el).val();
},</code></pre></span>
          <section id="random_val">
            <h1>random_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>random_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fills the view&#39;s search bar with a random pert_iname and triggers a &quot;search:DidType&quot; event</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">random_val: function(){
	var self = this;
	var cellinfo = Barista.APIURL + '/a2/cellinfo?callback=?';

	var skip = Math.round(Math.random()*40);
	var params = {q:'{&quot;lincs_status&quot;:{&quot;$in&quot;:[&quot;core_cline&quot;,&quot;core_pline&quot;,&quot;DIVR&quot;]}}', l:1, sk:skip};
	$.getJSON(cellinfo,params,function(res){
		var val = res[0].cell_id;
		$(&quot;#search&quot;,this.el).val(val);
		self.trigger(&quot;search:DidType&quot;,{val: val,search_column: 'cell_id'});
	});
},</code></pre></span>
          <section id="set_val">
            <h1>set_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>triggers a &quot;search:DidType&quot; event for the given search value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>new_val</td>
                <td></td>
                <td><p>value to search for</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_val: function(new_val){
	$(&quot;#search&quot;,this.el).val(new_val);
	this.trigger(&quot;search:DidType&quot;,{val: new_val,search_column: undefined }); //TODO need to find search column info
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;

	// load the template into the view's el tag
	this.$el.append(BaristaTemplates.CMapPertSearchBar({placeholder: this.placeholder}));

	// hook up the typeahead with backing datasets
	$('#search',this.$el).typeahead([Barista.Datasets.CellID,
									 Barista.Datasets.CellLineage,
									 Barista.Datasets.CellHistology,
									 Barista.Datasets.CellMutation]);
}
});</code></pre></span>
          <section id="CompoundDetailView">
            <h1>CompoundDetailView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.CompoundDetailView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_detail_view = new CompoundDetailView({el: $(&quot;target_selector&quot;),<br />                                                 model: CompoundDetailModel,<br />                                                 bg_color: &quot;#ffffff&quot;,<br />                                                 span_class: &quot;col-lg-12&quot;});</p><p>A Backbone.View that shows information about a small molecule compound<br />This view is frequently paired with a CompoundDetailModel<br />pert_detail_view = new CompoundDetailView({el: $(&quot;target_selector&quot;)});<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                             #ffffff</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                             &quot;col-lg-12&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.CompoundDetailView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CompoundDetailView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.CompoundDetailModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the defualt Backbone.View initialize method to bind the view to model changes, bind window<br />resize events to view re-draws, compile the template, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up the plot height
	this.options.plot_height = 260;

	// set up the open and closed state heights
	this.open_height = this.options.plot_height;
	this.closed_height = this.options.plot_height;
	this.panel_open = false;

	// initialize the view using the base view's built in method
	this.base_initialize();
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// keep track of our scope at this level
	var self = this;

	// render the base view components
	this.base_render();

	// draw compound structure if there is one
	if (this.model.get(&quot;structure_url&quot;)){
		this.fg_layer.selectAll('.index_text_icon').data([]).exit().remove();
		this.fg_layer.selectAll('.index_text_icon').data([1])
							.enter().append(&quot;svg:image&quot;)
							.attr(&quot;class&quot;,&quot;index_text_icon&quot;)
							.attr(&quot;xlink:href&quot;, this.model.get(&quot;structure_url&quot;))
							.attr(&quot;x&quot;,10)
							.attr(&quot;y&quot;,100)
							.attr(&quot;height&quot;,150)
							.attr(&quot;width&quot;,300)
							.style(&quot;cursor&quot;,&quot;pointer&quot;)
							.on(&quot;click&quot;, function(){window.location = self.model.get('structure_url')});
	}

	// draw the static index reagent text
	this.fg_layer.selectAll('.index_text').data([]).exit().remove();
	this.fg_layer.selectAll('.index_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;index_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,30)
						.attr(&quot;fill&quot;,&quot;#E69F00&quot;)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;20pt&quot;)
						.text('Small Molecule Compound');

	// (re)draw the pert_iname text
	this.fg_layer.selectAll('.pert_iname_text').data([]).exit().remove();
	this.fg_layer.selectAll('.pert_iname_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;pert_iname_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,75)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-weight&quot;,&quot;bold&quot;)
						.attr(&quot;font-size&quot;,&quot;36pt&quot;)
						.text(this.model.get('pert_iname'));

	// (re)draw the pert_id text
	this.fg_layer.selectAll('.pert_id_text').data([]).exit().remove();
	this.fg_layer.selectAll('.pert_id_text').data([1])
						.enter()
						.append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;pert_id_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,100)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.text(this.model.get('pert_id'));

	// render additional labels
	this.label_y_position = 100;

	// (re)draw the in_summly annotation
	this.render_label_and_value('collection', 'Collection', 'pert_icollection', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('num_sig', 'Signatures', 'num_sig', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('gold_sig', 'Gold Signatures', 'num_gold', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('num_inst', 'Experiments', 'num_inst', false, 320);

	// (re)draw the in_summly annotation
	this.render_label_and_value('summly', 'In Summly', 'in_summly', false, 320);


	// set the y position to be below the fold
	this.label_y_position = 260;

	// (re)draw the weight label and weight
	this.render_label_and_value('weight', 'Weight', 'molecular_wt');

	// (re)draw the formula and label
	this.render_label_and_value('formula', 'Formula', Barista.NumbersToSubscript(this.model.get('molecular_formula')),true);

	// (re)draw the logp and label
	this.render_label_and_value('logp', 'LogP', 'logp');

	// (re)draw the formula and label
	this.render_label_and_value('vendor', 'Vendor', 'pert_vendor');

	// (re)draw the pubchem_cid and label
	this.render_label_and_value('pubchem_cid', 'PubChem CID', 'pubchem_cid', false, 10, &quot;//pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=&quot; + self.model.get('pubchem_cid'));

	// (re)draw the InChIKey label and InChIKey
	this.render_label_and_value('inchi_key', 'InChIKey', this.model.get(&quot;inchi_key&quot;).split(&quot;InChIKey=&quot;)[1], true);

	// (re)draw the InChI string
	// this.render_label_and_value('inchi_string', 'InChI String', this.model.get(&quot;inchi_string&quot;).split(&quot;InChI=&quot;)[1], true);

	// (re)draw the SMILES
	this.render_label_and_value('smiles', 'SMILES', 'canonical_smiles');

	// draw alternate names
	this.label_y_position += 20;
	if (this.model.get('alt_name')){
		this.render_label_and_value('alt_name_label', 'Alternate Names', '', true);
		this.label_y_position += 5;
		this.draw_tags('alt_name', 'Alternate Names', this.model.get('alt_name'), 'white', '#BDBDBD');
	}

	// draw the cell lines that the compound has been profiled in
	if (this.model.get('cell_id')){
		this.render_label_and_value('cell_id_label', 'Cell Lines', '', true);
		this.label_y_position += 5;
		this.draw_tags('cell_id', 'Cell Lines', this.model.get('cell_id'), 'white', '#CC79A7');
	}

	// draw the signatures for the compound
	if (this.model.get('sig_id')){
		this.render_label_and_value('sig_id_label', 'Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('sig_id', 'Signature IDs', this.model.get('sig_id'), 'white', '#BDBDBD');
	}

	// draw the gold signatures for the compound
	if (this.model.get('sig_id_gold')){
		this.render_label_and_value('gold_sig_id_label', 'Gold Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('gold_sig_id', 'Gold Signature IDs', this.model.get('sig_id_gold'), 'white', '#BDBDBD');
	}

	// (re)draw the pert_summary or clear it if there pert_summary is null
	if (this.model.get('pert_summary')){
		this.render_summary({summary_string: this.model.get('pert_summary'),
							 top: 45,
							 bottom: 100,
							 left: this.fg_layer.selectAll('.pert_iname_text').node().getComputedTextLength() + 30});
	}else{
		this.clear_summary();
	}

	// add a png export overlay
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 20)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});

	// check to see if there is a pubchem id and draw a link for it if there
	// is one
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).data([]).exit().remove();
	if (this.model.get('pubchem_cid')){
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).data([1]).enter().append(&quot;text&quot;)
			.attr(&quot;class&quot;, this.div_string + &quot;pubchem_link no_png_export&quot;)
			.attr(&quot;x&quot;,this.width - 10)
			.attr(&quot;y&quot;,this.height - 20)
			.attr(&quot;opacity&quot;,0.25)
			.attr(&quot;text-anchor&quot;,&quot;end&quot;)
			.style(&quot;cursor&quot;,&quot;pointer&quot;)
			.text(&quot;PubChem&quot;)
			.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
			.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
			.on(&quot;click&quot;, function(){window.location = &quot;//pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=&quot; + self.model.get('pubchem_cid')});
	}

	// check to see if there is a wikipedia url and draw a link for it if there
	// is one
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).data([]).exit().remove();
	if (this.model.get('wiki_url')){
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).data([1]).enter().append(&quot;text&quot;)
			.attr(&quot;class&quot;, this.div_string + &quot;wiki_link no_png_export&quot;)
			.attr(&quot;x&quot;,this.width - 80)
			.attr(&quot;y&quot;,this.height - 20)
			.attr(&quot;opacity&quot;,0.25)
			.attr(&quot;text-anchor&quot;,&quot;end&quot;)
			.style(&quot;cursor&quot;,&quot;pointer&quot;)
			.text(&quot;Wiki&quot;)
			.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
			.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
			.on(&quot;click&quot;, function(){window.location = self.model.get('wiki_url')});
	}

	// render an image that will to indicate that the user can click the content to unfold the panel
	this.cevron_image_link = (this.panel_open) ? '//coreyflynn.github.io/Bellhop/img/up_arrow_select.png' : '//coreyflynn.github.io/Bellhop/img/down_arrow_select.png';

	this.controls_layer.selectAll('.cevron_icon').data([]).exit().remove();
	this.controls_layer.selectAll('.cevron_icon').data([1])
		.enter().append(&quot;svg:image&quot;)
		.attr(&quot;class&quot;,&quot;cevron_icon&quot;)
		.attr(&quot;xlink:href&quot;, this.cevron_image_link)
		.attr(&quot;x&quot;,this.width/2 - 9)
		.attr(&quot;y&quot;,function(){
			if (self.panel_open){
				return self.height - 15;
			}else{
				return self.height - 20;
			}
		})
		.attr(&quot;height&quot;,20)
		.attr(&quot;width&quot;, 18)
		.attr(&quot;transform&quot;, &quot;rotate(0)&quot;)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.on(&quot;click&quot;, function(){self.toggle_panel_state()});

	// render a button to allow the user to expand the view to show its full content
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).data([1]).enter()
		.append(&quot;rect&quot;)
		.attr(&quot;x&quot;,0)
		.attr(&quot;y&quot;,this.height - 15)
		.attr(&quot;class&quot;,this.div_string + &quot;more_button&quot;)
		.attr(&quot;height&quot;,15)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;opacity&quot;,0)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0);})
		.on(&quot;click&quot;, function(){self.toggle_panel_state()})

	return this;
},

/**
 * update the dynamic potions of the view
 */
update: function(){
	this.render();
	return this;
},

/**
* utility function to draw a standard label and value for that label under the main pert_iname and
* pert_id text
* If pass_model_field_as_text is true, pass the value in model_field as text instead of serching for
* it in the model
* @param  {string}  class_name_base           base of the class name of the attribute
* @param  {string}  label_text                visible text that labels the element on screen
* @param  {string}  model_field               text to appear in the model field
* @param  {boolean} pass_model_field_as_text  determines whether the value in model_field will appear
*                                             as text (true) or if the value must be obtained by
*                                             searching (false)
* @param  {number}  x_pos_base                base position for the x_label set
* @param  {[type]}  value_link                iff supplied, used as a link on the visible text
*/
render_label_and_value: function(class_name_base, label_text, model_field, pass_model_field_as_text, x_pos_base, value_link){
	// set up a local variable to keep our scope straight
	var self = this;

	// make sure that we have a label_y_position set
	this.label_y_position = (this.label_y_position !== undefined) ? this.label_y_position: 100;
	this.label_y_position += 25;

	// make sure that there is a base position for the x_label set
	var x_pos_base = (x_pos_base !== undefined) ? x_pos_base: 10;

	// update the open_height to the total height of all that we have drawn
	this.open_height = (this.options.plot_height &gt; this.label_y_position + 40) ? this.options.plot_height : this.label_y_position + 40;

	// (re)draw the label
	this.fg_layer.selectAll('.' + class_name_base + '_label_text').data([]).exit().remove();
	this.fg_layer.selectAll('.' + class_name_base + '_label_text').data([1])
						.enter()
						.append(&quot;text&quot;)
						.attr(&quot;class&quot;,class_name_base + '_label_text')
						.attr(&quot;x&quot;,x_pos_base)
						.attr(&quot;y&quot;,this.label_y_position)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.text(label_text + ':');

	// (re)draw the text
	this.fg_layer.selectAll('.' + class_name_base + '_text').data([]).exit().remove();
	var model_text = '';
	if (pass_model_field_as_text){
		model_text = model_field;
	}else{
		model_text = this.model.get(model_field);
	}
	var x_pos = x_pos_base + this.fg_layer.selectAll('.' + class_name_base + '_label_text').node().getComputedTextLength() + 10;

	// if there is a value link supplied, use it as a link on the text, otherwise, render plain text
	if (value_link){
		this.fg_layer.selectAll('.' + class_name_base + '_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,class_name_base + '_text')
							.attr(&quot;x&quot;,x_pos)
							.attr(&quot;y&quot;,this.label_y_position)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
							.style(&quot;cursor&quot;,&quot;pointer&quot;)
							.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
							.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;fill&quot;,&quot;#BDBDBD&quot;);})
							.on(&quot;click&quot;, function(){window.location = value_link})
							.text(model_text);
	}else{
		this.fg_layer.selectAll('.' + class_name_base + '_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,class_name_base + '_text')
							.attr(&quot;x&quot;,x_pos)
							.attr(&quot;y&quot;,this.label_y_position)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
							.text(model_text);
	}
},

/**
 * utility function to break a long summary string into a multiline and draw it at the desired location
 * @param  {object} options  describes the options for drawing a string to the screen
 * arguments for options:
 * @param {string} summary_string  the string to be displayed, defaults to &quot;&quot;
 * @param {right}  right           the x position to place the right edge of text, defaults to
 *                                 this.width
 * @param {left}   left            the x position to place the left edge of text, defaults to
 *                                 this.width - 500
 * @param {top}    top             the y position to place the **top** edge of text, defaults to 0
 * @param {bottom} bottom          the y position to place the **bottom** edge of text, defaults to
 *                                 100
 */
render_summary: function(options){
	var self = this;

	// default arguments if they are not present
	summary_string = this.model.get(&quot;pert_summary&quot;);
	top_edge = (options.top !== undefined) ? options.top : 0;
	bottom_edge = (options.bottom !== undefined) ? options.bottom : 100;
	right_edge = (options.right !== undefined) ? options.right : this.width;
	left_edge = (options.left !== undefined) ? options.left : this.width - 500;

	// clear existing summary
	this.clear_summary();

	// compute the number of lines we have room for
	this.line_height = 15;
	this.num_lines_allowed = Math.floor((bottom_edge - top_edge) / this.line_height);

	// compute the number of characters per line we will allow and how
	// many lines the summary would need if we rendered all of it
	this.line_width = right_edge - left_edge;
	this.num_char = Math.floor(this.line_width / 13 / .75);
	this.num_char = (this.num_char &gt; 60) ? 60 : this.num_char;
	this.num_lines = Math.ceil(summary_string.length / this.num_char);

	// compute the line splits to display in the wiki summary
	this.lines = [];
	for (var i=0; i&lt;this.num_lines; i++){
		if (i &lt; this.num_lines_allowed - 1){
			var l = (summary_string.slice(i*this.num_char,(i+1)*this.num_char).slice(-1) != &quot; &quot; &amp;&amp; summary_string.slice(i*this.num_char,(i+1)*this.num_char).slice(this.num_char-1,this.num_char) != &quot;&quot;) ? summary_string.slice(i*this.num_char,(i+1)*this.num_char)  + '-': summary_string.slice(i*this.num_char,(i+1)*this.num_char);
			this.lines.push(l);
		}else{
			var l = summary_string.slice(i*this.num_char,(i+1)*this.num_char - 3) + '...';
			this.lines.push(l);
			break;
		}
	}

	// draw lines
	self.fg_layer.selectAll('.' + self.div_string + 'summary_text' + i).data(this.lines)
			.enter()
			.append(&quot;text&quot;)
			.attr(&quot;class&quot;,self.div_string + &quot;summary_text&quot;)
			.attr(&quot;x&quot;,left_edge)
			.attr(&quot;y&quot;,function(d,i){return top_edge + 13 + i*15;})
			.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
			.attr(&quot;font-size&quot;,&quot;13pt&quot;)
			.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
			// .attr(&quot;text-anchor&quot;, &quot;middle&quot;)
			.text(function(d){return d;});
},

/**
 * utility to open or close the view
 */
toggle_panel_state: function(){
	var self = this;
	var h;
	if (this.panel_open){
		h = this.options.plot_height;
		$(&quot;#&quot; + this.div_string).animate({height:h},500);
		this.panel_open = false;
		this.controls_layer.selectAll(&quot;.cevron_icon&quot;).attr(&quot;xlink:href&quot;, '//coreyflynn.github.io/Bellhop/img/down_arrow_select.png')
		this.controls_layer.selectAll('.cevron_icon').transition().duration(500).attr(&quot;y&quot;,h - 20);
	}else{
		h = this.open_height
		$(&quot;#&quot; + this.div_string).animate({height:h},500);
		this.panel_open = true;
		this.controls_layer.selectAll(&quot;.cevron_icon&quot;).attr(&quot;xlink:href&quot;, '//coreyflynn.github.io/Bellhop/img/up_arrow_select.png')
		this.controls_layer.selectAll('.cevron_icon').transition().duration(500).attr(&quot;y&quot;,h - 15);
	}
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).transition().duration(500).attr(&quot;y&quot;,h - 15);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.vis.transition().duration(500).attr(&quot;height&quot;,h);
},

/**
 * utility function to draw tags given an array
 * @param  {string} class_name_base  base of the class name of the attribute
 * @param  {string} label_text       visible text that labels the element on screen
 * @param  {array}  data             array of data
 * @param  {string} fg_color         fill color of label
 * @param  {string} tag_color        color for background layer of tags 
 */
draw_tags: function(class_name_base, label_text, data, fg_color, tag_color){
	var x_offsets = [10];
	var row_number = 0;
	var y_offsets = [];
	var lengths = [];
	var tags = [];
	var self = this;
	var EmSize = Barista.getEmSizeInPixels(this.div_string);

	// draw the foreground text of all the tags
	this.fg_layer.selectAll('.' + class_name_base + 'tag_list_text').data([]).exit().remove();
	this.fg_layer.selectAll('.' + class_name_base + 'tag_list_text').data(data).enter().append('text')
		.attr(&quot;class&quot;, class_name_base + &quot;tag_list_text&quot;)
		.text(function(d){return d;})
		.attr(&quot;x&quot;,function(d,i){
			lengths.push(this.getComputedTextLength() + 15);
			var current_x_offset = x_offsets[i];
			if (current_x_offset + lengths[i] &gt; self.width){
				x_offsets[i] = 5;
				x_offsets.push(lengths[i] + x_offsets[i]);
				row_number += 1;
			}else{
				x_offsets.push(lengths[i] + x_offsets[i]);
			}
			y_offsets.push((row_number * 1.5 + 1));
			return x_offsets[i];
		})
		.attr(&quot;y&quot;,function(d,i){return self.label_y_position + y_offsets[i] * EmSize;})
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,fg_color)

	// draw the background of all the tags
	this.bg_layer.selectAll('.' + class_name_base + 'tag_list_rect').data([]).exit().remove();
	this.bg_layer.selectAll('.' + class_name_base + 'tag_list_rect').data(data).enter().append('rect')
		.attr(&quot;class&quot;, class_name_base + &quot;tag_list_rect&quot;)
		.attr(&quot;x&quot;,function(d,i){return x_offsets[i] - 5;})
		.attr(&quot;y&quot;,function(d,i){return self.label_y_position + (y_offsets[i] - 1) * EmSize;})
		.attr(&quot;rx&quot;,4)
		.attr(&quot;ry&quot;,4)
		.attr('width',function(d,i){return lengths[i] - 4;})
		.attr('height','1.2em')
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,tag_color);

	// update the label_y_position
	this.label_y_position += 10 + y_offsets.slice(-1)[0] * EmSize;

	// update the open_height to the total height of all that we have drawn
	this.open_height = (this.options.plot_height &gt; this.label_y_position + 40) ? this.options.plot_height : this.label_y_position + 40;

	return this
},

/**
 * utility function to clear the pert summary
 */
clear_summary: function(){
	this.fg_layer.selectAll('.summary_text').data([]).exit().remove();
},


/**
 * override the base views save_png_pre method to clear out the image so we can render the png properly
 */
save_png_pre: function(){
	// remove the static index reagent icon
	this.fg_layer.selectAll('.index_text_icon').data([]).exit().remove();

	// scoot the inde text to the left
	this.fg_layer.selectAll('.index_text')
		.attr('x',10)
},

/**
 * override the base views save_png_post method to restore the image after saving
 */
save_png_post: function(){
	// draw the static index reagent icon
	this.fg_layer.selectAll('.index_text_icon').data([]).exit().remove();
	this.fg_layer.selectAll('.index_text_icon').data([1])
						.enter().append(&quot;svg:image&quot;)
						.attr(&quot;class&quot;,&quot;index_text_icon&quot;)
		                .attr(&quot;xlink:href&quot;, &quot;//coreyflynn.github.io/Bellhop/img/CP.png&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,0)
						.attr(&quot;height&quot;,40)
						.attr(&quot;width&quot;,40);

	// scoot the inde text to the right
	this.fg_layer.selectAll('.index_text')
		.attr('x',60)
}
});

/**
 * A Backbone.View that exposes a custom search bar.  The search bar provides autocomplete
 * functionality for Connectivity Map pert\_inames and cell\_ids.  When the user types in the
 * search view's input, a &quot;search:DidType&quot; event is fired.
 * @class PertSearchBar
 * @constructor
 * @extends Backbone.View
*/
Barista.Views.CompoundSearchBar = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;CompoundSearchBar&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overrides the default Backbone.View initialize method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	var self = this;
	this.render();

	// once the view is rendered, bind a change event to trigger a &quot;search:DidType&quot; event from the view
	var change_callback = function () {
		var val  = $(&quot;#search&quot;,self.el).val();
		var type = &quot;&quot;;</code></pre></span>
          <div style="font-family:Roboto Slab" class="description"><p>Fired when the text in the view&#39;s search box changes</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[msg={val:&quot;&quot;,type:&quot;&quot;}]</td>
                <td>Object</td>
                <td><p>an object containing the message of the event</p></td>
              </tr>
              <tr>
                <td>[msg.val=&quot;&quot;]</td>
                <td>String</td>
                <td><p>the string val of the views search bar at the time of the event</p></td>
              </tr>
              <tr>
                <td>[msg.type=&quot;&quot;]</td>
                <td>String</td>
                <td><p>the type of message being passed, either &quot;&quot; or &quot;cell&quot;. &quot;cell&quot; is passed, if the string matches a cell line and match_cell_lines is set</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">self.trigger(&quot;search:DidType&quot;,{val: val,type: type});
		};

		$(&quot;#search&quot;,self.el).bind('input propertychange change', _.throttle(change_callback,500));

		// bind a search:DidType event to the typeahead events coming out of typeahead.js
		$(&quot;.typeahead&quot;,self.el).bind('typeahead:selected typeahead:autocompleted', function (obj,datum) {
var val = datum.value;
var type = &quot;single&quot;;
self.trigger(&quot;search:DidType&quot;,{val: val,type: type});
		});

	},</code></pre></span>
          <section id="get_val">
            <h1>get_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>get_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets the current text entered in the view&#39;s search bar</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">get_val: function(){
	return $(&quot;#search&quot;,this.el).val();
},</code></pre></span>
          <section id="random_val">
            <h1>random_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>random_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fills the view&#39;s search bar with a random pert_iname and triggers a &quot;search:DidType&quot; event</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">random_val: function(){
	var self = this;
	skip = Math.round(Math.random()*40000);
	var pertinfo = Barista.APIURL + '/a2/pertinfo?callback=?';
	params = {q: '{&quot;pert_type&quot;:&quot;trt_cp&quot;}',
				f:'{&quot;pert_iname&quot;:1}',
									l:1,
									sk:skip};
	$.getJSON(pertinfo,params,function(res){
		var val = res[0].pert_iname;
		$(&quot;#search&quot;,this.el).val(val);
		self.trigger(&quot;search:DidType&quot;,{val: val,type: 'single'});
	});
},</code></pre></span>
          <section id="set_val">
            <h1>set_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>triggers a &quot;search:DidType&quot; event for the given search value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>new_val</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_val: function(new_val){
	$(&quot;#search&quot;,this.el).val(new_val);
	this.trigger(&quot;search:DidType&quot;,{val: new_val,type: 'single'});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;
	// load the template into the view's el tag
	this.$el.append(BaristaTemplates.CMapPertSearchBar());

	$('#search',this.$el).typeahead([{
		// only return 4 items at a time in the autocomplete dropdown
		limit: 2,

		// provide a name for the default typeahead data source
		name: 'Reagents',

		// the template to render for all results
		template: '&lt;span class=&quot;label&quot; style=&quot;background-color: {{ color }}&quot;&gt;{{ type }}&lt;/span&gt; {{ value }}',

		// use twitter's hogan.js to compile the template for the typeahead results
		engine: Hogan,

		remote: {
			// set the remote data source to use pertinfo with custom query params
			url: [Barista.APIURL + '/a2/pertinfo?',
				  'q={&quot;pert_iname&quot;:{&quot;$regex&quot;:&quot;%QUERY&quot;, &quot;$options&quot;:&quot;i&quot;}, &quot;pert_type&quot;:&quot;trt_cp&quot;}',
				  '&amp;f={&quot;pert_iname&quot;:1,&quot;pert_type&quot;:1}',
				  '&amp;l=100',
				  '&amp;s={&quot;pert_iname&quot;:1}'].join(''),
			
			dataType: 'jsonp',</code></pre></span>
          <section id="filter">
            <h1>filter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>filter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the processed list of data for the autocomplete</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>response</td>
                <td>array</td>
                <td><p>array of data to extract cell id from</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">filter: function(response){
	var datum_list = [];
	var auto_data = [];
	var object_map = {};

	// for each item, pull out its pert_iname and use that for the
	// autocomplete value. Build a datum of other relevant data
	// for use in suggestion displays
	response.forEach(function(element){
		auto_data.push(element.pert_iname);
		object_map[element.pert_iname] = element;
	});

	// make sure we only show unique items
	auto_data = _.uniq(auto_data);

	// build a list of datum objects
	auto_data.forEach(function(item){
		var datum = {
			value: item,
			tokens: [item],
			data: object_map[item]
		};
		if (object_map[item].pert_type === 'trt_cp' ){
			_.extend(datum,{
				type: 'Chemical Reagent',
				color: '#E69F00',
			});
			datum_list.push(datum);
			return datum_list;
		}else{
			_.extend(datum,{
				type: object_map[item].pert_type,
				color: '#999',
			});
			datum_list.push(datum);
			return datum_list;
		}
	});

	// return the processed list of daums for the autocomplete
	return datum_list;
}

			}
		}]);
	}
});
Barista.Views.FlatTreeMapView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;FlatTreeMapView&quot;,

	model: new Barista.Models.PertCellBreakdownModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overrides the default Backbone.View initialize method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
// set up color options.  default if not specified
this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#d9d9d9&quot;;
this.well_color = (this.options.well_color !== undefined) ? this.options.well_color : &quot;#bdbdbd&quot;;
this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : &quot;#1b9e77&quot;;

// set up the span size
this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;span4&quot;;

// set up the default height for the plot
this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 300;

// allow for the drawing of arbitrary html in treemap cells rather than counts
this.category_html = (this.options.category_html !== undefined) ? this.options.category_html : null;

// allow for construction inside of a shadow DOM
this.shadow_el = (this.options.shadow_el !== undefined) ? this.options.shadow_el : null;
this.shadow_root = (this.options.shadow_root !== undefined) ? this.options.shadow_root : null;

// bind render to model changes
this.listenTo(this.model,'change', this.update_vis);

// compile the default template for the view
this.compile_template();

// set up a $div selector that can find the target div even if it is in a
// shadow DOM
if (this.shadow_el &amp;&amp; this.shadow_root){
	this.$div = $(this.shadow_root).children(this.shadow_el).children(&quot;#&quot; + this.div_string);
}else{
	this.$div = $(&quot;#&quot; + this.div_string);
}

// define the location where d3 will build its plot
this.width = this.$div.width();
this.height = this.$div.outerHeight();
this.top_svg = d3.select(this.$div[0]).append(&quot;svg&quot;)
				.attr(&quot;width&quot;,this.width)
				.attr(&quot;height&quot;,this.height)
this.vis = this.top_svg.append(&quot;g&quot;);
// this.vis_overlay = this.top_svg.append(&quot;g&quot;);

// render the vis
this.render();

// bind window resize events to redraw
var self = this;
$(window).resize(function() {self.render();} );
	},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	this.div_string = 'd3_target' + new Date().getTime();
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = this.$div.width();
	this.height = this.$div.outerHeight();

	// rescale the width of the vis
	this.top_svg.transition().duration(1).attr(&quot;width&quot;,this.width);

	// define the treemap layout
	this.treemap = d3.layout.treemap()
					.size([this.width,this.height])
					.sticky(false)
					.round(true)
					.sort(function(a,b) { return a.count - b.count; })
					.value(function(d) {return d.count;});

	// grab the data from the model and plot the state of the treemap
	this.data = this.model.get('tree_object');

	// if there are no children in the tree_object, dim the view
	if (_.isEmpty(this.data.children)){
		this.top_svg.transition().duration(1).attr(&quot;opacity&quot;,0);
	}else{
		this.top_svg.transition().duration(500).attr(&quot;opacity&quot;,1);
	}

	// set up an alpha scaling
	this.min_count = _.min(_.pluck(this.data.children,'count'));
	this.max_count = _.max(_.pluck(this.data.children,'count'));
	this.opacity_map = d3.scale.linear()
						.domain([this.min_count,this.max_count,this.max_count+1])
						.range([1,1,0]);

	this.vis.data([this.data]).selectAll(&quot;rect&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;rect&quot;).data(this.treemap.nodes)
		.enter().append(&quot;rect&quot;)
		.attr(&quot;class&quot;,this.div_string + &quot;_cell&quot;)
		.attr(&quot;fill&quot;,this.fg_color)
		.attr(&quot;opacity&quot;,function(d){return self.opacity_map(d.value);})
		.attr(&quot;x&quot;, function(d) {return d.x;})
		.attr(&quot;y&quot;, function(d) {return d.y;})
		.attr(&quot;_id&quot;, function(d) {return d._id;})
		.attr(&quot;count&quot;, function(d) {return d.count;})
		.attr(&quot;width&quot;, function(d) {return d.dx;})
		.attr(&quot;height&quot;, function(d) {return d.dy;})
		.attr(&quot;stroke&quot;, &quot;white&quot;)
		.attr(&quot;stroke-width&quot;, 2);

	if (this.category_html){
		self.draw_foreignObject();
	}else{
		self.draw_text();
		self.add_tooltips();
	}

	// add a png export overlay
	this.top_svg.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.top_svg.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25);})
		.on(&quot;click&quot;,function(){self.savePng();});
},</code></pre></span>
          <section id="update_vis">
            <h1>update_vis</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update_vis()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>updates the visibility of the element</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update_vis: function(){
	var self = this;
	// grab the data from the model and plot the state of the treemap
	this.data = this.model.get('tree_object');

	// if there are no children in the tree_object, dim the view
	if (_.isEmpty(this.data.children)){
		this.top_svg.transition().duration(1).attr(&quot;opacity&quot;,0);
	}else{
		this.top_svg.transition().duration(500).attr(&quot;opacity&quot;,1);
	}

	// set up an alpha scaling
	this.min_count = _.min(_.pluck(this.data.children,'count'));
	this.max_count = _.max(_.pluck(this.data.children,'count'));
	this.opacity_map = d3.scale.linear().domain([this.min_count,this.max_count,this.max_count+1])
					.range([1,1,0]);

	//add new data if it is there
	this.vis.data([this.data]).selectAll(&quot;rect&quot;).data(this.treemap.nodes)
		.enter().append(&quot;rect&quot;)
		.attr(&quot;class&quot;,this.div_string + &quot;_cell&quot;)
		.attr(&quot;fill&quot;,this.fg_color)
		.attr(&quot;opacity&quot;,function(d){return self.opacity_map(d.value);})
		.attr(&quot;x&quot;, function(d) {return d.x;})
		.attr(&quot;y&quot;, function(d) {return d.y;})
		.attr(&quot;_id&quot;, function(d) {return d._id;})
		.attr(&quot;count&quot;, function(d) {return d.count;})
		.attr(&quot;width&quot;, function(d) {return d.dx;})
		.attr(&quot;height&quot;, function(d) {return d.dy;})
		.attr(&quot;stroke&quot;, &quot;white&quot;)
		.attr(&quot;stroke-width&quot;, 2);

	// transition elements
	this.vis.data([this.data]).selectAll(&quot;rect&quot;)
		.transition().ease(&quot;cubic out&quot;).duration(500)
		.attr(&quot;opacity&quot;,function(d){return self.opacity_map(d.value);})
		.attr(&quot;x&quot;, function(d) {return d.x;})
		.attr(&quot;y&quot;, function(d) {return d.y;})
		.attr(&quot;_id&quot;, function(d) {return d._id;})
		.attr(&quot;count&quot;, function(d) {return d.count;})
		.attr(&quot;width&quot;, function(d) {return d.dx;})
		.attr(&quot;height&quot;, function(d) {return d.dy;});

	// exit old elements
	this.vis.data([this.data]).selectAll(&quot;rect&quot;).data(this.treemap.nodes).exit().remove();

	// // add tooltips
	// this.add_tooltips();

	// draw_text on the elements that have room for it
	this.clear_text();
	if (this.category_html){
		setTimeout(function(){self.draw_foreignObject();},500);
	}else{
		setTimeout(function(){self.draw_text(); self.add_tooltips();},500);
	}

},</code></pre></span>
          <section id="add_tooltips">
            <h1>add_tooltips</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>add_tooltips()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>inserts tooltips that display the cell id and count for non-empty datasets</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">add_tooltips: function(){
	// make a selection of all cells in the treemap
	var cell_selection = $('.' + this.div_string + '_cell');

	// remove existing tooltips so we don't confuse the labels
	cell_selection.each(function(){
		$(this).tooltip('destroy');
	});

	// add new tooltips if there is more than just the base cell in
	// in the treemap (i.e. it is a non-empty dataset)
	if (cell_selection.length &gt; 1){
		cell_selection.each(function(){
			$(this).tooltip({
				placement: 'top',
				container: 'body',
				trigger: 'hover focus',
				title: $(this).attr('_id') + ' : ' + Math.round($(this).attr('count'))
			});
		});
	}
},</code></pre></span>
          <section id="clear_text">
            <h1>clear_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>clear_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>clear visible text in fields</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">clear_text: function(){
	this.vis.data([this.data]).selectAll(&quot;text.name&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;text.count&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;.foreign&quot;).data([]).exit().remove();
},</code></pre></span>
          <section id="draw_foreignObject">
            <h1>draw_foreignObject</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>draw_foreignObject()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>add a foreignObject DOM snippet for each cell in the treemap based on an input mapping of DOM<br />snippets</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">draw_foreignObject: function(){
	var self = this;
	this.vis.data([this.data]).selectAll(&quot;.foreign&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;.foreign&quot;).data(this.treemap.nodes)
		.enter().append(&quot;foreignObject&quot;)
		.attr(&quot;class&quot;,&quot;foreign&quot;)
		.attr(&quot;x&quot;,function(d){return d.x;})
		.attr(&quot;y&quot;,function(d){return d.y;})
		.attr(&quot;height&quot;,function(d){return d.dy;})
		.attr(&quot;width&quot;,function(d){return d.dx;})
		.attr(&quot;opacity&quot;,function(d) {
			if (d.dy &lt; 50 || d.dx &lt; 50){
				return 0;
			}else{
				return 1;
			}
		})
		.append(&quot;xhtml:body&quot;)
		.style(&quot;background-color&quot;,&quot;rgba(0,0,0,0)&quot;)
		.style(&quot;height&quot;,&quot;100%&quot;)
		.style(&quot;width&quot;,&quot;100%&quot;)
		.style(&quot;display&quot;,&quot;flex&quot;)
		.style(&quot;display&quot;, &quot;-webkit-box&quot;)
  			.style(&quot;display&quot;, &quot;-webkit-flex&quot;)
		.style(&quot;display&quot;, &quot;-ms-flexbox&quot;)
		.html(function(d){
			if (d.children === undefined){
				return self.category_html[d._id];
			}else{
				return &quot;&quot;;
			}
		})
},</code></pre></span>
          <section id="draw_text">
            <h1>draw_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>draw_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws text to the screen based on treemap data</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">draw_text: function(){
	this.vis.data([this.data]).selectAll(&quot;text.name&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;text.name&quot;).data(this.treemap.nodes)
		.enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;,&quot;name&quot;)
		.text(function(d) {
			if (d.dy &lt; 20 || d.dx &lt; 80){
				return null;
			}else{
				return d.children ? null : d._id;
			}
		})
		.attr(&quot;text-anchor&quot;, &quot;middle&quot;)
		.attr(&quot;x&quot;, function(d) {return d.x + d.dx/2;})
		.attr(&quot;y&quot;, function(d) {return d.y + d.dy/2;})
		.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
		.attr(&quot;font-weight&quot;,&quot;normal&quot;)
		.attr(&quot;font-size&quot;,&quot;12pt&quot;)
		.attr(&quot;fill&quot;,&quot;white&quot;)
		.attr(&quot;opacity&quot;,0)
		.style(&quot;pointer-events&quot;,&quot;none&quot;)
		.transition().duration(500).attr(&quot;opacity&quot;,1);

	this.vis.data([this.data]).selectAll(&quot;text.count&quot;).data([]).exit().remove();
	this.vis.data([this.data]).selectAll(&quot;text.count&quot;).data(this.treemap.nodes)
		.enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;,&quot;name&quot;)
		.text(function(d) {
			if (d.dy &lt; 40 || d.dx &lt; 80){
				return null;
			}else{
				return d.children ? null : Barista.numberWithCommas(d.count);
			}
		})
		.attr(&quot;text-anchor&quot;, &quot;middle&quot;)
		.attr(&quot;x&quot;, function(d) {return d.x + d.dx/2;})
		.attr(&quot;y&quot;, function(d) {return d.y + d.dy/2 + 20;})
		.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
		.attr(&quot;font-weight&quot;,&quot;normal&quot;)
		.attr(&quot;font-size&quot;,&quot;12pt&quot;)
		.attr(&quot;fill&quot;,&quot;black&quot;)
		.attr(&quot;opacity&quot;,0)
		.style(&quot;pointer-events&quot;,&quot;none&quot;)
		.transition().duration(500).attr(&quot;opacity&quot;,1);
},</code></pre></span>
          <section id="savePng">
            <h1>savePng</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>savePng()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>saves the target svg on the screen to a png file</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">savePng: function(){
	//set the animate the div containing the view by applying and then removing
	// css classes that defined the transitions we want
	var $div = this.$div;
	$div.addClass(&quot;barista-base-view&quot;);
	$div.toggleClass(&quot;exporting&quot;);
	setTimeout(function(){$div.toggleClass(&quot;exporting&quot;);},500);

	// build a canvas element to store the image temporarily while we save it
	var width = this.top_svg.attr(&quot;width&quot;);
	var height = this.top_svg.attr(&quot;height&quot;);
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.top_svg.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.top_svg.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;cmapTreeMap&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){canvas.toBlob(function(blob){saveAs(blob,filename);})};
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}
});</code></pre></span>
          <section id="GenericCountView">
            <h1>GenericCountView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>a view that supports a single label and a single count *</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.GenericCountView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when<br />it needs to know what its class name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;GenericCountView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.PertCountModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle<br />optional arguments, compile the view template, bind model changes<br />to view updates and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
  // set up label, default if not specified
  this.label = (this.options.label !== undefined) ? this.options.label : 'Signatures';

  // set the animation duration for count.
  this.duration = (this.options.duration != undefined) ? this.options.duration : 500;

  // set up the top bar color, default to gray if not specified
  this.top_bar_color = (this.options.top_bar_color !== undefined) ? this.options.top_bar_color : 'white';

  // call the the base view initialize function
  this.base_initialize();

  // bind window resize events to redraw.
  var self = this;
  $(window).resize(function() {self.update();} );

  return this;
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely re-render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function() {
  this.base_render()
    .renderTopBar()
    .renderLabel()
    .renderCount();

  return this;
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update only the dynamic portions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function() {
  this.updateCount();
},</code></pre></span>
          <section id="renderTopBar">
            <h1>renderTopBar</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>renderTopBar()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draw the top bar of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">renderTopBar: function() {
  this.fg_layer.selectAll('.genericCountViewTopBar').data([]).exit().remove();
  this.fg_layer.selectAll('.genericCountViewTopBar').data([1])
  .enter().append(&quot;rect&quot;)
  .attr(&quot;class&quot;,&quot;genericCountViewTopBar&quot;)
  .attr(&quot;height&quot;,'2px')
  .attr(&quot;width&quot;,this.width)
  .attr(&quot;fill&quot;,this.top_bar_color);

  return this;
},</code></pre></span>
          <section id="renderLabel">
            <h1>renderLabel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>renderLabel()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draw the static label at the top of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">renderLabel: function() {
  this.fg_layer.selectAll('.genericCountViewLabel').data([]).exit().remove();
  this.fg_layer.selectAll('.genericCountViewLabel').data([1])
    .enter().append(&quot;text&quot;)
    .attr(&quot;class&quot;,&quot;genericCountViewLabel&quot;)
    .attr(&quot;y&quot;,25)
    .attr(&quot;font-family&quot;,&quot;'Open Sans&quot;)
    .attr(&quot;font-weight&quot;,&quot;300&quot;)
    .attr(&quot;font-size&quot;,&quot;16px&quot;)
    .attr(&quot;fill&quot;,'#444444')
    .text(this.label);

  return this;
},

/**
 * draw the count from scratch
 * @return {Barista.Views.GenericCountView} a reference to this
 */
renderCount: function() {
  // get the count from the model. If it is undefined, assume it is 0
  var count = this.model.get('count');
  if (typeof(count) !== 'number'){
    count = 0;
  }

  // draw the count
  this.fg_layer.selectAll('.genericCountViewCount').data([]).exit().remove();
  this.fg_layer.selectAll('.genericCountViewCount').data([1])
    .enter().append(&quot;text&quot;)
    .attr(&quot;class&quot;,&quot;genericCountViewCount&quot;)
    .attr(&quot;y&quot;,60)
    .attr(&quot;font-family&quot;,&quot;'Open Sans&quot;)
    .attr(&quot;font-weight&quot;,&quot;500&quot;)
    .attr(&quot;font-size&quot;,&quot;37px&quot;)
    .attr(&quot;fill&quot;,this.fg_color)
    .text(Barista.numberWithCommas(count));

  return this;
},</code></pre></span>
          <section id="updateCount">
            <h1>updateCount</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>updateCount()</span> -><span>Barista.Views.GenericCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the count from the model. If if is undefined, assume it is 0</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">updateCount: function() {
  // get the count from the model. If it is undefined, assume it is 0
  var count = this.model.get('count');
  if (typeof(count) !== 'number'){
    count = 0;
  }


  // transition the count to the new value
  this.fg_layer.selectAll('.genericCountViewCount').data([1])
    .transition().duration(this.duration)
    .tween(&quot;text&quot;, function() {
        var i = d3.interpolate(this.textContent.replace(&quot;,&quot;,&quot;&quot;), count);
        return function(t) {
          this.textContent = Barista.numberWithCommas(Math.round(i(t)));
        };
    });

  return this;
}

});

Barista.Views.GridView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;GridView&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overrides the default Backbone.View initialize method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	var self = this;
	// default search value
	this.search_val = &quot;&quot;;
	this.search_type = &quot;single&quot;;

	// set up grid options
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;col_lg_12&quot;;
	this.legend = (this.options.legend !== undefined) ? this.options.legend :null;
	this.no_download = (this.options.no_download !== undefined) ? this.options.no_download :null;
	this.no_slice = (this.options.no_slice !== undefined) ? this.options.no_slice :null;
	this.no_legend = (this.options.no_legend !== undefined) ? this.options.no_legend :null;
	this.edit = (this.options.edit !== undefined) ? this.options.edit : false;
	this.limit = (this.options.limit !== undefined) ? this.options.limit : 30;



	// set up a default collection and column definition for the grid to operate on
	this.collection = (this.options.collection !== undefined) ? this.options.collection : new Barista.Collections.PertCollection();
	this.columns = (this.options.columns !== undefined) ? this.options.columns : [{name: &quot;pert_iname&quot;, label: &quot;Reagent Name&quot;, cell: &quot;string&quot;, editable: false},
																					{name: &quot;pert_type_label&quot;, label: &quot;Pert Type&quot;, cell: Barista.HTMLCell, editable: false},
																					{name: &quot;num_inst&quot;, label: &quot;Experiments&quot;, cell: &quot;integer&quot;, editable: false}];

	// build the template
	this.compile_template();

	// build the grid on the template using a clickable row.  If a row is clicked, a grid:RowClick event
	// is fired with the row's model as the passed data.
	// build the clickable row
	var ClickableRow = Backgrid.Row.extend({
		events: {
			&quot;click&quot;: &quot;onClick&quot;
		},</code></pre></span>
          <section id="onClick">
            <h1>onClick</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>onClick()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>build the grid on the template using a clickable row<br /> If a row is clicked, a grid:RowClick event is fired with the row&#39;s model as the passed data</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">onClick: function () {
	self.trigger(&quot;grid:RowClick&quot;, this.model);
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide Backgrid.Row&#39;s native render method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function () {
	this.$el.empty();
	var fragment = document.createDocumentFragment();
	for (var i = 0; i &lt; this.cells.length; i++) {
		fragment.appendChild(this.cells[i].render().el);
	}
	this.el.appendChild(fragment);
	this.delegateEvents();

	this.$el.css(&quot;opacity&quot;,0);
	this.$el.animate({&quot;opacity&quot;:1},1000);

	return this;
},</code></pre></span>
          <section id="remove">
            <h1>remove</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>remove()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide Backgrid.Row&#39;s native remove method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">remove: function () {
	this.$el.addClass(&quot;cmap-active-grid-row&quot;);
	this.$el.animate({&quot;opacity&quot;:0},1000);
	var self = this;
	setTimeout(function(){
		for (var i = 0; i &lt; self.cells.length; i++) {
			var cell = self.cells[i];
			cell.remove.apply(cell, arguments);
		}
		return Backbone.View.prototype.remove.apply(self, arguments);
	},1000);
}
		});

		// build the grid
		this.grid = new Backgrid.Grid({
row: ClickableRow,
columns: this.columns,
collection: this.collection
		});
		$(&quot;#&quot; + this.div_string).append(this.grid.render().$el);

		// add a button to scroll to the top of the grid once it is scroll down
		this.add_scroll_to_top_button();

		//bind the table to a function to check for scroll boundaries
		$(&quot;#&quot; + this.div_string,this.el).scroll(function(){self.checkscroll();});

		// bind the download text to a function to download the data in the table
		$(&quot;#&quot; + this.div_string + &quot;_download&quot;,this.el).click(function(){self.download_table();});

		// bind the edit text to a function to edit the data in the table
		$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).click(function(){self.open_edit_table();});

		// bind the download text to a function to slice the data in the table out of the
		// Connectivity Map database.
		self.change_slice_button_state(&quot;slice&quot;);
	},

	checkscroll: _.debounce(function(){
		if ($(&quot;#&quot; + this.div_string).scrollTop() &gt; 30) {
this.show_scroll_to_top_button();
		}else{
this.hide_scroll_to_top_button();
		}

		var triggerPoint = 100;
		var pos = $(&quot;#&quot; + this.div_string).scrollTop() + $(&quot;#&quot; + this.div_string).height() + triggerPoint;
		if (!this.collection.isLoading &amp;&amp; pos &gt; $(&quot;#&quot; + this.div_string)[0].scrollHeight){
this.collection.skip += this.limit;
this.update_collection(this.search_val,this.search_type,this.limit);
		}
	},100),</code></pre></span>
          <section id="add_scroll_to_top_button">
            <h1>add_scroll_to_top_button</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>add_scroll_to_top_button()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>adds a UI control to scroll the top of the grid</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">add_scroll_to_top_button: function(){
	var self = this;
	this.scroll_to_top_button_id = this.div_string + 'scroll_button';
	this.$el.append('&lt;button id=&quot;' + this.scroll_to_top_button_id + '&quot; class=&quot;cmap_grid_to_top_button&quot;&gt;Scroll to Top&lt;/button&gt;');
	$(&quot;#&quot; + this.scroll_to_top_button_id).click(function(){self.scroll_to_top();});
	this.hide_scroll_to_top_button();
},</code></pre></span>
          <section id="scroll_to_top">
            <h1>scroll_to_top</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>scroll_to_top()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>scrolls the grid to the top of its container</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the duration of the scroll animation in ms, defaults to 500</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">scroll_to_top: function(duration){
	duration = (duration !== undefined) ? duration : 500;
	$(&quot;#&quot; + this.div_string).animate({scrollTop:0},duration);
	this.hide_scroll_to_top_button();
},</code></pre></span>
          <section id="show_scroll_to_top_button">
            <h1>show_scroll_to_top_button</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>show_scroll_to_top_button()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>scrolls the grid to the bottom of its container</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the duration of the scroll animation in ms, defaults to 500</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">show_scroll_to_top_button: function(duration){
	duration = (duration !== undefined) ? duration : 500;
	$(&quot;#&quot; + this.scroll_to_top_button_id).clearQueue();
	$(&quot;#&quot; + this.scroll_to_top_button_id).animate({opacity:1},duration);
},</code></pre></span>
          <section id="hide_scroll_to_top_button">
            <h1>hide_scroll_to_top_button</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>hide_scroll_to_top_button()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hides the scroll to top button</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the duration of the scroll animation in ms, defaults to 500</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">hide_scroll_to_top_button: function(duration){
	var self= this;
	duration = (duration !== undefined) ? duration : 500;
	$(&quot;#&quot; + this.scroll_to_top_button_id).clearQueue();
	$(&quot;#&quot; + this.scroll_to_top_button_id).animate({opacity:0},duration);
},</code></pre></span>
          <section id="replace_collection">
            <h1>replace_collection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>replace_collection()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>changes the visible collection data and rejects the slice</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_val</td>
                <td>string</td>
                <td><p>the value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed by getData</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">replace_collection: function(search_val,search_type,limit){
	var getData_promise;
	var self = this;
	this.search_val = (search_val !== undefined) ? search_val : this.search_val;
	this.search_type = (search_type !== undefined) ? search_type : this.search_type;
	this.limit = (limit !== undefined) ? limit : this.limit;
	$(&quot;#&quot; + this.div_string).show();
	$(&quot;#&quot; + this.div_string).animate({opacity:1},500);
	this.collection.reset();
	this.collection.skip = 0;
	self.collection.maxCount = Infinity;
	getData_promise =  this.collection.getData(this.search_val,this.search_type,this.limit);
	this.listenToOnce(this.collection,&quot;add&quot;, function(){
		this.trigger(&quot;grid:ReplaceCollection&quot;);
		this.trigger(&quot;grid:Add&quot;);
		this.resize_div();
		// reset the slice all data button and reject the slice
		// deferred if it is present
		self.change_slice_button_state(&quot;slice&quot;);
		if (self.slice_defer){
			self.slice_defer.reject();
		}
	});
	return getData_promise;
},</code></pre></span>
          <section id="update_collection">
            <h1>update_collection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update_collection()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>changes the visible collection data</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>search_val</td>
                <td>string</td>
                <td><p>the value to search for</p></td>
              </tr>
              <tr>
                <td>search_type</td>
                <td>string</td>
                <td><p>the type of search that will be performed by getData</p></td>
              </tr>
              <tr>
                <td>limit</td>
                <td>number</td>
                <td><p>the number of models to be fetched</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update_collection: function(search_val,search_type,limit){
	var getData_promise;
	if (this.collection.models.length &lt; this.collection.maxCount){
		var self = this;
		this.search_val = (search_val !== undefined) ? search_val : this.search_val;
		this.search_type = (search_type !== undefined) ? search_type : this.search_type;
		this.limit = (limit !== undefined) ? limit : this.limit;
		$(&quot;#&quot; + this.div_string).show();
		$(&quot;#&quot; + this.div_string).animate({opacity:1},500);
		getData_promise = this.collection.getData(this.search_val,this.search_type,this.limit);
		this.resize_div();
		this.listenToOnce(this.collection,&quot;add&quot;, function(){
			this.trigger(&quot;grid:UpdateCollection&quot;);
			this.trigger(&quot;grid:Add&quot;);
		});
		return getData_promise;
	}
},</code></pre></span>
          <section id="clear_collection">
            <h1>clear_collection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>clear_collection()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hides the visible data and rejects the slice</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">clear_collection: function(){
	var self = this;
	this.collection.skip = 0;
	$(&quot;#&quot; + this.div_string).animate({opacity:0},500);
	window.setTimeout(function(){
		self.collection.reset();
		self.collection.maxCount = Infinity;
		$(&quot;#&quot; + this.div_string).hide();

		// reset the slice all data button and reject the slice
		// deferred if it is present
		self.change_slice_button_state(&quot;slice&quot;);
		if (self.slice_defer){
			self.slice_defer.reject();
		}

	},500);
},</code></pre></span>
          <section id="resize_div">
            <h1>resize_div</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>resize_div()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>changes the height of the grid based on the number of elements it holds</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">resize_div: function(){
	var self = this;
	var container_height =  $(&quot;#&quot; + this.div_string).height();
	setTimeout(function(){
		var data_height = self.collection.length * 30 + 40;
		var target_height = (data_height &gt; 300) ? 300 : data_height;

		$(&quot;#&quot; + self.div_string).stop();
		$(&quot;#&quot; + self.div_string).animate({height:target_height},500);
	},500);
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	this.div_string = 'backgrid_target' + new Date().getTime();;
	this.$el.append(BaristaTemplates.CMapBaseGrid({div_string: this.div_string,
												   span_class: this.span_class,
												   legend: this.legend,
												   no_download: this.no_download,
												   no_slice: this.no_slice,
												   no_legend: this.no_legend,
												   edit: this.edit,
												}));
},</code></pre></span>
          <section id="slice_all_table_data">
            <h1>slice_all_table_data</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>slice_all_table_data()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>attempts to return data from a slice, and returns the slice button to its previous state if a failure<br />is detected</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">slice_all_table_data: function(){
	var self = this;
	// change the button state to progress
	this.change_slice_button_state(&quot;progress&quot;);

	// create a Deferred on the object to handle interaction with the slicing
	// operation.  This allows us to resolve the Deffered later in another
	// method before the ajax call returns if we need to
	this.slice_defer = $.Deferred();

	// If the Deferred resolves successfully, leave the button alone and let other the ajax call
	// below manipulate it.  If it is rejected, set the button back up to its original state.
	this.slice_defer.fail(function() {
			self.change_slice_button_state(&quot;slice&quot;);
		}
	);

	// grab the API 'q' query parameter from the grid's collection and send it
	// to sig_slice API.  if the slice job completes, check the return for a
	// file_url attribute and change the link in the slice button to expose the
	// link.  If it does not exist, the slice failed and we display a failure
	// message asking the user to try again
	sig_slice = '//prefix:8080/a2/sigslice?callback=?';
	$.ajax({
		dataType: 'json',
		url: sig_slice,
		data: {q: self.collection.q_param,l: 1000},
		
		success: function(res){
			if (res.file_url){
				self.change_slice_button_state(&quot;link&quot;,res.file_url);
			}else{
				self.change_slice_button_state(&quot;fail&quot;);
			}
		},

		error: function(){
			self.change_slice_button_state(&quot;fail&quot;);
		}
	});

	// if 60s pass, we assume that is too long and we
	// update the button with an error message and
	// resolve the deferred to indicate we finished the
	// ajax call normally.  This is a hack to emulate a 404 error in jsonp
	this.slice_timeout = setTimeout(function(){
		self.change_slice_button_state(&quot;fail&quot;);
	},60000);
},
/**
 * changes the state of the slice button based on the current state
 * @param  {string} state  current state of the slice button (i.e. slice, progress, or link)
 * @param  {string} link   link to the slice
 */
change_slice_button_state: function (state,link){
	var self = this;
	// unbind any handlers on the button
	$(&quot;#&quot; + self.div_string + &quot;_slice&quot;,self.el).unbind();

	// handle the re-binding of handlers and update the button text and icon
	switch (state){
		case &quot;slice&quot;:
			// update the slice button to show an available data slice
			$(&quot;#&quot; + self.div_string + &quot;_slice&quot;,self.el).html('&lt;font color=&quot;#0072B2&quot;&gt;&lt;i class=&quot;icon-cogs&quot;&gt;&lt;/i&gt; slice all data&lt;/font&gt;');

			// rebind the click event and clear a timeout if present
			$(&quot;#&quot; + this.div_string + &quot;_slice&quot;,this.el).click(function(){self.slice_all_table_data();});
			clearTimeout(self.slice_timeout);
			break;

		case &quot;progress&quot;:
			// indicate that we are making a data slice
			$(&quot;#&quot; + this.div_string + &quot;_slice&quot;,this.el).html('&lt;font color=&quot;#0072B2&quot;&gt;&lt;i class=&quot;icon-cog icon-spin&quot;&gt;&lt;/i&gt; slicing&lt;/font&gt;');

			// unbind all handlers so that we can't click the while while we are slicing
			$(&quot;#&quot; + this.div_string + &quot;_slice&quot;,this.el).unbind();
			break;

		case &quot;link&quot;:
			// construct an html string to expose the link
			var html_string = ['&lt;a href=&quot;',
							   link,
							   '&quot; class=&quot;cmap-link&quot;&gt;',
							   '&lt;font color=&quot;#0072B2&quot;&gt;&lt;i class=&quot;icon-download&quot;&gt;&lt;/i&gt; download slice&lt;/font&gt;&lt;/a&gt;'].join('');

			// update the button and resolve the deferred to
			// indicate we finished the ajax call normally
			$(&quot;#&quot; + self.div_string + &quot;_slice&quot;,self.el).html(html_string);
			self.slice_defer.resolve();
			clearTimeout(self.slice_timeout);
			break;

		case &quot;fail&quot;:
			// update the button with an error message,
			// resolve the deferred and clear the Timeout
			$(&quot;#&quot; + self.div_string + &quot;_slice&quot;,self.el).html('&lt;font color=&quot;#D55E00&quot;&gt;&lt;i class=&quot;icon-exclamation&quot;&gt;&lt;/i&gt; slice failed. try again?&lt;/font&gt;');
			$(&quot;#&quot; + self.div_string + &quot;_slice&quot;,self.el).click(function(){self.slice_all_table_data();});
			self.slice_defer.resolve();
			clearTimeout(self.slice_timeout);
			break;
	}

},
/**
 * download the backing data that matches the current model state
 */
download_table: function(){
	var self = this;
	// indicate we are downloading something
	$(&quot;#&quot; + this.div_string + &quot;_download&quot;,this.el).html('&lt;font color=&quot;#0072B2&quot;&gt;&lt;i class=&quot;icon-refresh icon-spin&quot;&gt;&lt;/i&gt; exporting&lt;/font&gt;');

	// set up api call parameters
	var url = this.collection.url;
	var params = {q: this.collection.q_param,
            l:0,
            s:this.collection.s_param};

        // grab column header names
        var headers = _.pluck(this.columns,'label').join('\t');

        // grab column data names
        var names = _.pluck(this.columns,'name');

        // make a JSON API call to grab data for the table
	$.getJSON(url,params,function(res){
		var lines = [headers];
		res.forEach(function(r){
			var line_data = [];
			// for each data name in the table, grab the data. translate html
			// content to plain text where required
			names.forEach(function(n){
				switch (n){
				case &quot;pert_type_label&quot;:
					line_data.push(Barista.CMapPertTypeAlias(r[&quot;pert_type&quot;]).acronym);
					break;
				case &quot;view_result_link&quot;:
					line_data.push(r[&quot;standard_result&quot;]);
					break;
				case &quot;rpt&quot;:
					line_data.push(r.params.rpt);
					break;
				case &quot;tool_id&quot;:
					line_data.push(r.params.tool_id);
					break;
				case &quot;date&quot;:
					line_data.push(String(new Date(parseInt(r[&quot;_id&quot;].substring(0,8), 16)*1000)));
					break
				default:
					line_data.push(String(r[n]));
				}
			});
			line_string = line_data.join('\t');
			lines.push(line_string);
		});
		var lines_string = lines.join(&quot;\n&quot;);
		var blob = new Blob([lines_string], {type: &quot;text/plain;charset=utf-8&quot;});
		var timestamp = new Date().getTime();
		saveAs(blob, &quot;CMapTable&quot; + timestamp + &quot;.txt&quot;);
		$(&quot;#&quot; + self.div_string + &quot;_download&quot;,self.el).html('&lt;font color=&quot;#0072B2&quot;&gt;&lt;i class=&quot;icon-share&quot;&gt;&lt;/i&gt; export table&lt;/font&gt;');
	});
},

/**
 * open up a column to show editing buttons
 */
open_edit_table: function(){
	var self = this;
	console.log(&quot;opening edit&quot;);
	this.grid.columns.unshift(({name: &quot;edit&quot;, label: &quot;Edit&quot;, cell: Barista.HTMLCell, editable: false}));
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).html('&lt;font color=&quot;#e51c23&quot;&gt;&lt;i class=&quot;fa fa-times-circle&quot;&gt;&lt;/i&gt; done editing &lt;/font&gt;');
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).unbind();
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).click(function(){self.close_edit_table();});
},

/**
 * close column showing editing buttons
 */
close_edit_table: function(){
	var self = this;
	var idCol = this.grid.columns.where({ name: &quot;edit&quot; });
	this.grid.removeColumn(idCol);
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).html('&lt;font color=&quot;#e51c23&quot;&gt;&lt;i class=&quot;fa fa-times-circle&quot;&gt;&lt;/i&gt; edit &lt;/font&gt;');
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).unbind();
	$(&quot;#&quot; + this.div_string + &quot;_edit&quot;,this.el).click(function(){self.open_edit_table();});
},

/**
 * hides the view by dimming the opacity and hiding it in the DOM
 * @param  {number}  duration  the time in ms for the hide animation. defualts to 500
 * pert_detail_view.hide(duration);
 */
hide: function(duration){
	var self = this;
	this.$el.animate({opacity:0},duration);
	setTimeout(function(){self.$el.hide();},duration);
},

/**
 * shows the view by brightening the opacity and showing it in the DOM
 * @param  {number}  duration  the time in ms for the hide animation. defualts to 500
 * pert_detail_view.show(duration);
 */
show: function(duration){
	this.$el.show();
	this.$el.animate({opacity:1},duration);
}
});

/**
 * a Backgrid extension that supports display of html content in Backgrid tables
 * HTMLCellView defines both a Backgrid.Cell subclass (HTMLCell) and Backgrid.CellFormatter subclass
 * (HTMLFormatter) to use with it
 * These two components are used together to integrate with Backgrid's existing cell definitions in order
 * to use HTMLCell and HTMLFormatter, specify the cell parameter of a Backgrid column definition as
 * HTMLCell
 * as an example:
 *    // set up a default collection and column definition for the grid to operate on
     this.collection = new PertCollection();
     this.columns = [{name: &quot;pert_type_label&quot;, label: &quot;Pert Type&quot;, cell: HTMLCell, editable: false}];
 
     // build the template
     this.compile_template();
 
     // build the grid on the template
     this.grid = new Backgrid.Grid({
       columns: this.columns,
       collection: this.collection
     });
 */</code></pre></span>
          <section id="HTMLFormatter">
            <h1>HTMLFormatter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.HTMLFormatter</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A formatter that extends Backgrid.CellFormatter to return exactly the raw input value as opposed to the<br />string version of the raw input</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.HTMLFormatter = Backgrid.HTMLFormatter = function () {};
Barista.HTMLFormatter.prototype = new Backgrid.CellFormatter();
_.extend(Barista.HTMLFormatter.prototype, {</code></pre></span>
          <section id="fromRaw">
            <h1>fromRaw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fromRaw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>returns the raw input value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>rawValue</td>
                <td>string</td>
                <td><p>string version of raw input</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fromRaw: function (rawValue) {
  if (_.isUndefined(rawValue) || _.isNull(rawValue)) return '';
  return rawValue;
}
});</code></pre></span>
          <section id="HTMLCell">
            <h1>HTMLCell</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.HTMLCell</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>An extension of Backgrid.Cell to render raw html content into the target element of the cell</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.HTMLCell = Backgrid.HTMLCell = Backgrid.Cell.extend({
  className: &quot;html-cell&quot;,
  formatter: new Barista.HTMLFormatter(),</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function () {
  this.$el.html(this.formatter.fromRaw(this.model.get(this.column.get(&quot;name&quot;))));
  return this;
}
});</code></pre></span>
          <section id="HeatmapView">
            <h1>HeatmapView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.HeatmapView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>heatmap_view = new HeatmapView({el: $(&quot;target_selector&quot;),<br />                                                model: new HeatmapModel(),<br />                                                template: BaristaTemplates.d3_target,<br />                                                bg_color: &quot;#ffffff&quot;,<br />                                                low_color: &quot;#0000ff&quot;,<br />                                                high_color: &quot;#ff0000&quot;,<br />                                                color_scale: undefined,<br />                                                annot_color_scale: undefined,<br />                                                plot_height: 300,<br />                                                span_class: &quot;span12&quot;<br />                                                });</p><p>A Backbone.View that displays a simple heatmap<br />The view is normally paired with a HeatmapModel, but works with any model that provides data, rid, cid,<br />and title attributes<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>template</td>
                <td>string</td>
                <td><p>The handlebars template to use. Defaults to                                      BaristaTemplates.d3_target</p></td>
              </tr>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                                      #ffffff</p></td>
              </tr>
              <tr>
                <td>low_color</td>
                <td>string</td>
                <td><p>the hex color code to use as lowest value color in the heatmap,                                      defaults to #0000ff</p></td>
              </tr>
              <tr>
                <td>high_color</td>
                <td>string</td>
                <td><p>the hex color code to use as highest value color in the heatmap,                                      defaults to #ff0000</p></td>
              </tr>
              <tr>
                <td>color_scale</td>
                <td>d3.scale</td>
                <td><p>custom color scale to use in the heatmap. If supplied, low_color                                      and high_color are ignored, defaults to undefined</p></td>
              </tr>
              <tr>
                <td>annot_color_scale</td>
                <td>d3.scale</td>
                <td><p>custom color scale to use in the heatmap annotations. defaults to                                      undefined and causes the annotations to be rendered with a<br />                                     standard color scale</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the heatmap to generate in pixels, defaults to 300</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                                      &quot;span12&quot;<br />example usage:</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.HeatmapView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;HeatMapView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.HeatmapModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the defualt Backbone.View initialize method to bind the view to model changes, bind window<br />resize events to view re-draws, compile the template, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#ffffff&quot;;
	this.low_color = (this.options.low_color !== undefined) ? this.options.low_color : &quot;#0000ff&quot;;
	this.high_color = (this.options.high_color !== undefined) ? this.options.high_color : &quot;#ff0000&quot;;
	this.color_scale = (this.options.color_scale !== undefined) ? this.options.color_scale : undefined;
	this.annot_color_scale = (this.options.annot_color_scale !== undefined) ? this.options.annot_color_scale : undefined;

	// set up the defualt plot height
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 300;
	// set up the default template
	this.template = (this.options.template !== undefined) ? this.options.template : BaristaTemplates.d3_target;

	// set up the default span class
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;#span12&quot;;

	// bind render to model changes
	this.listenTo(this.model,'change', this.render);

	// compile the default template for the view and draw it for the first time
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// render the view for the first time
	this.redraw();

	// bind window resize events to redraw
	var self = this;
	$(window).resize(function() {self.redraw();} );
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	this.div_string = 'd3_target' + new Date().getTime();;
	this.$el.append(this.template({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="redraw">
            <h1>redraw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>redraw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view. Updates both static and dynamic content in the view.</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">redraw: function(){
	this.init_panel();
	this.render();
},</code></pre></span>
          <section id="init_panel">
            <h1>init_panel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_panel()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_panel: function(){
	// stuff this into a variable for later use
	var self = this;

	// check to see if the container is visible, if not, make it visible, but transparent so we draw it with
	// the proper dimensions
	if (this.$el.is(&quot;:hidden&quot;)){
		this.$el.animate({opacity:0},1);
		this.$el.show();
	}

	// set up the margin
	this.margin = 50;

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();

	// rescale the width of the vis
	this.vis.transition().attr(&quot;width&quot;,this.width);
	this.vis.transition().attr(&quot;height&quot;,this.height);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// determine the height and width of cells in the heatmap
	if (this.height &lt; this.width){
		this.cell_height = (this.height - this.margin*2) / this.model.get('data').length;
		this.cell_width = (this.height - this.margin*2) / this.model.get('data')[0].length;
	}else{
		this.cell_height = (this.width - this.margin*2) / this.model.get('data').length;
		this.cell_width = (this.width - this.margin*2) / this.model.get('data')[0].length;
	}

	// determine the plot offset to center the plot in its container
	this.x_center = this.width / 2;
	this.x_offset = this.x_center - (this.cell_width * this.model.get('data')[0].length / 2);

	// map the data into a flattened array of objects with array indices and value as attributes
	this.unraveled_data = this.unravel_data(this.model.get('data'));

	// set up the color scale
	if (this.color_scale === undefined){
		var values = _.pluck(this.unraveled_data,'value');
		data_min = _.min(values);
		data_max = _.max(values);
		this.color = d3.scale.linear().domain([data_min,data_max]).range([this.low_color, this.high_color]);
	}else{
		this.color = this.color_scale;
	}

	// set up the annotation color scale
	if (this.annot_color_scale === undefined){
		var values = _.uniq(this.model.get('annots'))
		this.annot_color = d3.scale.category10().domain(values)
	}else{
		this.annot_color = this.annot_color_scale;
	}

	// draw the heatmap cells
	this.fg_layer.selectAll('.heatmap_cell').data([]).exit().remove();
	this.fg_layer.selectAll('.heatmap_cell').data(this.unraveled_data).enter().append('rect')
		.attr('class','heatmap_cell')
		.attr('x',function(d){return self.cell_width*d.i + self.x_offset;})
		.attr('y',function(d){return self.cell_height*d.j + self.margin;})
		.attr('width',this.cell_width)
		.attr('height',this.cell_height)
		.attr('value',function(d){return d.value;})
		.attr('stroke','white')
		.attr('stroke-width',1)
		.attr('fill',function(d){return self.color(d.value);});

	// draw the row labels
	this.fg_layer.selectAll('.heatmap_rid').data([]).exit().remove();
	this.fg_layer.selectAll('.heatmap_rid').data(this.model.get('rid')).enter().append('text')
		.attr('class','heatmap_rid')
		.attr('x',this.x_offset)
		.attr('y',function(d,i){return self.cell_height*i + self.cell_height/2 + self.margin;})
		.attr('text-anchor','end')
		.attr('dx','-.2em')
		.text(function(d){return d;});

	// draw the column labels
	this.fg_layer.selectAll('.heatmap_cid').data([]).exit().remove();
	this.fg_layer.selectAll('.heatmap_cid').data(this.model.get('cid')).enter().append('text')
		.attr('class','heatmap_cid')
		.attr('y',this.margin)
		.attr('x',function(d,i){return self.cell_width*i + self.cell_width/2 + self.x_offset;})
		.attr('text-anchor','middle')
		.attr('dy','-.2em')
		.text(function(d){return d;});

	// draw the annotation categories if they are present
	if (this.model.get('annots') !== undefined){
		this.fg_layer.selectAll('.heatmap_annots').data([]).exit().remove();
		this.fg_layer.selectAll('.heatmap_annots').data(this.model.get('annots')).enter().append('rect')
			.attr('class','heatmap_annots')
			.attr('x',function(d,i){return self.cell_width*i + self.x_offset;})
			.attr('y',function(d){return self.cell_height*(self.model.get('data').length) + self.cell_height/4 + self.margin;})
			.attr('width',this.cell_width)
			.attr('height',this.cell_height/4)
			.attr('value',function(d){return d;})
			.attr('stroke','white')
			.attr('stroke-width',1)
			.attr('fill',function(d){return self.annot_color(d);});

		if (this.model.get('annots_label') !== undefined){
			// draw the annot label if it is there
			this.fg_layer.selectAll('.heatmap_annots_label').data([]).exit().remove();
			this.fg_layer.selectAll('.heatmap_annots_label').data([this.model.get('annots_label')]).append('text')
				.attr('class','heatmap_annots_label')
				.attr('x',this.x_offset)
				.attr('y',function(d){return self.cell_height*(self.model.get('data').length) + self.cell_height/2 + self.margin;})
				.attr('opacity',1)
				.attr('text-anchor','end')
				.attr('dx','-.2em')
				.text(function(d){return d;});
		}
	}

	// set up the y scale
	this.set_scale();

	// build Axis
	this.build_axis();

	// add an axis
	this.fg_layer.append(&quot;g&quot;)
		.attr(&quot;class&quot;, &quot;axis y-axis&quot;)
		.attr(&quot;transform&quot;, &quot;translate(&quot; + (this.width - this.margin/2) + &quot;,0)&quot;)
		.call(this.yAxis);

	// style the axis
	this.style_axes();

	// add the cells for the look up table
	this.add_lookup_table();

	// add a png export overlay
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,this.x_offset)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.attr('text-anchor','end')
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});
},</code></pre></span>
          <section id="add_lookup_table">
            <h1>add_lookup_table</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>add_lookup_table()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>adds a simple color lookup table based on the heatmap&#39;s color_scale</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">add_lookup_table: function(){
	var self, data, scale_range, scale_domain, scale_unit, domain_unit;
	self = this;
	data = d3.range(50);
	scale_range = this.y_scale.range();
	scale_domain = this.y_scale.domain();
	scale_unit = (scale_range[1] - scale_range[0]) / data.length;
	domain_unit = (scale_domain[0] - scale_domain[1]) / data.length;

	this.fg_layer.selectAll('.lut_cell').data(data).enter().append('rect')
		.attr('class','lut_cell')
		.attr('x',self.width - self.margin/2 - 10)
		.attr('y',function(d,i){return i*scale_unit + self.margin;})
		.attr('width',10)
		.attr('height',scale_unit)
		.attr('fill',function(d,i){return self.color(scale_domain[0] - i*domain_unit);});

},</code></pre></span>
          <section id="set_scale">
            <h1>set_scale</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_scale()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to get the y scale used in the plot</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_scale: function(){
		var domain, range_min, range_max, range;
		// get the current data domain from this.color
		domain = this.color.domain();

		// calculate the range for the scale
		range_min = this.margin;
		range_max = this.height - this.margin;
		range = [range_min,range_max];

		// set the y_scale
		this.y_scale=d3.scale.linear().domain([domain[domain.length-1],domain[0]]).range(range);
},</code></pre></span>
          <section id="build_axis">
            <h1>build_axis</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>build_axis()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to build y axis for the look up table</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">build_axis: function(){
	this.yAxis = d3.svg.axis()
		.scale(this.y_scale)
		.orient(&quot;right&quot;);
},</code></pre></span>
          <section id="style_axes">
            <h1>style_axes</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>style_axes()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to apply custom styles to axis components</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">style_axes: function(){
	this.vis.selectAll('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;
	// determine the height and width of cells in the heatmap
	if (this.height &lt; this.width){
		this.cell_height = (this.height - this.margin*2) / this.model.get('data').length;
		this.cell_width = (this.height - this.margin*2) / this.model.get('data')[0].length;
	}else{
		this.cell_height = (this.width - this.margin*2) / this.model.get('data').length;
		this.cell_width = (this.width - this.margin*2) / this.model.get('data')[0].length;
	}

	// determine the plot offset to center the plot in its container
	this.x_center = this.width / 2;
	this.x_offset = this.x_center - (this.cell_width * this.model.get('data')[0].length / 2);

	// map the data into a flattened array of objects with array indices and value as attributes
	this.unraveled_data = this.unravel_data(this.model.get('data'));

	// set up the color scale
	if (this.color_scale === undefined){
		var values = _.pluck(this.unraveled_data,'value');
		data_min = _.min(values);
		data_max = _.max(values);
		this.color = d3.scale.linear().domain([data_min,data_max]).range([this.low_color, this.high_color]);
	}else{
		this.color = this.color_scale;
	}

	// set up the annotation color scale
	if (this.annot_color_scale === undefined){
		var values = _.uniq(this.model.get('annots'))
		this.annot_color = d3.scale.category10().domain(values)
	}else{
		this.annot_color = this.annot_color_scale;
	}

	// draw the heatmap cells
	var cell_selection = this.fg_layer.selectAll('.heatmap_cell').data(this.unraveled_data);
	cell_selection.enter().append('rect')
		.attr('class','heatmap_cell')
		.attr('x',this.x_center)
		.attr('y',(this.height - this.margin)/2)
		.attr('width',0)
		.attr('height',0)
		.attr('opacity',0)
		.attr('value',function(d){return d.value;})
		.attr('stroke','white')
		.attr('stroke-width',1)
		.attr('fill',function(d){return self.color(d.value);});

	cell_selection.transition().duration(500)
		.attr('x',function(d){return self.cell_width*d.i + self.x_offset;})
		.attr('y',function(d){return self.cell_height*d.j + self.margin;})
		.attr('width',this.cell_width)
		.attr('height',this.cell_height)
		.attr('opacity',1)
		.attr('fill',function(d){return self.color(d.value);});

	cell_selection.exit().remove();

	// draw the row labels
	rid_selection = this.fg_layer.selectAll('.heatmap_rid').data(this.model.get('rid'));
	rid_selection.enter().append('text')
		.attr('class','heatmap_rid')
		.attr('x',this.x_offset)
		.attr('y',(this.height - this.margin)/2)
		.attr('opacity',0)
		.attr('text-anchor','end')
		.attr('dx','-.2em')
		.text(function(d){return d;});

	rid_selection.transition().duration(500)
		.attr('opacity',1)
		.attr('y',function(d,i){return self.cell_height*i + self.cell_height/2 + self.margin;})
		.text(function(d){return d;});

	rid_selection.exit().remove();

	// draw the column labels
	cid_selection = this.fg_layer.selectAll('.heatmap_cid').data(this.model.get('cid'));
	cid_selection.enter().append('text')
		.attr('class','heatmap_cid')
		.attr('y',this.margin)
		.attr('x',this.x_center)
		.attr('opacity',0)
		.attr('text-anchor','middle')
		.attr('dy','-.2em')
		.text(function(d){return d;});

	cid_selection.transition().duration(500)
		.attr('opacity',1)
		.attr('x',function(d,i){return self.cell_width*i + self.cell_width/2 + self.x_offset;})
		.text(function(d){return d;});

	cid_selection.exit().remove();

	// draw the annotation categories if they are present
	if (this.model.get('annots') !== undefined){
		var label_selection = this.fg_layer.selectAll('.heatmap_annots').data(this.model.get('annots'));
		label_selection.enter().append('rect')
			.attr('class','heatmap_annots')
			.attr('x',this.x_center)
			.attr('y',(this.height - this.margin)/2)
			.attr('width',0)
			.attr('height',0)
			.attr('opacity',0)
			.attr('value',function(d){return d;})
			.attr('stroke','white')
			.attr('stroke-width',1)
			.attr('fill',function(d){return self.annot_color(d);});

		label_selection.transition().duration(500)
			.attr('x',function(d,i){return self.cell_width*i + self.x_offset;})
			.attr('y',function(d){return self.cell_height*(self.model.get('data').length) + self.cell_height/4 + self.margin;})
			.attr('width',this.cell_width)
			.attr('height',this.cell_height/4)
			.attr('opacity',1)
			.attr('fill',function(d){return self.annot_color(d);});

		label_selection.exit().remove();

		if (this.model.get('annots_label') !== undefined){
			// draw the annot label if it is there
			label_text_selection = this.fg_layer.selectAll('.heatmap_annots_label').data([this.model.get('annots_label')]);
			label_text_selection.enter().append('text')
				.attr('class','heatmap_annots_label')
				.attr('x',this.x_offset)
				.attr('y',(this.height - this.margin)/2)
				.attr('opacity',0)
				.attr('text-anchor','end')
				.attr('dx','-.2em')
				.text(function(d){return d;});

			label_text_selection.transition().duration(500)
				.attr('opacity',1)
				.attr('y',function(d){return self.cell_height*(self.model.get('data').length) + self.cell_height/2 + self.margin;})
				.text(function(d){return d;});

			label_text_selection.exit().remove();
		}
	}
},</code></pre></span>
          <section id="unravel_data">
            <h1>unravel_data</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>unravel_data()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>internal utility function to express 2D array data as a flat data array of objects with array<br />coordinates and data value as attributes</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>data</td>
                <td>array</td>
                <td><p>2D array of data</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">unravel_data: function(data){
	unraveled_data = [];
	data.forEach(function(i_e,i){
		i_e.forEach(function(j_e,j){
			unraveled_data.push({i:j, j:i, value:j_e});
		});
	});
	return unraveled_data;
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	// build a canvas element to store the image temporarily while we save it
	var width = this.width;
	var height = this.height;
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;cmapHeatmapView&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){canvas.toBlob(function(blob){saveAs(blob,filename);});}
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}
});</code></pre></span>
          <section id="LDMapView">
            <h1>LDMapView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.LDMapView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.View that displays a simple LDMap<br />The view is normally paired with a HeatMapModel, but works with any model that provides <em>data</em>,<em>cid</em>,<br />and title attributes<br />example usage:<br />LDMap_view = new LDMapView({el: $(&quot;target_selector&quot;),<br />                                                model: new HeatmapModel(),<br />                                                template: BaristaTemplates.d3_target,<br />                                                bg_color: &quot;#ffffff&quot;,<br />                                                low_color: &quot;#0000ff&quot;,<br />                                                high_color: &quot;#ff0000&quot;,<br />                                                color_scale: undefined,<br />                                                plot_height: 300,<br />                                                span_class: &quot;span12&quot;<br />                                                });</p><p>optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>tenplate</td>
                <td>string</td>
                <td><p>The handlebars template to use. Defaults to BaristaTemplates.d3_target</p></td>
              </tr>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                                #ffffff</p></td>
              </tr>
              <tr>
                <td>low_color</td>
                <td>string</td>
                <td><p>the hex color code to use as lowest value color in the LDMap, defaults to                                #0000ff</p></td>
              </tr>
              <tr>
                <td>high_color</td>
                <td>string</td>
                <td><p>the hex color code to use as highest value color in the LDMap, defaults                                to #ff0000</p></td>
              </tr>
              <tr>
                <td>color_scale</td>
                <td>d3.scale</td>
                <td><p>custom color scale to use in the LDMap. If supplied, low_color and                                high_color are ignored, defaults to undefined</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the LDMap to generate in pixels, defaults to 300</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                                &quot;span12&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.LDMapView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;LDMapView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.HeatmapModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the defualt Backbone.View initialize method to bind the view to model changes, bind window<br />resize events to view re-draws, compile the template, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#ffffff&quot;;
	this.low_color = (this.options.low_color !== undefined) ? this.options.low_color : &quot;#0000ff&quot;;
	this.high_color = (this.options.high_color !== undefined) ? this.options.high_color : &quot;#ff0000&quot;;
	this.color_scale = (this.options.color_scale !== undefined) ? this.options.color_scale : undefined;

	// set up the defualt plot height
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 300;
	// set up the default template
	this.template = (this.options.template !== undefined) ? this.options.template : BaristaTemplates.d3_target;

	// set up the default span class
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;#span12&quot;;

	// bind render to model changes
	this.listenTo(this.model,'change', this.render);

	// compile the default template for the view and draw it for the first time
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// render the view for the first time
	this.redraw();

	// bind window resize events to redraw
	var self = this;
	$(window).resize(function() {self.redraw();} );
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	this.div_string = 'd3_target' + new Date().getTime();;
	this.$el.append(this.template({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="redraw">
            <h1>redraw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>redraw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view. Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">redraw: function(){
	this.init_panel();
	this.render();
},</code></pre></span>
          <section id="init_panel">
            <h1>init_panel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_panel()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_panel: function(){
	// stuff this into a variable for later use
	var self = this;

	// check to see if the container is visible, if not, make it visible, but transparent so we draw it with
	// the proper dimensions
	if (this.$el.is(&quot;:hidden&quot;)){
		this.$el.animate({opacity:0},1);
		this.$el.show();
	}

	// set up the margin
	this.margin = 50;

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.ld_cell_layer').data([]).exit().remove();
	this.ld_cell_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;ld_cell_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();

	// rescale the width of the vis
	this.vis.transition().attr(&quot;width&quot;,this.width);
	this.vis.transition().attr(&quot;height&quot;,this.height);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// determine the height and width of cells in the heatmap
	if (this.height &lt; this.width){
		this.cell_height = (this.height - this.margin) / this.model.get('data').length;
		this.cell_width = (this.height - this.margin) / this.model.get('data')[0].length;
	}else{
		this.cell_height = (this.width - this.margin) / this.model.get('data').length;
		this.cell_width = (this.width - this.margin) / this.model.get('data')[0].length;
	}

	// determine the plot offset to center the plot in its container
	this.x_center = this.width / 2;
	this.x_offset = this.x_center - (this.cell_width * this.model.get('data')[0].length / 2);

	// map the data into a flattened array of objects with array indices and value as attributes
	this.unraveled_data = this.unravel_data(this.model.get('data'));

	// set up the color scale
	if (this.color_scale === undefined){
		var values = _.pluck(this.unraveled_data,'value');
		data_min = _.min(values);
		data_max = _.max(values);
		this.color = d3.scale.linear().domain([data_min,data_max]).range([this.low_color, this.high_color]);
	}else{
		this.color = this.color_scale;
	}

	// draw the LDMap cells
	this.ld_cell_layer.selectAll('.heatmap_cell').data([]).exit().remove();
	this.ld_cell_layer.selectAll('.heatmap_cell').data(this.unraveled_data).enter().append('rect')
		.attr('class','heatmap_cell')
		.attr('x',function(d){return self.cell_width*d.i + self.x_offset;})
		.attr('y',function(d){return self.cell_height*d.j + self.margin;})
		.attr('transform',function(d){
			var x = self.cell_width + self.x_offset;
			var y = self.cell_height + self.margin;
			return 'rotate(45,' + x + ',' + y + ')';
		})
		.attr('width',this.cell_width)
		.attr('height',this.cell_height)
		.attr('value',function(d){return d.value;})
		.attr('stroke','white')
		.attr('stroke-width',1)
		.attr('fill',function(d){return self.color(d.value);});

	// draw the row labels
	this.fg_layer.selectAll('.heatmap_rid').data([]).exit().remove();
	this.fg_layer.selectAll('.heatmap_rid').data(this.model.get('rid')).enter().append('text')
		.attr('class','heatmap_rid')
		.attr('x',this.x_offset)
		.attr('y',function(d,i){return self.diamond_height*i + self.diamond_height/2 + self.margin;})
		.attr('text-anchor','end')
		.attr('dx','-.2em')
		.text(function(d){return d;});

	// add a png export overlay
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,this.x_offset)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.attr('text-anchor','end')
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;
	// determine the height and width of cells in the heatmap
	var usable_height = this.height - this.margin;
	this.diamond_height = usable_height / this.model.get('data').length;
	this.cell_height = this.cell_width = Math.sqrt(Math.pow(this.diamond_height,2) / 2);

	// determine the plot offset to center the plot in its container
	this.x_center = this.width / 2;
	this.x_offset = this.x_center - (this.cell_width * this.model.get('data')[0].length / 2);

	// map the data into a flattened array of objects with array indices and value as attributes
	this.unraveled_data = this.unravel_data(this.model.get('data'));

	// set up the color scale
	if (this.color_scale === undefined){
		var values = _.pluck(this.unraveled_data,'value');
		data_min = _.min(values);
		data_max = _.max(values);
		this.color = d3.scale.linear().domain([data_min,data_max]).range([this.low_color, this.high_color]);
	}else{
		this.color = this.color_scale;
	}

	// draw the heatmap cells
	var cell_selection = this.ld_cell_layer.selectAll('.heatmap_cell').data(this.unraveled_data);
	cell_selection.enter().append('rect')
		.attr('class','heatmap_cell')
		.attr('x',this.x_center)
		.attr('y',(this.height - this.margin)/2)
		.attr('width',0)
		.attr('height',0)
		.attr('opacity',0)
		.attr('value',function(d){return d.value;})
		.attr('stroke','white')
		.attr('stroke-width',1)
		.attr('fill',function(d){return self.color(d.value);});

	cell_selection.transition().duration(500)
		.attr('x',function(d){return self.cell_width*d.i + self.x_offset;})
		.attr('y',function(d){return self.cell_height*d.j + self.margin;})
		.attr('transform',function(d){
			var x = self.cell_width + self.x_offset;
			var y = self.cell_height + self.margin;
			return 'rotate(45,' + x + ',' + y + ')';
		})
		.attr('width',this.cell_width)
		.attr('height',this.cell_height)
		.attr('opacity',1)
		.attr('fill',function(d){return self.color(d.value);});

	cell_selection.exit().remove();

	// draw the row labels
	rid_selection = this.fg_layer.selectAll('.heatmap_rid').data(this.model.get('rid'));
	rid_selection.enter().append('text')
		.attr('class','heatmap_rid')
		.attr('x',this.x_offset)
		.attr('y',(this.height - this.margin)/2)
		.attr('opacity',0)
		.attr('text-anchor','end')
		.attr('dy','-.5em')
		.text(function(d){return d;});

	rid_selection.transition().duration(500)
		.attr('opacity',1)
		.attr('x',this.cell_width + this.x_offset)
		.attr('y',function(d,i){return self.diamond_height*i + self.diamond_height/2 + self.margin;})
		.text(function(d){return d;});

	rid_selection.exit().remove();
},</code></pre></span>
          <section id="unravel_data">
            <h1>unravel_data</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>unravel_data()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>internal utility function to express 2D array data as a flat data array of objects with array<br />coordinates and data value as attributes</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>data</td>
                <td>array</td>
                <td><p>2D array of data</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">unravel_data: function(data){
	unraveled_data = [];
	data.forEach(function(i_e,i){
		i_e.forEach(function(j_e,j){
			if (i &lt; j){
				unraveled_data.push({i:j, j:i, value:j_e});
			}
		});
	});
	return unraveled_data;
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	// build a canvas element to store the image temporarily while we save it
	var width = this.width;
	var height = this.height;
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;cmapHeatmapView&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){canvas.toBlob(function(blob){saveAs(blob,filename);});}
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}
});</code></pre></span>
          <section id="PertCountView">
            <h1>PertCountView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.PertCountView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>count_view = new PertCountView({bg_color:&quot;#ffffff&quot;,<br />                                    well_color: &quot;#bdbdbd&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;span4&quot;,<br />                                    static_text: &quot;Reagents&quot;,<br />                                    categories: []});</p><p>A Backbone.View that shows that number of perturbagens matching a given query<br />Optionally, sub-category counts are give for the type of perturbagen queried for<br />This view is frequently paired with a PertCountModel or CellCountModel<br />basic use:<br />count_view = new PertCountView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                              #ffffff</p></td>
              </tr>
              <tr>
                <td>well_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the wells, defaults to                              #bdbdbd</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults                              to #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                              &quot;col-lg-4&quot;</p></td>
              </tr>
              <tr>
                <td>static_text</td>
                <td>string</td>
                <td><p>the static text header to use in the view, defaults to &quot;Reagents&quot;</p></td>
              </tr>
              <tr>
                <td>categories</td>
                <td>array</td>
                <td><p>an array of objects to use as categories to display, defaults to []</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.PertCountView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;PertCountView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.PertCountModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#ffffff&quot;;
	this.well_color = (this.options.well_color !== undefined) ? this.options.well_color : &quot;#bdbdbd&quot;;
	this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : &quot;#1b9e77&quot;;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;col-lg-4&quot;;

	// set up static text, default if not specified
	this.static_text = (this.options.static_text !== undefined) ? this.options.static_text : &quot;Reagents&quot;;

	// set up the default plot height
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 120;

	// allow for construction inside of a shadow DOM
	this.shadow_el = (this.options.shadow_el !== undefined) ? this.options.shadow_el : null;
	this.shadow_root = (this.options.shadow_root !== undefined) ? this.options.shadow_root : null;

	// set up default categories to display
	this.categories = (this.options.categories !== undefined) ? this.options.categories : [];
	this.category_ids = _.pluck(this.categories,'_id');

	// get categories from model and determine the maximum category count
	// this.categories = this.model.get('pert_types');
	this.max_category_count = _.max(_.pluck(this.categories,'count'));

	// bind render to model changes
	this.listenTo(this.model,'change', this.render);

	// compile the default template for the view
	this.compile_template();

	// set up a $div selector that can find the target div even if it is in a
	// shadow DOM
	if (this.shadow_el &amp;&amp; this.shadow_root){
		this.$div = $(this.shadow_root).children(this.shadow_el).children(&quot;#&quot; + this.div_string);
	}else{
		this.$div = $(&quot;#&quot; + this.div_string);
	}

	// define the location where d3 will build its plot
	this.width = this.$div.width();
	this.height = this.$div.outerHeight();
	this.vis = d3.select(this.$div[0]).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height)

	// render the vis
	this.redraw();

	// bind window resize events to redraw.
	var self = this;
	$(window).resize(function() {self.redraw();} );
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	this.div_string = 'd3_target' + new Date().getTime();
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="redraw">
            <h1>redraw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>redraw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">redraw: function(){
	this.init_panel();
	this.render();
},</code></pre></span>
          <section id="init_panel">
            <h1>init_panel</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_panel()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_panel: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = this.$div.width();
	this.height = this.$div.outerHeight();

	// rescale the width of the vis
	this.vis.transition().duration(1).attr(&quot;width&quot;,this.width);

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	this.vis.selectAll('.controls_layer').data([]).exit().remove();
	this.controls_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;controls_layer&quot;);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// draw the static Text
	this.fg_layer.selectAll('.static_text').data([]).exit().remove();
	this.fg_layer.selectAll('.static_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;static_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,14)
						.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
						.attr(&quot;font-weight&quot;,&quot;bold&quot;)
						.attr(&quot;font-size&quot;,&quot;13pt&quot;)
						.attr(&quot;fill&quot;,this.fg_color)
						.text(this.static_text.toUpperCase());
	// draw the pert count info
	var count = this.model.get('count');
	if (typeof(count) !== 'number'){
		count = 0;
	}
	var count_text = this.fg_layer.selectAll('.count').data([]).exit().remove();
	count_text = this.fg_layer.selectAll('.count').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;count&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,55)
						.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
						.attr(&quot;font-weight&quot;,&quot;bold&quot;)
						.attr(&quot;font-size&quot;,&quot;36pt&quot;)
						.text(count);

	// for each sub-category, draw a bar graph well
	this.category_rect_selection = this.fg_layer.selectAll('.category_rect_well');
	this.category_rect_selection.data([]).exit().remove();
	this.category_rect_selection.data(this.categories).enter().append('rect')
		.attr(&quot;class&quot;,&quot;category_rect_well&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,function(d,i){return i*35 + 80;})
		.attr(&quot;height&quot;,10)
		.attr(&quot;width&quot;,function(d){return (self.width - 20);})
		.attr(&quot;fill&quot;,this.well_color);

	// for each sub-category, draw a bar graph
	this.category_rect_selection = this.fg_layer.selectAll('.category_rect');
	this.category_rect_selection.data([]).exit().remove();
	this.category_rect_selection.data(this.categories).enter().append('rect')
		.attr(&quot;class&quot;,&quot;category_rect&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,function(d,i){return i*35 + 80;})
		.attr(&quot;height&quot;,10)
		.attr(&quot;width&quot;,function(d){return (self.width - 20) * (d.count / self.max_category_count);})
		.attr(&quot;fill&quot;,this.fg_color);

	// for each sub-category, add a name
	this.fg_layer.selectAll('.category_name').data([]).exit().remove();
	this.fg_layer.selectAll('.category_name').data(this.categories).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;,&quot;category_name&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,function(d,i){return i*35 + 105;})
		.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
		.attr(&quot;font-weight&quot;,&quot;normal&quot;)
		.attr(&quot;font-size&quot;,&quot;12pt&quot;)
		.text(function(d){return Barista.CMapPertTypeAlias(d._id).name;});

	// for each sub-category, add a value
	this.fg_layer.selectAll('.category_value').data([]).exit().remove();
	this.fg_layer.selectAll('.category_value').data(this.categories).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;,&quot;category_value&quot;)
		.attr(&quot;x&quot;,this.width - 10)
		.attr(&quot;y&quot;,function(d,i){return i*35 + 105;})
		.attr(&quot;font-family&quot;,&quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;)
		.attr(&quot;font-weight&quot;,&quot;normal&quot;)
		.attr(&quot;font-size&quot;,&quot;12pt&quot;)
		.attr(&quot;text-anchor&quot;,&quot;end&quot;)
		.text(&quot;xhtml:div&quot;)
		.text(function(d){return d.count.toFixed(0);});

	// add a png export overlay
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = this.$div.width();
	this.height = this.$div.outerHeight();

	// draw the pert count info
	var count = this.model.get('count');
	if (typeof(count) !== 'number'){
		count = 0;
	}
	this.vis.selectAll('.count').data([1])
		.transition().duration(500)
		.tween(&quot;text&quot;, function() {
		    var i = d3.interpolate(this.textContent.replace(&quot;,&quot;,&quot;&quot;), count);
		    return function(t) {
		      this.textContent = Barista.numberWithCommas(Math.round(i(t)))	;
		    };
		});

	// transition the updated bars
	count = this.model.get('count');
	this.pert_types = this.model.get(&quot;pert_types&quot;);
	this.pert_types = _.filter(this.pert_types,function(o){return self.category_ids.indexOf(o._id) != -1;});
	var category_counts = _.pluck(this.pert_types,'count');
	var category_sum = _.reduce(category_counts, function(memo, num){ return memo + num; }, 0);
	this.pert_types.push({_id:'other', count:count - category_sum});
	this.categories.forEach(function(e,i,l){
		var ids = _.pluck(self.pert_types,'_id');
		var index = ids.indexOf(e._id);
		if (index != -1){
			self.categories[i].count = self.pert_types[index].count;
		}else{
			self.categories[i].count = 0.00001;
		}
	});
	this.max_category_count = _.max(_.pluck(this.categories,'count'));
	this.max_category_count = (this.max_category_count &lt; 1) ? 1 : this.max_category_count;
	var category_update_selection = this.fg_layer.selectAll('.category_rect').data(this.categories);
	category_update_selection.transition().duration(500)
		.attr(&quot;width&quot;,function(d){return (self.width - 20) * (d.count / self.max_category_count);});

	// transition the updated category labels
	this.fg_layer.selectAll('.category_value').data(this.categories)
		.transition().duration(500)
		.tween(&quot;text&quot;, function(d,i) {
			var count = d.count.toFixed(0);
		    var i = d3.interpolate(this.textContent.replace(&quot;,&quot;,&quot;&quot;), count);
		    return function(t) {
		      this.textContent = Barista.numberWithCommas(Math.round(i(t)));
		    };
		});
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	//set the animate the div containing the view by applying and then removing
	// css classes that defined the transitions we want
	var $div = this.$div;
	$div.addClass(&quot;barista-base-view&quot;);
	$div.toggleClass(&quot;exporting&quot;);
	setTimeout(function(){$div.toggleClass(&quot;exporting&quot;);},500);

	// build a canvas element to store the image temporarily while we save it
	var width = this.width;
	var height = this.height;
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;BaristaPertCountView&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){
		canvas.toBlob(function(blob){
			saveAs(blob,filename);
			});
	}
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}
});</code></pre></span>
          <section id="PertDetailView">
            <h1>PertDetailView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.PertDetailView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_detail_view = new PertDetailView({el: $(&quot;target_selector&quot;),<br />                                                 model: PertDetailModel,<br />                                                 bg_color: &quot;#ffffff&quot;,<br />                                                 span_class: &quot;col-lg-12&quot;});</p><p>A Backbone.View that shows information about a small molecule compound or gene<br />This view is frequently paired with a PertDetailModel<br />pert_detail_view = new PertDetailView({el: $(&quot;target_selector&quot;)});<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                             #ffffff</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                             &quot;col-lg-12&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.PertDetailView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;PertDetailView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.PertDetailModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the defualt Backbone.View initialize method to bind the view to model changes, bind window<br />resize events to view re-draws, compile the template, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	var self = this;
	// set up the plot height
	this.options.plot_height = 260;

	// set up the open and closed state heights
	this.open_height = this.options.plot_height;
	this.closed_height = this.options.plot_height;
	this.panel_open = false;

	//populate the model with an initial compound and then render the view
	this.model.fetch(&quot;war&quot;,&quot;compound&quot;).then(function(){
		console.log(self.model.attibutes);
		self.base_initialize();
	});

},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// keep track of our scope at this level
	var self = this;

	// render the base view components
	this.base_render();

	// (re)draw the pert_iname text
	this.fg_layer.selectAll('.pert_iname_text').data([]).exit().remove();
	this.fg_layer.selectAll('.pert_iname_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;pert_iname_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,75)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-weight&quot;,&quot;bold&quot;)
						.attr(&quot;font-size&quot;,&quot;36pt&quot;)
						.text(this.model.get('pert_iname'));

	// (re)draw the pert_summary or clear it if there pert_summary is null
	if (this.model.get('pert_summary')){
		this.render_summary({summary_string: this.model.get('pert_summary'),
							top: 45,
							bottom: 100,
							left: this.fg_layer.selectAll('.pert_iname_text').node().getComputedTextLength() + 30});
	}else{
		this.clear_summary();
	}

	// add a png export overlay
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 20)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});

	// render an image that will to indicate that the user can click the content to unfold the panel
	this.cevron_image_link = (this.panel_open) ? '//coreyflynn.github.io/Bellhop/img/up_arrow_select.png' : '//coreyflynn.github.io/Bellhop/img/down_arrow_select.png';

	this.controls_layer.selectAll('.cevron_icon').data([]).exit().remove();
	this.controls_layer.selectAll('.cevron_icon').data([1])
		.enter().append(&quot;svg:image&quot;)
		.attr(&quot;class&quot;,&quot;cevron_icon&quot;)
		.attr(&quot;xlink:href&quot;, this.cevron_image_link)
		.attr(&quot;x&quot;,this.width/2 - 9)
		.attr(&quot;y&quot;,function(){
			if (self.panel_open){
				return self.height - 15;
			}else{
				return self.height - 20;
			}
		})
		.attr(&quot;height&quot;,20)
		.attr(&quot;width&quot;, 18)
		.attr(&quot;transform&quot;, &quot;rotate(0)&quot;)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.on(&quot;click&quot;, function(){self.toggle_panel_state()});

	// render a button to allow the user to expand the view to show its full content
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).data([1]).enter()
		.append(&quot;rect&quot;)
		.attr(&quot;x&quot;,0)
		.attr(&quot;y&quot;,this.height - 15)
		.attr(&quot;class&quot;,this.div_string + &quot;more_button&quot;)
		.attr(&quot;height&quot;,15)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;opacity&quot;,0)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0);})
		.on(&quot;click&quot;, function(){self.toggle_panel_state()})

	// render the compound or gene specfic portion of the view
	switch (this.model.get(&quot;pert_type&quot;)){
	case &quot;trt_cp&quot;:
		this.render_compound();
		break;
	case &quot;gene&quot;:
		this.render_gene();
		break;
	};

	return this;
},

/**
 * utility to render the compound specific parts of the view
 */
render_compound: function(){
	this.clear_label_and_text();
	var self = this;
	// (re)draw the pert_id text
	this.fg_layer.selectAll('.pert_id_text').data([]).exit().remove();
	this.fg_layer.selectAll('.pert_id_text').data([1])
						.enter()
						.append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;pert_id_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,100)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.text(this.model.get('pert_id'));

	// draw compound structure if there is one
	if (this.model.get(&quot;structure_url&quot;)){
		this.fg_layer.selectAll('.index_text_icon').data([]).exit().remove();
		this.fg_layer.selectAll('.index_text_icon').data([1])
							.enter().append(&quot;svg:image&quot;)
							.attr(&quot;class&quot;,&quot;index_text_icon&quot;)
							.attr(&quot;xlink:href&quot;, this.model.get(&quot;structure_url&quot;))
							.attr(&quot;x&quot;,10)
							.attr(&quot;y&quot;,100)
							.attr(&quot;height&quot;,150)
							.attr(&quot;width&quot;,300)
							.style(&quot;cursor&quot;,&quot;pointer&quot;)
							.on(&quot;click&quot;, function(){window.location = self.model.get('structure_url')});
	}

	// draw the static index reagent text
	this.fg_layer.selectAll('.index_text').data([]).exit().remove();
	this.fg_layer.selectAll('.index_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;index_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,30)
						.attr(&quot;fill&quot;,&quot;#E69F00&quot;)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;20pt&quot;)
						.text('Small Molecule Compound');

	// render additional labels
	this.label_y_position = 100;

	// (re)draw the in_summly annotation
	this.render_label_and_value('collection', 'Collection', 'pert_icollection', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('num_sig', 'Signatures', 'num_sig', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('gold_sig', 'Gold Signatures', 'num_gold', false, 320);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('num_inst', 'Experiments', 'num_inst', false, 320);

	// (re)draw the in_summly annotation
	this.render_label_and_value('summly', 'In Summly', 'in_summly', false, 320);


	// set the y position to be below the fold
	this.label_y_position = 260;

	// (re)draw the weight label and weight
	this.render_label_and_value('weight', 'Weight', 'molecular_wt');

	// (re)draw the formula and label
	this.render_label_and_value('formula', 'Formula', Barista.NumbersToSubscript(this.model.get('molecular_formula')),true);

	// (re)draw the logp and label
	this.render_label_and_value('logp', 'LogP', 'logp');

	// (re)draw the formula and label
	this.render_label_and_value('vendor', 'Vendor', 'pert_vendor');

	// (re)draw the pubchem_cid and label
	this.render_label_and_value('pubchem_cid', 'PubChem CID', 'pubchem_cid', false, 10, &quot;//pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=&quot; + self.model.get('pubchem_cid'));

	// (re)draw the InChIKey label and InChIKey
	if(this.model.get(&quot;inchi_key&quot;)){
		this.render_label_and_value('inchi_key', 'InChIKey', this.model.get(&quot;inchi_key&quot;).split(&quot;InChIKey=&quot;)[1], true);
	}

	// (re)draw the InChI string
	// this.render_label_and_value('inchi_string', 'InChI String', this.model.get(&quot;inchi_string&quot;).split(&quot;InChI=&quot;)[1], true);

	// (re)draw the SMILES
	this.render_label_and_value('smiles', 'SMILES', 'canonical_smiles');

	// draw alternate names
	this.label_y_position += 20;
	if (this.model.get('alt_name')){
		this.render_label_and_value('alt_name_label', 'Alternate Names', '', true);
		this.label_y_position += 5;
		this.draw_tags('alt_name', 'Alternate Names', this.model.get('alt_name'), 'white', '#BDBDBD');
	}

	// draw the cell lines that the compound has been profiled in
	if (this.model.get('cell_id')){
		this.render_label_and_value('cell_id_label', 'Cell Lines', '', true);
		this.label_y_position += 5;
		this.draw_tags('cell_id', 'Cell Lines', this.model.get('cell_id'), 'white', '#CC79A7');
	}

	// draw the signatures for the compound
	if (this.model.get('sig_id')){
		this.render_label_and_value('sig_id_label', 'Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('sig_id', 'Signature IDs', this.model.get('sig_id'), 'white', '#BDBDBD');
	}

	// draw the gold signatures for the compound
	if (this.model.get('sig_id_gold')){
		this.render_label_and_value('gold_sig_id_label', 'Gold Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('gold_sig_id', 'Gold Signature IDs', this.model.get('sig_id_gold'), 'white', '#BDBDBD');
	}

	// check to see if there is a pubchem id and draw a link for it if there
	// is one
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).data([]).exit().remove();
	if (this.model.get('pubchem_cid')){
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).data([1]).enter().append(&quot;text&quot;)
			.attr(&quot;class&quot;, this.div_string + &quot;pubchem_link no_png_export&quot;)
			.attr(&quot;x&quot;,this.width - 10)
			.attr(&quot;y&quot;,this.height - 20)
			.attr(&quot;opacity&quot;,0.25)
			.attr(&quot;text-anchor&quot;,&quot;end&quot;)
			.style(&quot;cursor&quot;,&quot;pointer&quot;)
			.text(&quot;PubChem&quot;)
			.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
			.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
			.on(&quot;click&quot;, function(){window.location = &quot;//pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=&quot; + self.model.get('pubchem_cid')});
	}

	// check to see if there is a wikipedia url and draw a link for it if there
	// is one
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).data([]).exit().remove();
	if (this.model.get('wiki_url')){
		this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).data([1]).enter().append(&quot;text&quot;)
			.attr(&quot;class&quot;, this.div_string + &quot;wiki_link no_png_export&quot;)
			.attr(&quot;x&quot;,this.width - 80)
			.attr(&quot;y&quot;,this.height - 20)
			.attr(&quot;opacity&quot;,0.25)
			.attr(&quot;text-anchor&quot;,&quot;end&quot;)
			.style(&quot;cursor&quot;,&quot;pointer&quot;)
			.text(&quot;Wiki&quot;)
			.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
			.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
			.on(&quot;click&quot;, function(){window.location = self.model.get('wiki_url')});
	}
},

/**
 * utility to render the gene specific parts of the view
 */
render_gene: function(){
	this.clear_label_and_text();
	var self = this;
	// draw the static index reagent text
	this.fg_layer.selectAll('.index_text').data([]).exit().remove();
	this.fg_layer.selectAll('.index_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;index_text&quot;)
						.attr(&quot;x&quot;,10)
						.attr(&quot;y&quot;,30)
						.attr(&quot;fill&quot;,&quot;#0072B2&quot;)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;20pt&quot;)
						.text('Gene');

	// (re)draw the static knockdown text
	this.fg_layer.selectAll('.pert_id_text').data([]).exit().remove();
	var static_text_enter = this.fg_layer.selectAll('.pert_id_text').data([1]).enter();
	if (this.model.get(&quot;has_kd&quot;)){
		this.fg_layer.selectAll('.kd_pert_id_text').data([]).exit().remove();
		this.fg_layer.selectAll('.kd_pert_id_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,&quot;kd_pert_id_text pert_id_text&quot;)
							.attr(&quot;x&quot;,10)
							.attr(&quot;y&quot;,100)
							.attr(&quot;fill&quot;,&quot;#56B4E8&quot;)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.text(&quot;Knockdown&quot;);
	}

	// (re)draw the static overexpression text
	if (this.model.get(&quot;has_oe&quot;)){
		this.fg_layer.selectAll('.oe_pert_id_text').data([]).exit().remove();
		this.fg_layer.selectAll('.oe_pert_id_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,&quot;oe_pert_id_text pert_id_text&quot;)
							.attr(&quot;x&quot;,350)
							.attr(&quot;y&quot;,100)
							.attr(&quot;fill&quot;,&quot;#D55E00&quot;)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.text(&quot;Over Expression&quot;);
	}

	// render additional labels
	this.label_y_position = 100;

	// (re)draw the pert_id annotation
	this.render_label_and_value('trt_sh_pert_id', 'ID', 'trt_sh_pert_id');
	this.render_label_and_value('trt_oe_pert_id', 'ID', 'trt_oe_pert_id', false, 350, null,false);

	// (re)draw the signatures annotation
	this.render_label_and_value('trt_sh_num_sig', 'Signatures', 'trt_sh_num_sig');
	this.render_label_and_value('trt_oe_num_sig', 'Signatures', 'trt_oe_num_sig', false, 350, null,false);

	// (re)draw the gold signatures annotation
	this.render_label_and_value('trt_sh_num_gold', 'Gold Signatures', 'trt_sh_num_gold');
	this.render_label_and_value('trt_oe_num_gold', 'Gold Signatures', 'trt_oe_num_gold', false, 350, null,false);

	// (re)draw the experiments annotation
	this.render_label_and_value('trt_sh_num_inst', 'Experiments', 'trt_sh_num_inst');
	this.render_label_and_value('trt_oe_num_inst', 'Experiments', 'trt_oe_num_inst', false, 350, null,false);


	// set the y position to be below the fold
	this.label_y_position = 260;

	// (re)draw the vector_id annotation
	this.render_label_and_value('trt_sh_vector_id', 'Knockdown Vector', 'trt_sh_vector_id');

	// (re)draw the target region annotation
	this.render_label_and_value('trt_sh_target_region', 'Knockdown Target Region', 'trt_sh_target_region');

	// (re)draw the 6 base seed annotation
	this.render_label_and_value('trt_sh_seed_seq6', 'Knockdown 6 Base Seed Sequence', 'trt_sh_seed_seq6');

	// (re)draw the 7 base seed annotation
	this.render_label_and_value('trt_sh_seed_seq7', 'Knockdown 7 Base Seed Sequence', 'trt_sh_seed_seq7');

	// (re)draw the target sequence annotation
	this.render_label_and_value('trt_sh_target_seq', 'Knockdown Target Sequence', 'trt_sh_target_seq');

	// (re)draw the oligo sequence annotation
	this.render_label_and_value('trt_sh_oligo_seq', 'Knockdown Oligo Sequence', 'trt_sh_oligo_seq');

	// draw the cell lines that the knockdown has been profiled in
	this.label_y_position += 20;
	if (this.model.get('trt_sh_cell_id')){
		this.render_label_and_value('trt_sh_cell_id_label', 'Knockdown Cell Lines', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_sh_cell_id', 'Cell Lines', this.model.get('trt_sh_cell_id'), 'white', '#CC79A7');
	}

	// draw the signatures for the knockknockdown
	if (this.model.get('trt_sh_sig_id')){
		this.render_label_and_value('trt_sh_sig_id_label', 'Knockdown Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_sh_sig_id', 'Signature IDs', this.model.get('trt_sh_sig_id'), 'white', '#BDBDBD');
	}

	// draw the gold signatures for the knockdown
	if (this.model.get('trt_sh_sig_id_gold')){
		this.render_label_and_value('trt_sh_sig_id_gold_label', 'Gold Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_sh_sig_id_gold', 'Knockdown Gold Signature IDs', this.model.get('trt_sh_sig_id_gold'), 'white', '#BDBDBD');
	}

	// draw the cell lines that the over expression has been profiled in
	this.label_y_position += 20;
	if (this.model.get('trt_oe_cell_id')){
		this.render_label_and_value('trt_oe_cell_id_label', 'Over Expression Cell Lines', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_oe_cell_id', 'Cell Lines', this.model.get('trt_oe_cell_id'), 'white', '#CC79A7');
	}

	// draw the signatures for the over expression
	if (this.model.get('trt_oe_sig_id')){
		this.render_label_and_value('trt_oe_sig_id_label', 'Over Expression Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_oe_sig_id', 'Signature IDs', this.model.get('trt_oe_sig_id'), 'white', '#BDBDBD');
	}

	// draw the gold signatures for the over expression
	if (this.model.get('trt_oe_sig_id_gold')){
		this.render_label_and_value('trt_oe_sig_id_gold_label', 'Gold Signature IDs', '', true);
		this.label_y_position += 5;
		this.draw_tags('trt_oe_sig_id_gold', 'Over Expression Gold Signature IDs', this.model.get('trt_oe_sig_id_gold'), 'white', '#BDBDBD');
	}


	return this;
},

/**
 * update the dynamic potions of the view
 */
update: function(){
	this.render();
	return this;
},

/**
* utility function to draw a standard label and value for that label under the main pert_iname and
* pert_id text
* If pass_model_field_as_text is true, pass the value in model_field as text instead of serching for
* it in the model
* @param  {string}  class_name_base           base of the class name of the attribute
* @param  {string}  label_text                visible text that labels the element on screen
* @param  {string}  model_field               text to appear in the model field
* @param  {boolean} pass_model_field_as_text  determines whether the value in model_field will appear
*                                             as text (true) or if the value must be obtained by
*                                             searching (false)
* @param  {number}  x_pos_base                base position for the x_label set
* @param  {string}  value_link                if supplied, used as a link on the visible text
*/
render_label_and_value: function(class_name_base, label_text, model_field, pass_model_field_as_text, x_pos_base, value_link,increment_y){
	// set up a local variable to keep our scope straight
	var self = this;

	// make sure that we have a label_y_position set
	this.label_y_position = (this.label_y_position !== undefined) ? this.label_y_position: 100;
	if (increment_y === undefined){
		increment_y = true;
	}
	if (increment_y){
		this.label_y_position += 25;
	}


	// make sure that there is a base position for the x_label set
	var x_pos_base = (x_pos_base !== undefined) ? x_pos_base: 10;

	// update the open_height to the total height of all that we have drawn
	this.open_height = (this.options.plot_height &gt; this.label_y_position + 40) ? this.options.plot_height : this.label_y_position + 40;

	// (re)draw the label
	this.fg_layer.selectAll('.' + class_name_base + '_label_text').data([]).exit().remove();
	this.fg_layer.selectAll('.' + class_name_base + '_label_text').data([1])
						.enter()
						.append(&quot;text&quot;)
						.attr(&quot;class&quot;,class_name_base + '_label_text label_and_text')
						.attr(&quot;x&quot;,x_pos_base)
						.attr(&quot;y&quot;,this.label_y_position)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.text(label_text + ':');

	// (re)draw the text
	this.fg_layer.selectAll('.' + class_name_base + '_text').data([]).exit().remove();
	var model_text = '';
	if (pass_model_field_as_text){
		model_text = model_field;
	}else{
		model_text = this.model.get(model_field);
	}
	var x_pos = x_pos_base + this.fg_layer.selectAll('.' + class_name_base + '_label_text').node().getComputedTextLength() + 10;

	// if there is a value link supplied, use it as a link on the text, otherwise, render plain text
	if (value_link){
		this.fg_layer.selectAll('.' + class_name_base + '_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,class_name_base + '_text label_and_text')
							.attr(&quot;x&quot;,x_pos)
							.attr(&quot;y&quot;,this.label_y_position)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
							.style(&quot;cursor&quot;,&quot;pointer&quot;)
							.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
							.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;fill&quot;,&quot;#BDBDBD&quot;);})
							.on(&quot;click&quot;, function(){window.location = value_link})
							.text(model_text);
	}else{
		this.fg_layer.selectAll('.' + class_name_base + '_text').data([1])
							.enter()
							.append(&quot;text&quot;)
							.attr(&quot;class&quot;,class_name_base + '_text label_and_text')
							.attr(&quot;x&quot;,x_pos)
							.attr(&quot;y&quot;,this.label_y_position)
							.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
							.attr(&quot;font-size&quot;,&quot;14pt&quot;)
							.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
							.text(model_text);
	}
},

/**
 * utility function to break a long summary string into a multiline and draw it at the desired location
 * @param  {object} options  describes the options for drawing a string to the screen
 * arguments for options:
 * @param {string} summary_string  the string to be displayed, defaults to &quot;&quot;
 * @param {right}  right           the x position to place the right edge of text, defaults to
 *                                 this.width
 * @param {left}   left            the x position to place the left edge of text, defaults to
 *                                 this.width - 500
 * @param {top}    top             the y position to place the top edge of text, defaults to 0
 * @param {bottom} bottom          the y position to place the bottom edge of text, defaults to
 *                                 100
 */
render_summary: function(options){
	var self = this;

	// default arguments if they are not present
	summary_string = this.model.get(&quot;pert_summary&quot;);
	top_edge = (options.top !== undefined) ? options.top : 0;
	bottom_edge = (options.bottom !== undefined) ? options.bottom : 100;
	right_edge = (options.right !== undefined) ? options.right : this.width;
	left_edge = (options.left !== undefined) ? options.left : this.width - 500;

	// clear existing summary
	this.clear_summary();

	// compute the number of lines we have room for
	this.line_height = 15;
	this.num_lines_allowed = Math.floor((bottom_edge - top_edge) / this.line_height);

	// compute the number of characters per line we will allow and how
	// many lines the summary would need if we rendered all of it
	this.line_width = right_edge - left_edge;
	this.num_char = Math.floor(this.line_width / 13 / .75);
	this.num_char = (this.num_char &gt; 60) ? 60 : this.num_char;
	this.num_lines = Math.ceil(summary_string.length / this.num_char);

	// compute the line splits to display in the summary
	this.lines = [];
	for (var i=0; i&lt;this.num_lines; i++){
		if (i &lt; this.num_lines_allowed - 1){
			var l = (summary_string.slice(i*this.num_char,(i+1)*this.num_char).slice(-1) != &quot; &quot; &amp;&amp; summary_string.slice(i*this.num_char,(i+1)*this.num_char).slice(this.num_char-1,this.num_char) != &quot;&quot;) ? summary_string.slice(i*this.num_char,(i+1)*this.num_char)  + '-': summary_string.slice(i*this.num_char,(i+1)*this.num_char);
			this.lines.push(l);
		}else{
			var l = summary_string.slice(i*this.num_char,(i+1)*this.num_char - 3) + '...';
			this.lines.push(l);
			break;
		}
	}

	// draw lines
	self.fg_layer.selectAll('.' + self.div_string + 'summary_text' + i).data(this.lines)
			.enter()
			.append(&quot;text&quot;)
			.attr(&quot;class&quot;,self.div_string + &quot;summary_text&quot;)
			.attr(&quot;x&quot;,left_edge)
			.attr(&quot;y&quot;,function(d,i){return top_edge + 13 + i*15;})
			.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
			.attr(&quot;font-size&quot;,&quot;13pt&quot;)
			.attr(&quot;fill&quot;,&quot;#BDBDBD&quot;)
			// .attr(&quot;text-anchor&quot;, &quot;middle&quot;)
			.text(function(d){return d;});
},

/**
 * utility to open or close the view
 */
toggle_panel_state: function(){
	var self = this;
	var h;
	if (this.panel_open){
		h = this.options.plot_height;
		$(&quot;#&quot; + this.div_string).animate({height:h},500);
		this.panel_open = false;
		this.controls_layer.selectAll(&quot;.cevron_icon&quot;).attr(&quot;xlink:href&quot;, '//coreyflynn.github.io/Bellhop/img/down_arrow_select.png')
		this.controls_layer.selectAll('.cevron_icon').transition().duration(500).attr(&quot;y&quot;,h - 20);
	}else{
		h = this.open_height
		$(&quot;#&quot; + this.div_string).animate({height:h},500);
		this.panel_open = true;
		this.controls_layer.selectAll(&quot;.cevron_icon&quot;).attr(&quot;xlink:href&quot;, '//coreyflynn.github.io/Bellhop/img/up_arrow_select.png')
		this.controls_layer.selectAll('.cevron_icon').transition().duration(500).attr(&quot;y&quot;,h - 15);
	}
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;more_button&quot;).transition().duration(500).attr(&quot;y&quot;,h - 15);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;wiki_link&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;pubchem_link&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).transition().duration(500).attr(&quot;y&quot;,h - 20);
	this.vis.transition().duration(500).attr(&quot;height&quot;,h);
},

/**
 * utility function to draw tags given an array
 * @param  {string} class_name_base  base of the class name of the attribute
 * @param  {string} label_text       visible text that labels the element on screen
 * @param  {array}  data             array of data
 * @param  {string} fg_color         fill color of label
 * @param  {string} tag_color        color for background layer of tags 
 */
draw_tags: function(class_name_base, label_text, data, fg_color, tag_color){
	var x_offsets = [10];
	var row_number = 0;
	var y_offsets = [];
	var lengths = [];
	var tags = [];
	var self = this;
	var EmSize = Barista.getEmSizeInPixels(this.div_string);

	// draw the foreground text of all the tags
	this.fg_layer.selectAll('.' + class_name_base + 'tag_list_text').data([]).exit().remove();
	this.fg_layer.selectAll('.' + class_name_base + 'tag_list_text').data(data).enter().append('text')
		.attr(&quot;class&quot;, class_name_base + &quot;tag_list_text&quot;)
		.text(function(d){return d;})
		.attr(&quot;x&quot;,function(d,i){
			lengths.push(this.getComputedTextLength() + 15);
			var current_x_offset = x_offsets[i];
			if (current_x_offset + lengths[i] &gt; self.width){
				x_offsets[i] = 5;
				x_offsets.push(lengths[i] + x_offsets[i]);
				row_number += 1;
			}else{
				x_offsets.push(lengths[i] + x_offsets[i]);
			}
			y_offsets.push((row_number * 1.5 + 1));
			return x_offsets[i];
		})
		.attr(&quot;y&quot;,function(d,i){return self.label_y_position + y_offsets[i] * EmSize;})
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,fg_color)

	// draw the background of all the tags
	this.bg_layer.selectAll('.' + class_name_base + 'tag_list_rect').data([]).exit().remove();
	this.bg_layer.selectAll('.' + class_name_base + 'tag_list_rect').data(data).enter().append('rect')
		.attr(&quot;class&quot;, class_name_base + &quot;tag_list_rect&quot;)
		.attr(&quot;x&quot;,function(d,i){return x_offsets[i] - 5;})
		.attr(&quot;y&quot;,function(d,i){return self.label_y_position + (y_offsets[i] - 1) * EmSize;})
		.attr(&quot;rx&quot;,4)
		.attr(&quot;ry&quot;,4)
		.attr('width',function(d,i){return lengths[i] - 4;})
		.attr('height','1.2em')
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,tag_color);

	// update the label_y_position
	this.label_y_position += 10 + y_offsets.slice(-1)[0] * EmSize;

	// update the open_height to the total height of all that we have drawn
	this.open_height = (this.options.plot_height &gt; this.label_y_position + 40) ? this.options.plot_height : this.label_y_position + 40;

	return this
},

/**
 * utility function to clear the pert summary
 */
clear_summary: function(){
	this.fg_layer.selectAll('.summary_text').data([]).exit().remove();
},

/*
 * utility function to clear all of the labels and text generated with the render_label_and_value
 * function
 */
clear_label_and_text: function(){
	this.fg_layer.selectAll('.label_and_text').data([]).exit().remove();
}
});

/**
A Backbone.View that exposes a custom search bar.  The search bar provides autocomplete
functionality for Connectivity Map pert_inames and cell_ids.  When the user types in the
search view's input, a &quot;search:DidType&quot; event is fired.

@class PertSearchBar
@constructor
@extends Backbone.View
**/
Barista.Views.PertSearchBar = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;PertSearchBar&quot;,</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	var self = this;</code></pre></span>
          <div style="font-family:Roboto Slab" class="description"><p>determines wether or not the search view will match cell lines for autocomplete<br />        @property match_cell_lines<br />        @default true<br />        @type Boolean</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">// set up custom Datasets if they are passed in the constructor
this.datasets = (this.options.datasets !== undefined) ? this.options.datasets : [Barista.Datasets.CellID,Barista.Datasets.PertIName];

// determine wether or not we will match cell line strings in the autocomplete
this.match_cell_lines = (this.options.match_cell_lines !== undefined) ? this.options.match_cell_lines : true;

// custom placeholder
this.placeholder = (this.options.placeholder !== undefined) ? this.options.placeholder : 'search gene, compound or cell type name';

// grab cell_ids and store them as an atribute of the view
var cellinfo = Barista.APIURL + '/a2/cellinfo?callback=?';
var params = {q:'{&quot;cell_id&quot;:{&quot;$regex&quot;:&quot;&quot;}}',d:&quot;cell_id&quot;};
$.getJSON(cellinfo,params,function(res){
	self.cell_lines = res;
	self.render();

	// once the view is rendered, bind a change event to trigger a &quot;search:DidType&quot; event from the view
	var change_callback = function () {
		// get the value from the search bar. If the first character is '*',
		// replace it with '.*' so we use the wildcard as expected in API
		// saerches
		var val  = $(&quot;#search&quot;,self.el).val();
		val = (val[0] === '*') ? val.replace('*','.*') : val;

		var type = &quot;&quot;;
		if (self.cell_lines.indexOf(val) != -1 &amp;&amp; self.match_cell_lines){
			type = &quot;cell&quot;;
		}</code></pre></span>
          <div style="font-family:Roboto Slab" class="description"><p>Fired when the text in the view&#39;s search box changes</p><pre><code>            @event search:DidType
            @param {Object} [msg={val:&quot;&quot;,type:&quot;&quot;}] an object containing the message of the event
            @param {String} [msg.val=&quot;&quot;] the string val of the views search bar at the time of the event
            @param {String} [msg.type=&quot;&quot;] the type of message being passed, either &quot;&quot; or &quot;cell&quot;. &quot;cell&quot; is passed, if the string matches a cell line and match\_cell\_lines is set
</code></pre> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">self.trigger(&quot;search:DidType&quot;,{val: val,type: type});
			};

			$(&quot;#search&quot;,self.el).bind('input propertychange change', _.throttle(change_callback,250));

			// bind a search:DidType event to the typeahead events coming out of typeahead.js
			$(&quot;.typeahead&quot;,self.el).bind('typeahead:selected typeahead:autocompleted', function (obj,datum) {
var val = datum.value;
self.trigger(&quot;search:DidType&quot;,{val: val,type: datum.type});
			});
		});

	},</code></pre></span>
          <section id="get_val">
            <h1>get_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>get_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Gets the current text entered in the view&#39;s search bar</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">get_val: function(){
	return $(&quot;#search&quot;,this.el).val();
},</code></pre></span>
          <section id="random_val">
            <h1>random_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>random_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fills the view&#39;s search bar with a random pert_iname and triggers a &quot;search:DidType&quot; event</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">random_val: function(){
	var self = this;
	skip = Math.round(Math.random()*40000);
	var pertinfo = Barista.APIURL + '/a2/pertinfo?callback=?';
	params = {q: '{&quot;pert_type&quot;:{&quot;$in&quot;:[&quot;trt_cp&quot;,&quot;trt_sh&quot;]}}',
				f:'{&quot;pert_iname&quot;:1}',
									l:1,
									sk:skip};
	$.getJSON(pertinfo,params,function(res){
		var val = res[0].pert_iname;
		$(&quot;#search&quot;,this.el).val(val);
		self.trigger(&quot;search:DidType&quot;,{val: val,type: 'single'});
	});
},</code></pre></span>
          <section id="set_val">
            <h1>set_val</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_val()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>triggers a &quot;search:DidType&quot; event for the given search value</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>new_val</td>
                <td>string</td>
                <td><p>value to search for</p></td>
              </tr>
              <tr>
                <td>new_type</td>
                <td>string</td>
                <td><p>type of value</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_val: function(new_val,new_type){
	new_type = (new_type !== undefined) ? new_type : &quot;single&quot;;
	$(&quot;#search&quot;,this.el).val(new_val);
	this.trigger(&quot;search:DidType&quot;,{val: new_val,type: new_type});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;
	// load the template into the view's el tag
	this.$el.append(BaristaTemplates.CMapPertSearchBar({placeholder: self.placeholder}));

	$('#search',this.$el).typeahead(self.datasets);
}
});</code></pre></span>
          <section id="PlatformSummaryView">
            <h1>PlatformSummaryView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.PlatformSummaryView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A Backbone.View that shows a quick view card used to display the available data on lincscloud.org for<br />a given platform<br />he widget displays a count of the available experiments on the platform, a description of the platform,<br />a widget to extract a listing of the data available, and a link to a platform specific app for viewing<br />the contents of the available data on that platform<br />This view is frequently paired with a PlatformSummaryModel<br />basic use:<br />platform_summary_view = new PlatformSummaryView();<br />optional arguments:<br />...<br />        platform_summary_view = new PlatformSummaryView({<br />                                    ... });</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.PlatformSummaryView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;PlatformSummaryView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.GenericCountModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color and font defaults
	this.white_color = &quot;#ffffff&quot;;
	this.black_color = &quot;#000000&quot;;
	this.orange_color = &quot;#e69f00&quot;;
	this.sky_blue_color = &quot;#56b4e9&quot;;
	this.bluish_green_color = &quot;#009e73&quot;;
	this.yellow_color = &quot;#f0e442&quot;;
	this.blue_color = &quot;#0072b2&quot;;
	this.vermillion_color = &quot;#d55e00&quot;;
	this.reddish_purple_color = &quot;#cc79a7&quot;;
	this.opaque_opacity = 1;
	this.semi_opacity = 0.25;
  this.text_font_family = &quot;'Helvetica Neue',Helvetica,Arial,sans-serif&quot;;
  this.brand_font_family = &quot;'Memphis LT Std',Times,serif&quot;;
  this.navigation_font_family = &quot;Tahoma,Verdana,sans-serif&quot;;
  this.bold_font_weight = &quot;bold&quot;;
  this.medium_font_weight = &quot;medium&quot;;
  this.regular_font_weight = &quot;normal&quot;;
  this.lowercase_font_transform = &quot;lowercase&quot;;
  this.uppercase_font_transform = &quot;uppercase&quot;;
  this.sentence_font_transform = &quot;none&quot;;
  this.normal_letter_spacing = &quot;normal&quot;;
  this.wide_letter_spacing = &quot;2pt&quot;;
  this.fonts_default = {
  	  brand: {
  	  	family: this.brand_font_family,
  	  	weight: this.bold_font_weight,
  	  	size: &quot;13pt&quot;,
  	  	transform: this.uppercase_font_transform,
  	  	spacing: this.wide_letter_spacing,
  	  	color: this.black_color
  	  },
  	  control: {
  	  	family: this.text_font_family,
  	  	weight: this.regular_font_weight,
  	  	size: &quot;12pt&quot;,
  		  transform: this.lowercase_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.sky_blue_color
  	  },
  	  count: {
  	  	family: this.text_font_family,
  	  	weight: this.bold_font_weight,
  	  	size: &quot;36pt&quot;,
  		  transform: this.sentence_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  },
  	  header: {
  	  	family: this.text_font_family,
  	  	weight: this.bold_font_weight,
  	  	size: &quot;13pt&quot;,
  	  	transform: this.uppercase_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  },
  	  navigation: {
  	  	family: this.navigation_font_family,
  	  	weight: this.regular_font_weight,
  	  	size: &quot;9pt&quot;,
  	  	transform: this.sentence_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  },
  	  paragraph: {
  	  	family: this.text_font_family,
  	  	weight: this.regular_font_weight,
  	  	size: &quot;12pt&quot;,
  		  transform: this.sentence_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  },
  	  subhead: {
  	  	family: this.text_font_family,
  	  	weight: this.medium_font_weight,
  	  	size: &quot;14pt&quot;,
  		  transform: this.sentence_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  },
  	  title: {
  	  	family: this.text_font_family,
  	  	weight: this.bold_font_weight,
  	  	size: &quot;36pt&quot;,
  		  transform: this.sentence_font_transform,
  	  	spacing: this.normal_letter_spacing,
  	  	color: this.black_color
  	  }
  };

	// set up color and font appearance options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : this.white_color;
	this.fg_color = (this.options.fg_color !== undefined) ? this.options.fg_color : this.orange_color;
	this.fonts = this.fonts_default;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;col-lg-4&quot;;

	// set up static banner text, default if not specified
	this.banner_text = (this.options.banner_text !== undefined) ? this.options.banner_text : &quot;Platform&quot;;

	// set up static description text, default if not specified
	this.description_text = (this.options.description_text !== undefined) ? this.options.description_text : &quot;Platform description&quot;;

	// set up static experiments text, default if not specified
	this.experiments_text = (this.options.experiments_text !== undefined) ? this.options.experiments_text : &quot;Experiments&quot;;

	// set up the default plot height
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : 305;

	// set up the platform icon
	this.platform_icon = (this.options.platform_icon !== undefined) ? this.options.platform_icon : '//coreyflynn.github.io/Bellhop/img/cmap_logo_small.png';

	// set up static export table, default if not specified
	this.export_text = (this.options.export_text !== undefined) ? this.options.export_text : &quot;download table&quot;;
	this.exporting_text = (this.options.exporting_text !== undefined) ? this.options.exporting_text : &quot;Exporting&quot;;

	// set up static view details, default if not specified
	this.details_text = (this.options.details_text !== undefined) ? this.options.details_text : &quot;view details&quot;;
	this.details_url = (this.options.details_url !== undefined) ? this.options.details_url : &quot;//apps.lincscloud.org&quot;;
	this.details_target = (this.options.details_target !== undefined) ? this.options.details_target : &quot;_self&quot;;

	// set up default categories to display
	this.categories = (this.options.categories !== undefined) ? this.options.categories : [];
	this.category_ids = _.pluck(this.categories,'_id');

	// get categories from model and determine the maximum category count
	// this.categories = this.model.get('platform_types');
	this.max_category_count = _.max(_.pluck(this.categories,'count'));
	
	// bind render to model changes
	this.listenTo(this.model,'change', this.render);

	// compile the default template for the view
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// render the vis
	this.redraw();

	// bind window resize events to redraw.
	var self = this;
	$(window).resize(function() {self.redraw();} );
},

/**
 * use Handlebars to compile the template for the view
 */
compile_template: function(){
	this.div_string = 'd3_target' + new Date().getTime();
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},

/**
 * completely redraw the view
 */
redraw: function(){
	this.init_panel();
	this.render();
},

/**
 * applies the given font to the text at the given target
 * @param  {font}   font    font to apply
 * @param  {string} target  text target to apply font to
 */
apply_font: function(font, target) {
	return target.attr(&quot;font-family&quot;, font.family)
		.attr(&quot;font-weight&quot;, font.weight)
		.attr(&quot;font-size&quot;, font.size)
		.attr(&quot;style&quot;, &quot;text-transform: &quot; + font.transform +&quot;;&quot;)
		.attr(&quot;letter-spacing&quot;, font.spacing)
		.attr(&quot;fill&quot;, font.color);
},
/**
 * converts the attributes of a font object to a string of css text
 * @param  {font} font  font object
 */
font_to_css_style: function(font) {
	return &quot;font:&quot;+ font.weight +&quot; &quot; + font.size + &quot; &quot; + font.family + &quot;; &quot;
		+ &quot;color:&quot; + font.color + &quot;; &quot; 
		+ &quot;text-transform:&quot; + font.transform + &quot;; &quot; 
		+ &quot;letter-spacing:&quot; + font.spacing + &quot;; &quot;;
},

/**
 * initialize the static parts of the view's panel
 */
init_panel: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	
	// set up component row positioning
	this.hrule0 = 60;
	this.hrule1 = this.hrule0 + 30;
	this.hrule2 = this.hrule1 + 30;
	this.hrule3 = this.hrule2 + 120;
	this.hrule4 = this.hrule3 + 30;
	this.hrule5 = this.hrule4 + 25;

	// rescale the width of the vis
	this.vis.transition().duration(1).attr(&quot;width&quot;,this.width);

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	this.vis.selectAll('.controls_layer').data([]).exit().remove();
	this.controls_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;controls_layer&quot;);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// draw the banner
	this.fg_layer.selectAll('.banner').data([]).exit().remove();
	var banner = this.fg_layer.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;banner&quot;);
	banner.selectAll('.banner_rect').data([]).exit().remove();
	banner.append(&quot;rect&quot;).attr(&quot;class&quot;, &quot;banner_rect&quot;)
		.attr(&quot;width&quot;, this.width)
		.attr(&quot;height&quot;, this.hrule1)
		.attr(&quot;fill&quot;, this.fg_color);
	banner.selectAll('.banner_text').data([]).exit().remove();
	var bt = this.apply_font(this.fonts.title, banner.selectAll('.banner_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;banner_text&quot;)
						.attr(&quot;y&quot;,this.hrule0)
						.text(this.banner_text));
    // center the banner text
	bt.each(function() {
		var text_width = this.getBBox().width;
		var start_pos = (self.width - text_width) / 2;
		bt.attr(&quot;x&quot;, start_pos);
	});

	// draw the description text
	this.render_description({
		description_string: this.description_text,
		left: 150,
		top: this.hrule2,
		bottom: this.height,
		node_class: 'description_text'
	});
	
	// draw the generic count info
	var count = this.model.get('count');
	if (count === undefined){
		count = 0;
	}
	var count_text = this.fg_layer.selectAll('.count').data([]).exit().remove();
	count_text = this.apply_font(this.fonts.count, this.fg_layer.selectAll('.count').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;count&quot;)
						.attr(&quot;x&quot;,40)
						.attr(&quot;y&quot;,this.hrule3)
						.text(count));
	
	// draw the experiments text
	this.fg_layer.selectAll('.experiments_text').data([]).exit().remove();
	this.apply_font(this.fonts.header, this.fg_layer.selectAll('.experiments_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;experiments_text&quot;)
						.attr(&quot;x&quot;,40)
						.attr(&quot;y&quot;,this.hrule4)
						.text(this.experiments_text));

	// draw the static platform icon
	this.fg_layer.selectAll('.platform_icon').data([]).exit().remove();
	this.fg_layer.selectAll('.platform_icon').data([1])
						.enter().append(&quot;svg:image&quot;)
						.attr(&quot;class&quot;,&quot;platform_icon&quot;)
		        .attr(&quot;xlink:href&quot;, this.platform_icon)
						.attr(&quot;x&quot;,40)
						.attr(&quot;y&quot;,this.hrule2)
						.attr(&quot;height&quot;,60)
						.attr(&quot;width&quot;,60);

	// add a png export overlay
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
	.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
	.attr(&quot;x&quot;,40)
	.attr(&quot;y&quot;,this.hrule5)
	.attr(&quot;opacity&quot;,self.semi_opacity)
	.style(&quot;cursor&quot;,&quot;pointer&quot;)
	.text(&quot;png&quot;)
	.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,self.opaque_opacity).attr(&quot;fill&quot;,self.sky_blue_color);})
	.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,self.semi_opacity).attr(&quot;fill&quot;,self.black_color);})
	.on(&quot;click&quot;,function(){self.save_png();});

	// css inline styling, this value can have single quotes in it, so use double-quotes to apply it
	this.control_css_style = &quot;text-decoration:none; &quot;+this.font_to_css_style(this.fonts.control);
	
	// determine control positioning based on display size
	this.details_x = this.width - 135;
	this.details_y = this.hrule4 - 15; // 15 is a hack adjusting for line height
	this.export_x = this.width - 270;
	this.export_y = this.details_y;
	if (this.export_x &lt; 180) {
		// move the export above the details
		this.export_x = this.details_x;
		this.export_y = this.details_y - 30;
	}
	
	// add the export table control
	this.render_export_control(this.export_text, &quot;icon-download&quot;, function(){self.download_table();});

	// add the view details control
	this.controls_layer.selectAll('.details_text').data([]).exit().remove();
	this.controls_layer.selectAll('.details_text').data([1])
						.enter().append(&quot;foreignObject&quot;)
						.attr(&quot;class&quot;,&quot;details_text&quot;)
						.attr(&quot;width&quot;, 110)
						.attr(&quot;height&quot;, 110)
						.attr(&quot;x&quot;, this.details_x)
						.attr(&quot;y&quot;, this.details_y)
						.style(&quot;cursor&quot;,&quot;pointer&quot;)
						.append(&quot;xhtml:body&quot;)
						.style(&quot;background-color&quot;, this.bg_color)
						.html(&quot;&lt;a href='&quot;+this.details_url+&quot;' target='&quot;+this.details_target+&quot;' style=\&quot;&quot; + this.control_css_style + &quot;\&quot;&gt;&lt;i class='icon-chevron-sign-right'&gt;&lt;/i&gt; &quot;+this.details_text+&quot;&lt;/a&gt;&quot;);
},</code></pre></span>
          <section id="render_export_control">
            <h1>render_export_control</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render_export_control()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>creates the render control object and draws it to the screen</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>message</td>
                <td>string</td>
                <td><p>visible text</p></td>
              </tr>
              <tr>
                <td>icon_class</td>
                <td>string</td>
                <td><p>value of the class attribute</p></td>
              </tr>
              <tr>
                <td>handler</td>
                <td>function</td>
                <td><p>function associated with click</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render_export_control: function(message, icon_class, handler) {
	this.controls_layer.selectAll('.export_text').data([]).exit().remove();
	return this.controls_layer.selectAll('.export_text').data([1])
						.enter().append(&quot;foreignObject&quot;)
						.attr(&quot;class&quot;,&quot;export_text&quot;)
						.attr(&quot;width&quot;, 130)
						.attr(&quot;height&quot;, 100)
						.attr(&quot;x&quot;, this.export_x)
						.attr(&quot;y&quot;, this.export_y)
						.style(&quot;cursor&quot;,&quot;pointer&quot;)
						.on(&quot;click&quot;,handler)
						.append(&quot;xhtml:body&quot;)
						.style(&quot;background-color&quot;, this.bg_color)
						.html(&quot;&lt;span style=\&quot;&quot; + this.control_css_style + &quot;\&quot;&gt;&lt;i class='&quot; + icon_class + &quot;' style='margin-right:2px;'&gt;&lt;/i&gt;&quot; + message + &quot;&lt;/span&gt;&quot;);
},</code></pre></span>
          <section id="download_table">
            <h1>download_table</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>download_table()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>download the backing data that matches the current model state</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">download_table: function() {
	var self = this;

	// indicate that we are downloading something
	this.render_export_control(this.exporting_text, &quot;icon-refresh icon-spin&quot;, null);
	

	// set up api call parameters
	var url = this.model.get(&quot;url&quot;);
	var params = {q: '{&quot;' + this.model.get(&quot;search_field&quot;) + '&quot;:{&quot;$regex&quot;:&quot;' + this.model.get(&quot;search_string&quot;) + '&quot;,&quot;$options&quot;:&quot;i&quot;}}',
            l:0};

        // make a JSON API call to grab data for the table
	$.getJSON(url,params,function(res){
		// get the headers for the table we are going to write out
		var headers = _.keys(res[0]);

		// We are going to write a one line in the table for each object returned by the API
		// call.  Start by putting the headers in and then write each object to the table
		var lines = [headers.join('\t')];
		res.forEach(function(r){
			var line_data = [];
			// for each data name in the table, grab the data. translate html
			// content to plain text where required
			headers.forEach(function(h){
					line_data.push(String(r[h]));
			});
			line_string = line_data.join('\t');
			lines.push(line_string);
		});
		var lines_string = lines.join(&quot;\n&quot;);
		var blob = new Blob([lines_string], {type: &quot;text/plain;charset=utf-8&quot;});
		var timestamp = new Date().getTime();
		saveAs(blob, &quot;CMapTable&quot; + timestamp + &quot;.txt&quot;);

		// indicate that we are done
		self.render_export_control(self.export_text, &quot;icon-download&quot;, function(){self.download_table();});
	});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();

	// draw the pert count info
	var count = this.model.get('count');
	if (count === undefined){
		count = 0;
	}
	this.vis.selectAll('.count').data([1])
		.transition().duration(500)
		.tween(&quot;text&quot;, function() {
		    var i = d3.interpolate(this.textContent.replace(&quot;,&quot;,&quot;&quot;), count);
		    return function(t) {
		      this.textContent = Barista.numberWithCommas(Math.round(i(t)))	;
		    };
		});

},</code></pre></span>
          <section id="render_description">
            <h1>render_description</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render_description()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to break a long description string into a multiline and draw it at the desired<br />location</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>options</td>
                <td>object</td>
                <td><p>describes the options for drawing a string to the screen arguments for options:</p></td>
              </tr>
              <tr>
                <td>description_string</td>
                <td>string</td>
                <td><p>the string to be displayed, defaults to &quot;&quot;</p></td>
              </tr>
              <tr>
                <td>right</td>
                <td>right</td>
                <td><p>the x position to place the right edge of text, defaults                                         to this.width</p></td>
              </tr>
              <tr>
                <td>left</td>
                <td>left</td>
                <td><p>the x position to place the left edge of text, defaults                                         to this.width - 500</p></td>
              </tr>
              <tr>
                <td>top</td>
                <td>top</td>
                <td><p>the y position to place the top edge of text, defaults to 0</p></td>
              </tr>
              <tr>
                <td>bottom</td>
                <td>bottom</td>
                <td><p>the y position to place the <strong>bottom</strong> edge of text,                                         defaults to 100</p></td>
              </tr>
              <tr>
                <td>node_class</td>
                <td>node_class</td>
                <td><p>the class used for locating the text node within fg_layer,                                         defaults to &quot;&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render_description: function(options){
	var self = this;

	// default arguments if they are not present
	description_string = (options.description_string !== undefined) ? options.description_string : &quot;&quot;;
	top_edge = (options.top !== undefined) ? options.top : 0;
	bottom_edge = (options.bottom !== undefined) ? options.bottom : 100;
	right_edge = (options.right !== undefined) ? options.right : this.width;
	left_edge = (options.left !== undefined) ? options.left : this.width - 500;
	node_class = (options.node_class != undefined) ? options.node_class : &quot;&quot;;
    node_class_selector = '.' + node_class;
    
	// clear existing description
	this.fg_layer.selectAll(node_class_selector).data([]).exit().remove();

	// compute the number of lines we have room for
	this.line_height = 15;
	// if the layout is small we can't have more than 5 lines or descriptions collide with the count
	this.num_lines_allowed = Math.min(5, Math.floor((bottom_edge - top_edge) / this.line_height));

	// compute the number of characters per line we will allow and how
	// many lines the description would need if we rendered all of it
	this.line_width = right_edge - left_edge;
	// 12 pt font
	this.num_char = Math.floor(this.line_width / 12 / .65);
	this.num_lines = Math.ceil(description_string.length / this.num_char);

	// compute the line splits to display in the description
	this.lines = [];
	for (var i=0; i&lt;this.num_lines; i++){
		if (i &lt; this.num_lines_allowed - 1){
			var l = (description_string.slice(i*this.num_char,(i+1)*this.num_char).slice(-1) != &quot; &quot; &amp;&amp; description_string.slice(i*this.num_char,(i+1)*this.num_char).slice(this.num_char-1,this.num_char) != &quot;&quot;) ? description_string.slice(i*this.num_char,(i+1)*this.num_char)  + '-': description_string.slice(i*this.num_char,(i+1)*this.num_char);
			this.lines.push(l);
		} else {
			var l = description_string.slice(i*this.num_char,(i+1)*this.num_char - 3) + '...';
			this.lines.push(l);
			// note: the class that had the original line-splitting code does not have this break, and that may be a bug
			break;
		}
	}

	// draw lines
	this.apply_font(this.fonts.paragraph, self.fg_layer.selectAll(node_class_selector).data(this.lines)
			.enter()
			.append(&quot;text&quot;)
			.attr(&quot;class&quot;,node_class)
			.attr(&quot;x&quot;,left_edge)
			.attr(&quot;y&quot;,function(d,i){return top_edge + 13 + i*15;})
			// .attr(&quot;text-anchor&quot;, &quot;middle&quot;)
			.text(function(d){return d;}));
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	// build a canvas element to store the image temporarily while we save it
	var width = this.width;
	var height = this.height;
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// temporarily fix content to work around canvg rendering problems
	this.fg_layer.selectAll('.platform_icon').data([]).exit().remove();
	this.render_description({
		description_string: this.description_text,
		left: 40,
		top: this.hrule2,
		bottom: this.height,
		node_class: 'description_text'
	});
	
	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	
	// restore content
	this.fg_layer.selectAll('.platform_icon').data([1])
		.enter().append(&quot;svg:image&quot;)
		.attr(&quot;class&quot;,&quot;platform_icon&quot;)
    .attr(&quot;xlink:href&quot;, this.platform_icon)
		.attr(&quot;x&quot;,40)
		.attr(&quot;y&quot;,this.hrule2)
		.attr(&quot;height&quot;,60)
		.attr(&quot;width&quot;,60);
	this.render_description({
		description_string: this.description_text,
		left: 150,
		top: this.hrule2,
		bottom: this.height,
		node_class: 'description_text'
	});

	// render to the canvas
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;BaristaPlatformSummaryView&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){
		canvas.toBlob(function(blob){
			saveAs(blob,filename);
			});
	}
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}
});</code></pre></span>
          <section id="ScatterPlotView">
            <h1>ScatterPlotView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.ScatterPlotView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>scatter_plot_view = new ScatterPlotView({el: $(&quot;target_selector&quot;,<br />                                    bg_color:&quot;#ffffff&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;span4&quot;,<br />                                    scale_by: undefined,<br />                                    x_range: undefined,<br />                                    y_range: undefined,<br />                                    x_log: false,<br />                                    y_log: false,<br />                                    x_min_lock: undefined,<br />                                    y_min_lock: undefined,<br />                                    x_max_lock: undefined,<br />                                    y_max_lock: undefined,<br />                                    x_min_expand: false,<br />                                    y_min_expand: false,<br />                                    x_max_expand: false,<br />                                    y_max_expand: false,<br />                                    plot_height: 120});</p><p>A Backbone.View that displays a scatter plot<br />the view&#39;s model is assumed to have the same defaults as specified in ScatterPlotModel<br />basic use:<br />scatter_plot_view = new ScatterPlotView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                                #ffffff</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults                                to #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                                &quot;span12&quot;</p></td>
              </tr>
              <tr>
                <td>scale_by</td>
                <td>string</td>
                <td><p>an attribute in the model&#39;s meta data object to scale points by, defaults                                to undefined</p></td>
              </tr>
              <tr>
                <td>x_range</td>
                <td>array</td>
                <td><p>a two element array specifying the x plotting bounds of the plot,                                defaults to [min(x_data),max(x_data)]</p></td>
              </tr>
              <tr>
                <td>y_range</td>
                <td>array</td>
                <td><p>a two element array specifying the y plotting bounds of the plot,                                defaults to [min(y_data),max(y_data)]</p></td>
              </tr>
              <tr>
                <td>x_log</td>
                <td>boolean</td>
                <td><p>if set to true, plots the x axis on a log scale, defaults to false</p></td>
              </tr>
              <tr>
                <td>y_log</td>
                <td>boolean</td>
                <td><p>if set to true, plots the y axis on a log scale, defaults to false</p></td>
              </tr>
              <tr>
                <td>x_min_lock</td>
                <td>number</td>
                <td><p>if set, locks the minimum of the x_range at the given value. Ignored if                                x_range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>y_min_lock</td>
                <td>number</td>
                <td><p>if set, locks the minimum of the y_range at the given value. Ignored if                                y_range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>x_max_lock</td>
                <td>number</td>
                <td><p>if set, locks the maximum of the x_range at the given value. Ignored if                                x_range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>y_max_lock</td>
                <td>number</td>
                <td><p>if set, locks the maximum of the y_range at the given value. Ignored if                                y_range is set. defaults to undefined</p></td>
              </tr>
              <tr>
                <td>x_min_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the minimum of the x_range to expand if data is found                                below it. defaults to false</p></td>
              </tr>
              <tr>
                <td>y_min_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the minimum of the y_range to expand if data is found                                below it. defaults to false</p></td>
              </tr>
              <tr>
                <td>x_max_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the maximum of the x_range to expand if data is found                                above it. defaults to false</p></td>
              </tr>
              <tr>
                <td>y_max_expand</td>
                <td>boolean</td>
                <td><p>if set, allows the maximum of the y_range to expand if data is found                                above it. defaults to false</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the plot in pixels, defaults to 120</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.ScatterPlotView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.ScatterPlotModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>override the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up x and y range and determine if are going to draw the axes dynamically
	this.x_range = (this.options.x_range !== undefined) ? this.options.x_range : undefined;
	this.y_range = (this.options.y_range !== undefined) ? this.options.y_range : undefined;
	this.dynamic_x_range = (this.x_range === undefined) ? true : false;
	this.dynamic_y_range = (this.y_range === undefined) ? true : false;

	// set up axis expansion and lock features
	this.x_min_lock = (this.options.x_min_lock !== undefined) ? this.options.x_min_lock : undefined;
	this.y_min_lock = (this.options.y_min_lock !== undefined) ? this.options.y_min_lock : undefined;
	this.x_max_lock = (this.options.x_max_lock !== undefined) ? this.options.x_max_lock : undefined;
	this.y_max_lock = (this.options.y_max_lock !== undefined) ? this.options.y_max_lock : undefined;

	this.x_min_expand = (this.options.x_min_expand !== undefined) ? this.options.x_min_expand : undefined;
	this.y_min_expand = (this.options.y_min_expand !== undefined) ? this.options.y_min_expand : undefined;
	this.x_max_expand = (this.options.x_max_expand !== undefined) ? this.options.x_max_expand : undefined;
	this.y_max_expand = (this.options.y_max_expand !== undefined) ? this.options.y_max_expand : undefined;

	// set up x and y log flags
	this.x_log = (this.options.x_log !== undefined) ? this.options.x_log : false;
	this.y_log = (this.options.y_log !== undefined) ? this.options.y_log : false;

	// set up the scale_by parameter
	this.scale_by = (this.options.scale_by !== undefined) ? this.options.scale_by : undefined;

	// set up the margin
	this.margin = 50;

	// set up x and y ranges
	this.set_ranges();

	// set up x and y scaling
	this.set_scales();		

	// build Axes
	this.build_axes();

	// run BaristaBaseView's base_initialize method to handle boilerplate view construction
	// and initial view rendering
	this.base_initialize();
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely redraw the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	this.base_render();
	this.init_plot();
	this.update();
},</code></pre></span>
          <section id="init_plot">
            <h1>init_plot</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_plot()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_plot: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up x and y ranges
	this.set_ranges();

	// set up x and y scaling
	this.set_scales();		

	// build Axes
	this.build_axes();

	// plot the axes
	this.bg_layer.selectAll('.axis').data([]).exit().remove();
	this.bg_layer.append(&quot;g&quot;)
		.attr(&quot;class&quot;, &quot;axis x-axis&quot;)
		.attr(&quot;transform&quot;, &quot;translate(0,&quot; + (this.height - this.margin) + &quot;)&quot;)
		.call(this.xAxis);

	this.bg_layer.append(&quot;g&quot;)
		.attr(&quot;class&quot;, &quot;axis y-axis&quot;)
		.attr(&quot;transform&quot;, &quot;translate(&quot; + this.margin + &quot;,0)&quot;)
		.call(this.yAxis);

	// style the axes
	this.vis.selectAll('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);

	// build a scaling function
	this.set_scaling_function();

	// plot the data points
	this.x_data = this.model.get('x_data');
	this.y_data = this.model.get('y_data');
	this.bg_layer.selectAll('.data_point').data([]).exit().remove();
	this.bg_layer.selectAll('.data_point').data(this.x_data).enter().append('circle')
		.attr(&quot;class&quot;,&quot;data_point&quot;)
		.attr(&quot;cx&quot;,this.x_scale(0))
		.attr(&quot;cy&quot;,this.y_scale(0))
		.attr(&quot;opacity&quot;,0.5)
		.attr(&quot;r&quot;,0)
		.attr(&quot;fill&quot;,this.fg_color);

	// plot the x axis title
	this.bg_layer.selectAll('.x_axis_label').data([]).exit().remove();
	this.bg_layer.selectAll('.x_axis_label').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;x_axis_label axis_label&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.height-10)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('x_axis_title'));

	// plot the y axis label
	this.bg_layer.selectAll('.y_axis_label').data([]).exit().remove();
	this.bg_layer.selectAll('.y_axis_label').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;y_axis_label axis_label&quot;)
		// .attr(&quot;transform&quot;, &quot;rotate(-90)&quot;)
		.attr(&quot;y&quot;, this.margin)
		.attr(&quot;x&quot;, this.margin + 2)
		.attr(&quot;dy&quot;,&quot;1em&quot;)
		.style(&quot;text-anchor&quot;,&quot;left&quot;)
		.text(this.model.get('y_axis_title'));

	// plot the title
	this.bg_layer.selectAll('.title').data([]).exit().remove();
	this.bg_layer.selectAll('.title').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;title title&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.margin/2)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('title'));
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
var self = this;

// get model data
this.x_data = this.model.get('x_data');
this.y_data = this.model.get('y_data');

// set up x and y ranges
this.set_ranges();

// set up x and y scaling
this.set_scales();

// build Axes
this.build_axes();

// build a scaling function
this.set_scaling_function();

// plot the data points, appending where required
this.points_selection = this.bg_layer.selectAll('.data_point').data(this.x_data);
this.points_selection.enter().append('circle')
	.attr(&quot;class&quot;,&quot;data_point&quot;)
	.attr(&quot;cx&quot;,this.x_scale(0))
	.attr(&quot;cy&quot;,this.y_scale(0))
	.attr(&quot;opacity&quot;,0.5)
	.attr(&quot;r&quot;,0)
	.attr(&quot;fill&quot;,this.fg_color);

// transition points
this.points_selection.transition().duration(500)
	.attr(&quot;cx&quot;,this.x_scale)
	.attr(&quot;cy&quot;,function(d,i){return self.y_scale(self.y_data[i]);})
	.attr(&quot;r&quot;,function(d,i){
	if (self.scale_by === undefined){
		return 10;
	}else{
		return self.dot_scaler(self.scale_data[i]);
	}});

// remove excess points 
this.points_selection.exit().remove();

// transition the axes
this.vis.selectAll('.x-axis').transition().duration(500).call(this.xAxis);
this.vis.selectAll('.y-axis').transition().duration(500).call(this.yAxis);
this.style_axes();
},</code></pre></span>
          <section id="set_ranges">
            <h1>set_ranges</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_ranges()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to get the x and y ranges used in the plot</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_ranges: function(){
	var x_data,y_data,min,max;
	// calculate the x_range. If we need to caluclate it dynamically, check the lock and expand
	// parameters for the axis
	if (this.dynamic_x_range === true){
		x_data = this.model.get('x_data');

		// if the data is of length larger than 1, calculate the range, otherwise set the range to [0,0]
		if (x_data.length &gt; 0 ){
			// check the min lock and expand flags and report the min of the range accordingly
			if (this.x_min_lock === undefined){
				min = _.min(x_data);
			}else{
				if (this.x_min_expand){
					data_min = _.min(x_data);
					min = (this.x_min_lock &gt; data_min) ? data_min : this.x_min_lock;
				}else{
					min = this.x_min_lock;
				}
			}

			// check the max lock and expand flags and report the max of the range accordingly
			if (this.x_max_lock === undefined){
				max = _.max(x_data);
			}else{
				if (this.x_max_expand){
					data_max = _.max(x_data);
					max = (this.x_max_lock &lt; data_max) ? data_max : this.x_max_lock;
				}else{
					max = this.x_max_lock;
				}
			}
			this.x_range = [min,max];
		}else{
			this.x_range = [0,0];
		}
	}

	// calculate the y_range. If we need to caluclate it dynamically, check the lock and expand
	// parameters for the axis
	if (this.dynamic_y_range === true){
		y_data = this.model.get('y_data');

		// if the data is of length larger than 1, calculate the range, otherwise set the range to [0,0]
		if (y_data.length &gt; 0 ){
			// check the min lock and expand flags and report the min of the range accordingly
			if (this.y_min_lock === undefined){
				min = _.min(y_data);
			}else{
				if (this.y_min_expand){
					data_min = _.min(y_data);
					min = (this.y_min_lock &gt; data_min) ? data_min : this.y_min_lock;
				}else{
					min = this.y_min_lock;
				}
			}

			// check the max lock and expand flags and report the max of the range accordingly
			if (this.y_max_lock === undefined){
				max = _.max(y_data);
			}else{
				if (this.y_max_expand){
					data_max = _.max(y_data);
					max = (this.y_max_lock &lt; data_max) ? data_max : this.y_max_lock;
				}else{
					max = this.y_max_lock;
				}
			}
			this.y_range = [min,max];
		}else{
			this.y_range = [0,0];
		}
	}
},</code></pre></span>
          <section id="set_scales">
            <h1>set_scales</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_scales()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to get the x and y scales used in the plot</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_scales: function(){
	if (this.x_log){
		this.x_scale=d3.scale.log().domain([this.x_range[0],this.x_range[1]]).range([this.margin, this.width - this.margin]);
	}else{
		this.x_scale=d3.scale.linear().domain([this.x_range[0],this.x_range[1]]).range([this.margin, this.width - this.margin]);
	}
	if (this.y_log){
		this.y_scale=d3.scale.log().domain([this.y_range[1],this.y_range[0]]).range([this.margin, this.height - this.margin]);
	}else{
		this.y_scale=d3.scale.linear().domain([this.y_range[1],this.y_range[0]]).range([this.margin, this.height - this.margin]);
	}
},</code></pre></span>
          <section id="build_axes">
            <h1>build_axes</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>build_axes()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function used to build x and y axes</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">build_axes: function(){
	this.xAxis = d3.svg.axis()
		.scale(this.x_scale)
		.orient(&quot;bottom&quot;);
	this.yAxis = d3.svg.axis()
		.scale(this.y_scale)
		.orient(&quot;left&quot;);
},</code></pre></span>
          <section id="set_scaling_function">
            <h1>set_scaling_function</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>set_scaling_function()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to compute a radius scaling funciton to use in plots</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">set_scaling_function: function(){
	var self = this;
	if (this.scale_by !== undefined){
		this.scale_data = this.model.get('meta_data')[this.scale_by];
		var size_min = Math.sqrt(_.min(this.scale_data)/Math.PI);
		var size_max = Math.sqrt(_.max(this.scale_data)/Math.PI);
		this.size_scale=d3.scale.linear().domain([size_min,size_max]).range([5, 20]);
		this.dot_scaler = function(val){
			r = Math.sqrt(val/Math.PI);
			return self.size_scale(r);
		};
	}
},</code></pre></span>
          <section id="style_axes">
            <h1>style_axes</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>style_axes()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to apply custom styles to axis components</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">style_axes: function(){
	this.vis.selectAll('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);
}
});</code></pre></span>
          <section id="TagListView">
            <h1>TagListView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.TagListView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>tag_list_view = new TagListView({el: $(&quot;target_selector&quot;,<br />                                    bg_color:&quot;#ffffff&quot;,<br />                                    fg_color: &quot;white&quot;,<br />                                    tag_color: &quot;gray&quot;,<br />                                    span_class: &quot;col-lg-12&quot;,<br />                                    plot_height: 120,<br />                                    display_attribute: &quot;cid&quot;});</p><p>A Backbone.View that displays a list of objects in a collection as tags<br />The tags are drawn as rounded rectangles with text inside<br />The text corresponds to the cid attributes in the collection by defaul, but can be customized to display<br />other fields if required<br />basic use:<br />tag_list_view = new TagListView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                                #ffffff</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults                                to white</p></td>
              </tr>
              <tr>
                <td>tag_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the tag color of the view, defaults to gray</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                                &quot;col-lg-12&quot;</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the plot in pixels, defaults to 120</p></td>
              </tr>
              <tr>
                <td>display_field</td>
                <td>string</td>
                <td><p>the model attribute to display for each model in the view&#39;s colleciton.                                defualts to &#39;cid&#39;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.TagListView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;TagListView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set of the default model for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Backbone.Model(),</code></pre></span>
          <section id="collection">
            <h1>collection</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>collection</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up a default collection for the view to work with</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">collection: new Backbone.Collection(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// initialize the base view
	this.base_initialize();

	// set up a display attribute
	this.display_attribute = (this.options.display_attribute !== undefined) ? this.options.display_attribute : 'cid';

	// set up a tag color to use
	this.tag_color = (this.options.tag_color !== undefined) ? this.options.tag_color : 'black';

	// look for custom listeners
	this.listener = (this.options.listener !== undefined) ? this.options.listener : undefined;

	this.listener = (this.options.listener !== undefined) ? this.options.listener : undefined;

	// clear built in listeners
	this.stopListening();

	// add listeners for the collection and trigger an update when it changes
	if (this.listener !== undefined){
		this.listenTo(this.collection,this.listener, this.update);
	}else{
		this.listenTo(this.collection,'add', this.update);
		this.listenTo(this.collection,'remove', this.update);
		this.listenTo(this.collection,'reset', this.update);
		this.listenTo(this.collection,'sort', this.update);
	}
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	var self = this;
	// call BaristaBaseView's render function first so we can layer on top of it
	this.base_render();

	// add a text element for each unique item in the collection
	this.x_offsets = [5];
	this.row_number = 0;
	this.y_offsets = [];
	this.lengths = [];
	this.tags = [];
	this.collection.models.forEach(function(model){
		self.tags.push(model.get(self.display_attribute));
	});
	this.tags = _.unique(this.tags);
	this.draw_tags();

	return this;
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
	var self = this;
	// call BaristaBaseView's render function first so we can layer on top of it
	this.base_render();

	// add a text element for each unique item in the collection
	this.x_offsets = [5];
	this.row_number = 0;
	this.y_offsets = [];
	this.lengths = [];
	this.tags = [];
	this.collection.models.forEach(function(model){
		self.tags.push(model.get(self.display_attribute));
	});
	this.tags = _.unique(this.tags);
	this.draw_tags();

	return this;
},</code></pre></span>
          <section id="fit_height">
            <h1>fit_height</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>fit_height()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>fits the view height to the height taken by the tags displayed</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">fit_height: function(){
	// set the view's height attribute based on the number of rows in the
	// vis
	var EmSize = Barista.getEmSizeInPixels(this.div_string);
	this.height = (this.row_number * 1.5 + 3.5) * EmSize;

	// rescale the height of the vis
	$(&quot;#&quot; + this.div_string).animate({height:this.height},500);
	this.vis.transition().attr(&quot;height&quot;,this.height);
	this.controls_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1])
		.transition(500)
		.attr(&quot;y&quot;,this.height - 10);

},</code></pre></span>
          <section id="draw_tags">
            <h1>draw_tags</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>draw_tags()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>utility function to draw tags diven a data set</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">draw_tags: function(){
	var self = this;
	// draw the foreground text of all the tags
	this.fg_layer.selectAll('.tag_list_text').data([]).exit().remove();
	this.fg_layer.selectAll('.tag_list_text').data(this.tags).enter().append('text')
		.attr(&quot;class&quot;,&quot;tag_list_text&quot;)
		.text(function(d){return d;})
		.attr(&quot;x&quot;,function(d,i){
			self.lengths.push(this.getComputedTextLength() + 15);
			var current_x_offset = self.x_offsets[i];
			if (current_x_offset + self.lengths[i] &gt; self.width){
				self.x_offsets[i] = 5;
				self.x_offsets.push(self.lengths[i] + self.x_offsets[i]);
				self.row_number += 1;
			}else{
				self.x_offsets.push(self.lengths[i] + self.x_offsets[i]);
			}
			self.y_offsets.push((self.row_number * 1.5 + 1));
			return self.x_offsets[i];
		})
		.attr(&quot;y&quot;,function(d,i){return self.y_offsets[i] + 'em';})
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,this.fg_color)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.on(&quot;click&quot;,function(d){self.trigger(&quot;TagListView:DidSelect&quot;,{val: d});});

	// draw the background of all the tags
	this.bg_layer.selectAll('.tag_list_rect').data([]).exit().remove();
	this.bg_layer.selectAll('.tag_list_rect').data(this.tags).enter().append('rect')
		.attr(&quot;class&quot;,&quot;tag_list_rect&quot;)
		.attr(&quot;x&quot;,function(d,i){return self.x_offsets[i] - 5;})
		.attr(&quot;y&quot;,function(d,i){return (self.y_offsets[i] - 1) + 'em';})
		.attr(&quot;rx&quot;,4)
		.attr(&quot;ry&quot;,4)
		.attr('width',function(d,i){return self.lengths[i] - 4;})
		.attr('height','1.2em')
		.attr(&quot;opacity&quot;,1)
		.attr(&quot;fill&quot;,this.tag_color);
	this.fit_height();

	return this
}
});</code></pre></span>
          <section id="TickView">
            <h1>TickView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.TickView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>tick_view = new TickView({el: $(&quot;target_selector&quot;),<br />                                                model: new CMapTickModel({data:{PC3: [.23,-.28], MCF7: [-0.6]}, title: &quot;example data&quot;}),<br />                                                template: &quot;../templates/d3_target.handlebars&quot;,<br />                                                bg_color: &quot;#bdbdbd&quot;,<br />                                                span_class: &quot;span12&quot;<br />                                                });</p><p>A Backbone.View that displays a Connectivity Map tick view<br />The view is must be paired with a CMapTickModel that describes the rows to display in the tick view and<br />the scores of the ticks to show for each row<br />An example input data object from a CMapTickModel might looks like this:<br />{PC3: [.23,-.28], MCF7: [-0.6]}<br />The view will render a row for each key in the data object and a tick for each entry in the array values<br />for each row<br />The view also renders a title based on the model&#39;s title attribute<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>template</td>
                <td>string</td>
                <td><p>The path to a handlebars template to use. Defaults to                             ../templates/d3_target.handlebars</p></td>
              </tr>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                             #bdbdbd</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to &quot;span12&quot; example usage:</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.TickView = Backbone.View.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;TickView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.TickModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the defualt Backbone.View initialize method to bind the view to model changes, bind window<br />resize events to view re-draws, compile the template, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up color options.  default if not specified
	this.bg_color = (this.options.bg_color !== undefined) ? this.options.bg_color : &quot;#eeeeee&quot;;
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;#span12&quot;;
	this.template = (this.options.template !== undefined) ? this.options.template : &quot;../templates/d3_target.handlebars&quot;;

	// bind render to model changes
	this.listenTo(this.model,'change', this.redraw);

	// compile the default template for the view and draw it for the first time
	this.compile_template_and_draw();

	// bind window resize events to redraw
	var self = this;
	$(window).resize(function() {self.redraw();} );
},</code></pre></span>
          <section id="compile_template_and_draw">
            <h1>compile_template_and_draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template_and_draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view and draw it for the first time<br />tick_view.compile_template_and_draw();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template_and_draw: function(){
	var self = this;
	this.isCompiling = true;
	this.div_string = 'd3_target' + new Date().getTime();;
	this.compiled_template = BaristaTemplates.d3_target;
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class}));

	// define the location where d3 will build its plot
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	this.isCompiling = false;
	// draw the plot for the first time
	this.redraw();
},</code></pre></span>
          <section id="redraw">
            <h1>redraw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>redraw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>perform a full redraw of the view, including wiping out all d3 drawn components in the view and<br />initializing them again from scratch<br />tick_view.redraw();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">redraw: function(){
	var self = this;
	// set up the panel's width and height via animation
	this.width = $(&quot;#&quot; + this.div_string).width();
	$(&quot;#&quot; + this.div_string).animate({height:_.keys(this.model.get('data_object')).length*18 + 50},500);

	// once the height is determined, render the view
	setTimeout(function(){
		self.height = $(&quot;#&quot; + self.div_string).outerHeight();
		self.init_view();
		self.render();
	},501);
},</code></pre></span>
          <section id="init_view">
            <h1>init_view</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_view()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view from scratch<br />Draw a background panel and place all dynamic content on that panel with defualt values<br />tick_view.init_view();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_view: function(){
	// stuff &quot;this&quot; into a variable for use inside of scoped funcitons
	var self = this;

	// check to see if the container is visible, if not, make it visible, but transparent so we draw it with
	// the proper dimensions
	if (this.$el.is(&quot;:hidden&quot;)){
		this.$el.animate({opacity:0},1);
		this.$el.show();
	}

	// rescale the width of the vis
	this.vis.attr(&quot;width&quot;,this.width);

	// rescale the height of the vis
	this.vis.attr(&quot;height&quot;,this.height);

	// set up scaling and margin parameters for the vis
	this.margin = 25;
	this.well_offset = 80;
	this.x_scale=d3.scale.linear().domain([-1,1]).range([this.well_offset + this.margin, this.width - this.margin]);

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// build an xAxis
	var xAxis = d3.svg.axis()
		.scale(this.x_scale)
		.orient(&quot;bottom&quot;);

	// plot the x axis
	this.vis.selectAll('.axis').data([]).exit().remove();
	this.vis.append(&quot;g&quot;)
		.attr(&quot;class&quot;, &quot;axis&quot;)
		.attr(&quot;transform&quot;, &quot;translate(0,&quot; + (this.height - this.margin) + &quot;)&quot;)
		.call(xAxis);

	// style the axis
	this.vis.select('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.select('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.select('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);

	// grab data from the model and sort it according to the values in the object
	var data_array = _.pairs(this.model.get('data_object'));
	data_array = data_array.sort(function(a,b){
		if (Barista.arrayAverage(a[1]) &lt; Barista.arrayAverage(b[1])) return 1;
		if (Barista.arrayAverage(a[1]) &gt; Barista.arrayAverage(b[1])) return -1;
		return 0;
	});
	var keys = [];
	var values = [];
	data_array.forEach(function(category){
		keys.push(category[0]);
		values.push(category[1]);
	});

	// draw the static index reagent text
	this.fg_layer.selectAll('.title_text').data([]).exit().remove();
	this.fg_layer.selectAll('.title_text').data([1])
						.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;title_text&quot;)
						.attr(&quot;x&quot;,this.width/2)
						.attr(&quot;y&quot;,17)
						.attr(&quot;fill&quot;,&quot;#56B4E9&quot;)
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.attr(&quot;text-anchor&quot;,&quot;middle&quot;)
						.text(this.model.get('title'));

	// draw the static category wells
	this.fg_layer.selectAll('.category_well').data([]).exit().remove();
	this.fg_layer.selectAll('.category_well').data(keys)
						.enter().append(&quot;rect&quot;)
						.attr(&quot;class&quot;,&quot;category_well&quot;)
						.attr(&quot;x&quot;,this.margin + this.well_offset)
						.attr(&quot;y&quot;,function(d,i){return 18*i + 23;})
						.attr(&quot;height&quot;,17)
						.attr(&quot;width&quot;,this.width - this.margin*2 - this.well_offset)
						.attr(&quot;fill&quot;, function(d,i){
							if (i%2 == 0){
								return &quot;#bdbdbd&quot;;
							}else{
								return &quot;#999999&quot;;
							}
						});
	// draw the ticks
	values.forEach(function(value_array,i){
		tick_class = keys[i] + 'tick'
		self.fg_layer.selectAll('.' + tick_class).data([]).exit().remove();
		self.fg_layer.selectAll('.' + tick_class).data(value_array)
							.enter().append(&quot;rect&quot;)
							.attr(&quot;class&quot;,&quot;tick &quot; + tick_class)
							.attr(&quot;x&quot;,self.x_scale)
							.attr(&quot;y&quot;,18*i + 23)
							.attr(&quot;height&quot;,17)
							.attr(&quot;width&quot;,3)
							.attr(&quot;fill&quot;, &quot;#ff0000&quot;);
	});

	

	// add a png export overlay
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([]).exit().remove();
	this.fg_layer.selectAll(&quot;.&quot; + this.div_string + &quot;png_export&quot;).data([1]).enter().append(&quot;text&quot;)
		.attr(&quot;class&quot;, this.div_string + &quot;png_export no_png_export&quot;)
		.attr(&quot;x&quot;,10)
		.attr(&quot;y&quot;,this.height - 10)
		.attr(&quot;opacity&quot;,0.25)
		.style(&quot;cursor&quot;,&quot;pointer&quot;)
		.text(&quot;png&quot;)
		.on(&quot;mouseover&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,1).attr(&quot;fill&quot;,&quot;#56B4E9&quot;);})
		.on(&quot;mouseout&quot;,function(){d3.select(this).transition().duration(500).attr(&quot;opacity&quot;,0.25).attr(&quot;fill&quot;,&quot;#000000&quot;);})
		.on(&quot;click&quot;,function(){self.save_png();});
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>render the dynamic content of the view based on the current state of the view&#39;s data model<br />tick_view.render();</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	// grab data from the model and sort it according to the values in the object
	var data_array = _.pairs(this.model.get('data_object'));
	data_array = data_array.sort(function(a,b){
		if (Barista.arrayAverage(a[1]) &lt; Barista.arrayAverage(b[1])) return 1;
		if (Barista.arrayAverage(a[1]) &gt; Barista.arrayAverage(b[1])) return -1;
		return 0;
	});
	var keys = [];
	var values = [];
	data_array.forEach(function(category){
		keys.push(category[0]);
		values.push(category[1]);
	});

	// draw the static category text
	this.fg_layer.selectAll('.category_text').data([]).exit().remove();
	this.category_text_selection = this.fg_layer.selectAll('.category_text').data(keys);
	this.category_text_selection.enter().append(&quot;text&quot;)
						.attr(&quot;class&quot;,&quot;category_text&quot;)
						.attr(&quot;x&quot;,this.margin)
						.attr(&quot;y&quot;,function(d,i){return 18*i + 40;})
						.attr(&quot;font-family&quot;,&quot;Helvetica Neue&quot;)
						.attr(&quot;font-size&quot;,&quot;14pt&quot;)
						.text(function(d){return d;});

	this.category_text_selection.exit().remove();

},</code></pre></span>
          <section id="hide">
            <h1>hide</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>hide()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_detail_view.hide(duration);</p><p>hides the view by dimming the opacity and hiding it in the DOM</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the time in ms for the hide animation. defualts to 1</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">hide: function(duration){
	duration = (duration !== undefined) ? duration : 1;
	var self = this;
	this.$el.animate({opacity:0},duration);
	var check_interval = setInterval(check_for_compiled_template(),1);
	function check_for_compiled_template(){
		if (!self.isCompiling){
			clearInterval(check_interval);
			self.width = $(&quot;#&quot; + self.div_string).width();
			setTimeout(function(){self.$el.hide();},duration);
		}
	}
},</code></pre></span>
          <section id="show">
            <h1>show</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>show()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>pert_detail_view.show(duration);</p><p>shows the view by brightening the opacity and showing it in the DOM</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>duration</td>
                <td>number</td>
                <td><p>the time in ms for the show animation. defualts to 1</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">show: function(duration){
	duration = (duration !== undefined) ? duration : 1;
	this.$el.show();
	this.$el.animate({opacity:1},duration);
},</code></pre></span>
          <section id="save_png">
            <h1>save_png</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>save_png()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>save the current state of the view into a png image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">save_png: function(){
	// build a canvas element to store the image temporarily while we save it
	var width = this.vis.attr(&quot;width&quot;);
	var height = this.vis.attr(&quot;height&quot;);
	var html_snippet = '&lt;canvas id=&quot;tmpCanvas&quot; width=&quot;' + width + 'px&quot; height=&quot;' + height + 'px&quot;&gt;&lt;/canvas&gt;';
	$('body').append(html_snippet);

	// dim the png label on the image
	var png_selection = this.vis.selectAll(&quot;.no_png_export&quot;);
	var png_opacity = png_selection.attr(&quot;opacity&quot;);
	png_selection.attr(&quot;opacity&quot;,0);

	// grab the content of the target svg and place it in the canvas element
	var svg_snippet = this.vis.node().parentNode.innerHTML;
	canvg(document.getElementById('tmpCanvas'), '&lt;svg&gt;' + svg_snippet + '&lt;/svg&gt;', { ignoreMouse: true, ignoreAnimation: true });

	// save the contents of the canvas to file and remove the canvas element
	var canvas = $(&quot;#tmpCanvas&quot;)[0];
	var filename = &quot;cmapTickView&quot; + new Date().getTime() + &quot;.png&quot;;
	if (canvas.toBlob){canvas.toBlob(function(blob){saveAs(blob,filename);})};
	$('#tmpCanvas').remove();

	// make the png label on the image visible again
	png_selection.attr(&quot;opacity&quot;,png_opacity);
}

});</code></pre></span>
          <section id="ViolinPlotView">
            <h1>ViolinPlotView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.ViolinPlotView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>violin_plot_view = new ViolinPlotView({el: $(&quot;target_selector&quot;,<br />                                    bg_color:&quot;#ffffff&quot;,<br />                                    fg_color: &quot;#1b9e77&quot;,<br />                                    span_class: &quot;span4&quot;,<br />                                    scale_by: undefined,<br />                                    x_range: undefined,<br />                                    y_range: undefined,<br />                                    x_log: false,<br />                                    y_log: false,<br />                                    plot_height: 120});</p><p>A Backbone.View that displays a single scatter plot<br />the view&#39;s model is assumed to have the same defaults as specified in ScatterPlotModel<br />basic use:<br />violin_plot_view = new ViolinPlotView();<br />optional arguments:</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>bg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the backgound of the view, defaults to                               #ffffff</p></td>
              </tr>
              <tr>
                <td>fg_color</td>
                <td>string</td>
                <td><p>the hex color code to use as the foreground color of the view, defaults                               to #1b9e77</p></td>
              </tr>
              <tr>
                <td>span_class</td>
                <td>string</td>
                <td><p>a bootstrap span class to size the width of the view, defaults to                               &quot;span12&quot;</p></td>
              </tr>
              <tr>
                <td>x_range</td>
                <td>array</td>
                <td><p>a two element array specifying the x plotting bounds of the plot,                               defaults to [min(x_data),max(x_data)]</p></td>
              </tr>
              <tr>
                <td>y_range</td>
                <td>array</td>
                <td><p>a two element array specifying the y plotting bounds of the plot,                               defaults to [min(y_data),max(y_data)]</p></td>
              </tr>
              <tr>
                <td>x_log</td>
                <td>boolean</td>
                <td><p>if set to true, plots the x axis on a log scale, defaults to false</p></td>
              </tr>
              <tr>
                <td>y_log</td>
                <td>boolean</td>
                <td><p>if set to true, plots the y axis on a log scale, defaults to false</p></td>
              </tr>
              <tr>
                <td>plot_height</td>
                <td>number</td>
                <td><p>the height of the plot in pixels, defaults to 120</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.ViolinPlotView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>set up the view&#39;s default model</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.ScatterPlotModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
	// set up x and y range
	this.x_range = (this.options.x_range !== undefined) ? this.options.x_range : undefined;
	this.y_range = (this.options.y_range !== undefined) ? this.options.y_range : undefined;

	// set up x and y log flags
	this.x_log = (this.options.x_log !== undefined) ? this.options.x_log : false;
	this.y_log = (this.options.y_log !== undefined) ? this.options.y_log : false;

	// set up the scale_by parameter
	this.scale_by = (this.options.scale_by !== undefined) ? this.options.scale_by : undefined;

	// run BaristaBaseView's base_initialize method to handle boilerplate view construction
	// and initial view rendering
	this.base_initialize();

	// set up the default height for the plot
	this.plot_height = (this.options.plot_height !== undefined) ? this.options.plot_height : undefined;

	// set up the span size
	this.span_class = (this.options.span_class !== undefined) ? this.options.span_class : &quot;span12&quot;;

	// bind render to model changes
	this.listenTo(this.model,'change', this.update);

	// compile the default template for the view
	this.compile_template();

	// define the location where d3 will build its plot
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();
	this.vis = d3.select(&quot;#&quot; + this.div_string).append(&quot;svg&quot;)
					.attr(&quot;width&quot;,this.width)
					.attr(&quot;height&quot;,this.height);

	// render the vis
	this.render();

	// bind window resize events to render
	var self = this;
	$(window).resize(function() {self.render();} );
},</code></pre></span>
          <section id="compile_template">
            <h1>compile_template</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>compile_template()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>use Handlebars to compile the template for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">compile_template: function(){
	var self = this;
	this.div_string = 'd3_target' + new Date().getTime();;
	this.compiled_template = BaristaTemplates.d3_target;
	this.$el.append(BaristaTemplates.d3_target({div_string: this.div_string,
											span_class: this.span_class,
											height: this.plot_height}));
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
	this.base_render();
	this.init_plot();
	this.update();
},</code></pre></span>
          <section id="init_plot">
            <h1>init_plot</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>init_plot()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>initialize the static parts of the view&#39;s panel</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">init_plot: function(){
	// stuff this into a variable for later use
	var self = this;

	// set up the margin
	this.margin = 50;

	// set up x and y ranges
	if (this.x_range === undefined){
		this.x_range = [_.min(this.model.get('x_data')),_.max(this.model.get('x_data'))];
	}
	if (this.y_range === undefined){
		this.y_range = [_.min(this.model.get('y_data')),_.max(this.model.get('y_data'))];
	}

	// set up scaling
	if (this.x_log){
		this.x_scale=d3.scale.log().domain([this.x_range[0],this.x_range[1]]).range([this.margin, this.width - this.margin]);
	}else{
		this.x_scale=d3.scale.linear().domain([this.x_range[0],this.x_range[1]]).range([this.margin, this.width - this.margin]);
	}
	if (this.y_log){
		this.y_scale=d3.scale.log().domain([this.y_range[1],this.y_range[0]]).range([this.margin, this.height - this.margin]);
	}else{
		this.y_scale=d3.scale.linear().domain([this.y_range[1],this.y_range[0]]).range([this.margin, this.height - this.margin]);
	}

	// set up drawing layers
	this.vis.selectAll('.bg_layer').data([]).exit().remove();
	this.bg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;bg_layer&quot;);

	this.vis.selectAll('.fg_layer').data([]).exit().remove();
	this.fg_layer = this.vis.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;fg_layer&quot;);

	// set up the panel's width and height
	this.width = $(&quot;#&quot; + this.div_string).width();
	this.height = $(&quot;#&quot; + this.div_string).outerHeight();

	// rescale the width of the vis
	this.vis.transition().attr(&quot;width&quot;,this.width);
	this.vis.transition().attr(&quot;height&quot;,this.height);

	// draw the background of the panel
	this.bg_layer.selectAll('.bg_panel').data([]).exit().remove();
	this.bg_layer.selectAll('.bg_panel').data([1]).enter().append('rect')
		.attr(&quot;class&quot;,&quot;bg_panel&quot;)
		.attr(&quot;height&quot;,this.height)
		.attr(&quot;width&quot;,this.width)
		.attr(&quot;fill&quot;,this.bg_color);

	// build an Axes
	var xAxis = d3.svg.axis()
		.scale(this.x_scale)
		.orient(&quot;bottom&quot;);
	var yAxis = d3.svg.axis()
		.scale(this.y_scale)
		.orient(&quot;left&quot;);

	// plot the axes
	this.bg_layer.selectAll('.axis').data([]).exit().remove();
	this.bg_layer.append(&quot;g&quot;)
		.attr(&quot;class&quot;, &quot;axis&quot;)
		.attr(&quot;transform&quot;, &quot;translate(0,&quot; + (this.height - this.margin) + &quot;)&quot;)
		.call(xAxis);

	// style the axes
	this.vis.selectAll('.axis').selectAll(&quot;path&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;line&quot;)
		.style(&quot;fill&quot;,&quot;none&quot;)
		.style(&quot;stroke&quot;,&quot;black&quot;)
		.style(&quot;shape-rendering&quot;, &quot;crispEdges&quot;);

	this.vis.selectAll('.axis').selectAll(&quot;text&quot;)
		.style(&quot;font-family&quot;,&quot;sans-serif&quot;)
		.style(&quot;font-size&quot;,&quot;11px&quot;);

	// define an area generator for use in plotting data
	this.upper_area_generator = d3.svg.area()
		.x(function(d) { return self.x_scale(d.x); })
		.y0(this.y_scale(0))
		.y1(function(d) { return self.y_scale(d.y); })
		.interpolate('basis');
	this.lower_area_generator = d3.svg.area()
		.x(function(d) { return self.x_scale(d.x); })
		.y0(this.y_scale(0))
		.y1(function(d) { return self.y_scale(d.y * -1); })
		.interpolate('basis');

	// grab data from the model and package it such that we can iterate over it
	// and generate an area. The packaged data will be sorted by the x_data attribute
	this.x_data = this.model.get('x_data');
	this.y_data = this.model.get('y_data');
	this.path_data = [];
	this.x_data.forEach(function(x,i){ self.path_data.push({x: x, y: self.y_data[i]});});
	this.path_data.sort(this.path_data_sorter);

	// plot the data
	this.bg_layer.selectAll('.upper_violin').data([]).exit().remove();
	this.bg_layer.selectAll('.upper_violin').data([1]).enter().append('path')
		.attr(&quot;class&quot;,&quot;upper_violin&quot;)
		.attr(&quot;opacity&quot;,0.5)
		.attr(&quot;fill&quot;,this.fg_color)
		.attr('d',this.upper_area_generator(this.path_data));
	this.bg_layer.selectAll('.lower_violin').data([]).exit().remove();
	this.bg_layer.selectAll('.lower_violin').data([1]).enter().append('path')
		.attr(&quot;class&quot;,&quot;lower_violin&quot;)
		.attr(&quot;opacity&quot;,0.5)
		.attr(&quot;fill&quot;,this.fg_color)
		.attr('d',this.lower_area_generator(this.path_data));


	// plot the x axis title
	this.bg_layer.selectAll('.x_axis_label').data([]).exit().remove();
	this.bg_layer.selectAll('.x_axis_label').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;x_axis_label axis_label&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.height-10)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('x_axis_title'));

	// plot the title
	this.bg_layer.selectAll('.title').data([]).exit().remove();
	this.bg_layer.selectAll('.title').data([1]).enter().append('text')
		.attr(&quot;class&quot;,&quot;title title&quot;)
		.attr(&quot;x&quot;,this.width/2)
		.attr(&quot;y&quot;,this.margin/2)
		.style(&quot;text-anchor&quot;,&quot;middle&quot;)
		.text(this.model.get('title'));

},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
	var self = this;
	// grab data from the model and package it such that we can iterate over it
	// and generate an area. The packaged data will be sorted by the x_data attribute
	this.x_data = this.model.get('x_data');
	this.y_data = this.model.get('y_data');
	this.path_data = [];
	this.x_data.forEach(function(x,i){ self.path_data.push({x: x, y: self.y_data[i]});});
	this.path_data.sort(this.path_data_sorter);

	// transition the data
	var upper = this.bg_layer.selectAll('.upper_violin');
	upper.transition().duration(500).attr('d',this.upper_area_generator(this.path_data));

	var lower = this.bg_layer.selectAll('.lower_violin');
	lower.transition().duration(500).attr('d',this.lower_area_generator(this.path_data));
},</code></pre></span>
          <section id="path_data_sorter">
            <h1>path_data_sorter</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>path_data_sorter()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>internal method used to sort path_data list elements by the x attribute</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>a</td>
                <td>object</td>
                <td><p>first element to compare</p></td>
              </tr>
              <tr>
                <td>b</td>
                <td>object</td>
                <td><p>second element to compare</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">path_data_sorter: function(a,b) {
	if (a.x &lt; b.x){
		return -1;
	}else{
		return 1;
	}
}
});</code></pre></span>
          <section id="SequenceView">
            <h1>SequenceView</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>Barista.Views.SequenceView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>A view the displays both sequence structure and modifications</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Barista.Views.SequenceView = Barista.Views.BaristaBaseView.extend({</code></pre></span>
          <section id="name">
            <h1>name</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>name</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>give the view a name to be used throughout the View&#39;s functions when it needs to know what its class<br />name is</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">name: &quot;SequenceView&quot;,</code></pre></span>
          <section id="model">
            <h1>model</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">property</div><span>model</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>the default model for the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">model: new Barista.Models.SequenceModel(),</code></pre></span>
          <section id="initialize">
            <h1>initialize</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>initialize()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Overide the default Backbone.View initialize method to handle optional arguments, compile the view<br />template, bind model changes to view updates, and render the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">initialize: function(){
  // set up modification colors
  this.modificationColors = (this.options.modificationColors !== undefined) ? this.options.modificationColors : undefined;
  if (this.modificationColors === undefined) {
    this.modificationColors = {
      'ac': '#ff9933',
      'ox': '#00ccff'
    }
  }

  //set up default sequenceUnitSize
  this.sequenceUnitSize = (this.options.sequenceUnitSize !== undefined) ? this.options.sequenceUnitSize : 5;

  // initialize the base view
  this.base_initialize();

  // add a class to denote the widget type
  var $div = $(&quot;#&quot; + this.div_string);
  $div.addClass(&quot;barista-sequence-view&quot;);
},</code></pre></span>
          <section id="render">
            <h1>render</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>render()</span> -><span>SequenceView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>completely render the view<br />Updates both static and dynamic content in the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">render: function(){
  var self = this;
  // call BaristaBaseView's render function first so we can layer on top of it
  this.base_render();

  // render a sequence line
  this.renderSequenceLine();

  // render modifications
  this.renderModifications();

  // render modifications text
  // this.renderModificationsText();

  // configure zooming
  this.setupZoom();

  return this;
},</code></pre></span>
          <section id="update">
            <h1>update</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>update()</span> -><span>SequenceView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>update the dynamic potions of the view</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">update: function(){
  this.render();

  return this;
},</code></pre></span>
          <section id="getRenderLength">
            <h1>getRenderLength</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>getRenderLength()</span> -><span>float</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>calculate the length of the sequence in pixels</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">getRenderLength: function() {
  if (this.sequenceUnitSize * this.model.get('displaySequence').length &gt; this.width - 20) {
    return this.width -20;
  }
  return this.sequenceUnitSize * this.model.get('displaySequence').length;

},</code></pre></span>
          <section id="renderSequenceLine">
            <h1>renderSequenceLine</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>renderSequenceLine()</span> -><span>SequenceView</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>render the line depicting the base sequence</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">renderSequenceLine: function() {
  var renderLength = this.getRenderLength();
  this.fg_layer.selectAll('.sequenceLine').data([]).exit().remove();
  this.fg_layer.selectAll('.sequenceLine').data([1]).enter()
    .append('rect')
    .attr(&quot;class&quot;,&quot;sequenceLine&quot;)
    .attr(&quot;height&quot;, 2)
    .attr(&quot;width&quot;,renderLength)
    .attr(&quot;x&quot;,5)
    .attr(&quot;y&quot;,this.height / 2 - 2)
    .attr(&quot;fill&quot;,&quot;#BFBFBF&quot;);

  return this;
},</code></pre></span>
          <section id="renderModifications">
            <h1>renderModifications</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>renderModifications()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>render the modifications on the sequence</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">renderModifications: function() {
  var self = this,
      renderLength = this.getRenderLength();

  this.fg_layer.selectAll('.sequenceModification').data([]).exit().remove();
  this.fg_layer.selectAll('.sequenceModification')
    .data(this.model.get('modifications').models).enter()
    .append('g')
    .each(function(d) {

      d3.select(this)
      .append('circle')
      .attr(&quot;class&quot;,&quot;sequenceModification&quot;)
      .attr('r', 10)
      .attr('fill', function(d) {
        var color = self.modificationColors[d.get('modification')];
        if (color === undefined) {
          return '#BDBDBD';
        } else {
          return color;
        }
      })
      .attr('cx', function(d) {
        var totalLength = self.model.get('displaySequence').length,
            positionPct = d.get('index') / totalLength;
        return positionPct * (renderLength) + 10;
      })
      .attr(&quot;cy&quot;,self.height / 2);

      d3.select(this)
      .append('text')
      .attr(&quot;class&quot;,&quot;sequenceModificationText&quot;)
      .attr('x', function(d) {
        var totalLength = self.model.get('displaySequence').length,
            positionPct = d.get('index') / totalLength;
        switch (self.model.get('displaySequence')[d.get('index') - 1]) {
          case 'M':
            return positionPct * (renderLength) + 4;
            break;
          default:
            return positionPct * (renderLength) + 5;
        }

      })
      .attr(&quot;y&quot;,self.height / 2 + 5)
      .text(function (d) {
        return self.model.get('displaySequence')[d.get('index') - 1];
      })
      .attr('fill','white')
      .attr('font-family','Open Sans')
      .attr('font-weight', 'bold');

    });
},</code></pre></span>
          <section id="renderModificationsText">
            <h1>renderModificationsText</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>renderModificationsText()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>renders text overlays for modifications</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">renderModificationsText: function() {
  var self = this,
      renderLength = this.getRenderLength();

  this.fg_layer.selectAll('.sequenceModificationText').data([]).exit().remove();
  this.fg_layer.selectAll('.sequenceModificationText')
    .data(this.model.get('modifications').models).enter()
    .append('text')
    .attr(&quot;class&quot;,&quot;sequenceModificationText&quot;)
    .attr('x', function(d) {
      var totalLength = self.model.get('displaySequence').length,
          positionPct = d.get('index') / totalLength;
      switch (self.model.get('displaySequence')[d.get('index') - 1]) {
        case 'M':
          return positionPct * (renderLength) + 4;
          break;
        default:
          return positionPct * (renderLength) + 5;
      }

    })
    .attr(&quot;y&quot;,this.height / 2 + 5)
    .text(function (d) {
      return self.model.get('displaySequence')[d.get('index') - 1];
    })
    .attr('fill','white')
    .attr('font-family','Open Sans')
    .attr('font-weight', 'bold');
},</code></pre></span>
          <section id="setupZoom">
            <h1>setupZoom</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>setupZoom()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>configure zoom behavior</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">setupZoom: function () {
  var self = this;
  // create the zoom listener
  var zoomListener = d3.behavior.zoom()
    .scaleExtent([1, 3])
    .on(&quot;zoom&quot;, zoomHandler);

  // function for handling zoom event
  function zoomHandler() {
    self.fg_layer.attr(&quot;transform&quot;, &quot;translate(&quot; + d3.event.translate + &quot;)scale(&quot; + d3.event.scale + &quot;)&quot;);
  }

  // apply the zoom behavior to the svg image
  zoomListener(this.vis);
}

});</code></pre></span>
          <section id="Tile">
            <h1>Tile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>Tile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Tile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#bdbdbd&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
              <tr>
                <td>[options.display]</td>
                <td>bool</td>
                <td><p>true to render the tile on object creation, false not to, defaults to true</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function Tile(options){
	options = (options !== undefined) ? options : {};
	this.div_target = (options.div_target !== undefined) ? options.div_target : &quot;body&quot;;
	this.div_id = (options.div_id !== undefined) ? options.div_id : &quot;Tile&quot; + Math.floor(Math.random()*1000000000);
	this.link = (options.link !== undefined) ? options.link : &quot;&quot;;
	this.style = (options.style !== undefined) ? options.style : &quot;&quot;;
	this.color = (options.color !== undefined) ? options.color : &quot;#bdbdbd&quot;;
	this.tile_type = (options.tile_type !== undefined) ? options.tile_type : &quot;medium&quot;;
	this.display = (options.display !== undefined) ? options.display : true;

	// initialize the tile
	this.init_state = false;
	if (this.display){
		this.init();
	}
}</code></pre></span>
          <section id="init">
            <h1>init</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.init()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Initializes Tile by building the appropriate html and injecting it into the DOM</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.init = function() {
	// build the html to inject into the DOM
	this.build_html();

	// inject the html into the target div
	this.inject();

	//draw the background of the tile
	this.draw_bg();

	// set the initialization flag to true
	this.init_state = true;

	// bind the tile to redraw when the window resizes
	var self = this;
	$(window).resize(function() {self.draw_bg();} );
};</code></pre></span>
          <section id="build_html">
            <h1>build_html</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.build_html()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Builds the html for the tile based on the tile_type given in the constructor</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.build_html = function() {
	if (this.tile_type == &quot;small&quot;){
		this.html = '&lt;div id=&quot;' + this.div_id + '&quot; class=&quot;span3&quot; style=&quot;height:150px ' + this.style + '&quot;&gt;&lt;/div&gt;';
	}
	if (this.tile_type == &quot;medium&quot;){
		this.html = '&lt;div id=&quot;' + this.div_id + '&quot; class=&quot;span6&quot; style=&quot;height:300px ' + this.style + '&quot;&gt;&lt;/div&gt;';
	}
	if (this.tile_type == &quot;wide&quot;){
		this.html = '&lt;div id=&quot;' + this.div_id + '&quot; class=&quot;span12&quot; style=&quot;height:300px ' + this.style + '&quot;&gt;&lt;/div&gt;';
	}
};</code></pre></span>
          <section id="inject">
            <h1>inject</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.inject()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>Injects the Tile&#39;s html into the DOM at the target id given in the constructor</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.inject = function() {
	$(this.div_target).append(this.html);
};</code></pre></span>
          <section id="draw_bg">
            <h1>draw_bg</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.draw_bg()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws the tiles background using d3.js</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.draw_bg = function() {
	// get the correct height and width to draw
	this.width = $(&quot;#&quot; + this.div_id).outerWidth();
	if (this.tile_type == &quot;small&quot;){
		this.height = 150;
	}else{
		this.height = 300;
	}

	// set up a top level svg selection if the tile needs to be initialized
	if (!this.init_state){
		this.svg=d3.select(&quot;#&quot; + this.div_id).append(&quot;svg&quot;)
			.attr(&quot;class&quot;,this.div_id + &quot;_tile_svg&quot;)
			.attr(&quot;width&quot;,this.width)
			.attr(&quot;height&quot;,this.height);

		// add a group to drawing elements
		this.svg.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;draw_layer&quot;);

		// add a group to link elements
		this.svg.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;link_layer&quot;);

		// add the link
		this.link_selection = this.svg.select('.link_layer').selectAll(&quot;rect.link_rect&quot;).data([1]);
		this.link_selection.enter().append(&quot;a&quot;)
			.attr(&quot;xlink:href&quot;,this.link)
			.append(&quot;rect&quot;)
			.attr(&quot;x&quot;,0)
			.attr(&quot;y&quot;,0)
			.attr(&quot;rx&quot;,20)
			.attr(&quot;ry&quot;,20)
			.attr(&quot;class&quot;,&quot;link_rect&quot;)
			.attr(&quot;height&quot;, this.height)
			.attr(&quot;width&quot;, this.width)
			.attr(&quot;fill&quot;, this.color)
			.attr(&quot;opacity&quot;,0);
	}

	// (re)draw the background
	this.svg.select('.draw_layer').selectAll(&quot;rect.bg&quot;).data([]).exit().remove();
	this.svg.select('.draw_layer').selectAll(&quot;rect.bg&quot;).data([1])
			.enter().append(&quot;rect&quot;)
			.attr(&quot;x&quot;,0)
			.attr(&quot;y&quot;,0)
			.attr(&quot;rx&quot;,20)
			.attr(&quot;ry&quot;,20)
			.attr(&quot;class&quot;,&quot;bg&quot;)
			.attr(&quot;height&quot;, this.height)
			.attr(&quot;width&quot;, this.width)
			.attr(&quot;fill&quot;, this.color);
};</code></pre></span>
          <section id="hide">
            <h1>hide</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.hide()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hides the tile</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[duration=0]</td>
                <td>object</td>
                <td><p>the duration of a fade out animation applied before hiding the tile</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.hide = function(duration) {
	duration = (duration !== undefined) ? duration : 0;
	$(&quot;#&quot; + this.div_id).animate({opacity:0,width:0,height:0},duration);
	var self = this;
	setTimeout(function(){$(&quot;#&quot; + self.div_id).hide();},duration);
};</code></pre></span>
          <section id="show">
            <h1>show</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>Tile.prototype.show()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>shows the tile</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[duration=0]</td>
                <td>object</td>
                <td><p>the duration of a fade out animation applied after showing the tile</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">Tile.prototype.show = function(duration) {
	duration = (duration !== undefined) ? duration : 0;
	$(&quot;#&quot; + this.div_id).show();
	$(&quot;#&quot; + this.div_id).animate({opacity:1,width:this.width,height:this.height},duration);
};</code></pre></span>
          <section id="ImageTile">
            <h1>ImageTile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>ImageTile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>ImageTile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.image]</td>
                <td>string</td>
                <td><p>the url to use as the image,defaults to &quot;../Bellhop/img.two_circles.png&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#f0f0f0&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function ImageTile(options){
	this.image = (options.image !== undefined) ? options.image : &quot;../Bellhop/img/CMap_Logo_gray.png&quot;;
	Tile.apply(this,arguments);
	var self = this;
	$(window).resize(function() {self.draw();} );
	this.draw();
}
ImageTile.prototype = new Tile({display:false});
ImageTile.prototype.constructor = ImageTile;</code></pre></span>
          <section id="draw">
            <h1>draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>ImageTile.prototype.draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>top level draw wrapper around draw_bg and draw_image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">ImageTile.prototype.draw = function() {
	this.draw_bg();
	this.draw_image();
};</code></pre></span>
          <section id="draw_image">
            <h1>draw_image</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>ImageTile.prototype.draw_image()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws the tile&#39;s image using d3.js</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">ImageTile.prototype.draw_image = function() {
	// get the correct height and width to draw
	this.width = $(&quot;#&quot; + this.div_id).outerWidth();
	if (this.tile_type == &quot;small&quot;){
		this.height = 150;
	}else{
		this.height = 300;
	}

	// set up a top level svg selection if the tile needs to be initialized
	if (!this.init_state){
		this.svg=d3.select(&quot;#&quot; + this.div_id).append(&quot;svg&quot;)
			.attr(&quot;class&quot;,this.div_id + &quot;_tile_svg&quot;)
			.attr(&quot;width&quot;,this.width)
			.attr(&quot;height&quot;,this.height);
	}

	// (re)draw the image
	this.image_size = this.height - 50;
	this.svg.select('.draw_layer').selectAll(&quot;image.&quot; + this.div_id).data([]).exit().remove();
	this.image_selection = this.svg.select('.draw_layer').selectAll(&quot;image.&quot; + this.div_id).data([1])
		.enter().append(&quot;image&quot;)
		.attr(&quot;xlink:href&quot;,this.image)
		.attr(&quot;class&quot;,this.div_id)
		.attr(&quot;x&quot;,this.width/2 - this.image_size/2)
		.attr(&quot;y&quot;,this.height/2 - this.image_size/2)
		.attr(&quot;height&quot;,this.image_size)
		.attr(&quot;width&quot;,this.image_size);
};</code></pre></span>
          <section id="AnimatedImageTile">
            <h1>AnimatedImageTile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>AnimatedImageTile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>AnimatedImageTextTile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.image]</td>
                <td>string</td>
                <td><p>the url to use as the image,defaults to &quot;../Bellhop/img.two_circles.png&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#f0f0f0&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function AnimatedImageTile(options){
	this.image = (options.image !== undefined) ? options.image : &quot;../Bellhop/img/CMap_Logo_gray.png&quot;;
	Tile.apply(this,arguments);
	var self = this;
	$(window).resize(function() {self.draw();} );
	this.draw();
	this.start_animation();
}
AnimatedImageTile.prototype = new ImageTile({display:false});
AnimatedImageTile.prototype.constructor = AnimatedImageTile;</code></pre></span>
          <section id="draw">
            <h1>draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTile.prototype.draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>top level draw wrapper around draw_bg and draw_image</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTile.prototype.draw = function() {
	this.draw_bg();
	this.draw_image();
};</code></pre></span>
          <section id="start_animation">
            <h1>start_animation</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTile.prototype.start_animation()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>starts periodic animation of the Image on the Tile</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[duration=2000]</td>
                <td>int</td>
                <td><p>duration the length of the animation in milliseconds</p></td>
              </tr>
              <tr>
                <td>[frequency=</td>
                <td>int</td>
                <td><p>10000 to 20000] frequency the frequency of the animation in milliseconds</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTile.prototype.start_animation = function(duration,frequency) {
	duration = (duration !== undefined) ? duration : 2000;
	frequency = (frequency !== undefined) ? frequency : 10000 + Math.random() * 10000;
	var self = this;
	setInterval(function(){
		self.image_selection.transition().duration(duration/2)
			.attr(&quot;y&quot;,-self.image_size - 10)
			.transition().duration(1)
			.attr(&quot;y&quot;,self.height + self.image_size + 10)
			.transition().duration(duration/2)
			.attr(&quot;y&quot;,self.height/2 - self.image_size/2);
	},frequency);
};</code></pre></span>
          <section id="ImageTextTile">
            <h1>ImageTextTile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>ImageTextTile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>ImageTextTile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.image]</td>
                <td>string</td>
                <td><p>the url to use as the image,defaults to &quot;../Bellhop/img.two_circles.png&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.text]</td>
                <td>string</td>
                <td><p>the text to display on the panel, defaults to &quot;Title&quot;</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#f0f0f0&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function ImageTextTile(options){
	this.title = (options.title !== undefined) ? options.title : &quot;Title&quot;;
	ImageTile.apply(this,arguments);
	var self = this;
	$(window).resize(function() {self.draw();} );
	this.draw();
}
ImageTextTile.prototype = new ImageTile({display:false});
ImageTextTile.prototype.constructor = ImageTextTile;</code></pre></span>
          <section id="draw">
            <h1>draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>ImageTextTile.prototype.draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>top level draw wrapper around draw_bg and draw_image and draw_text</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">ImageTextTile.prototype.draw = function() {
	this.draw_bg();
	this.draw_image();
	this.draw_text();
};</code></pre></span>
          <section id="draw_text">
            <h1>draw_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>ImageTextTile.prototype.draw_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws the tile&#39;s text using d3.js</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">ImageTextTile.prototype.draw_text = function() {
	// get the correct height and width to draw
	this.width = $(&quot;#&quot; + this.div_id).outerWidth();
	if (this.tile_type == &quot;small&quot;){
		this.height = 150;
	}else{
		this.height = 300;
	}

	// set up a top level svg selection if the tile needs to be initialized
	if (!this.init_state){
		this.svg=d3.select(&quot;#&quot; + this.div_id).append(&quot;svg&quot;)
			.attr(&quot;class&quot;,this.div_id + &quot;_tile_svg&quot;)
			.attr(&quot;width&quot;,this.width)
			.attr(&quot;height&quot;,this.height);
	}

	// (re)draw the text
	if (this.tile_type == &quot;wide&quot; || this.tile_type == &quot;medium&quot;){
		var x,y,height,width,html;
		if (this.tile_type == &quot;wide&quot;){
			x = this.width/3*2;
			y = this.height/10*5;
			height = this.height/10 * 5;
			width = this.width/3 - 20;
			html = '&lt;h2&gt;' + this.title + '&lt;/h2&gt;';
		}
		if (this.tile_type == &quot;medium&quot;){
			x = 20;
			y = this.height/10*8.5;
			height = this.height/10 * 1.5;
			width = this.width - 40;
			html = '&lt;h3&gt;' + this.title + '&lt;/h3&gt;';
		}
		this.svg.select('.draw_layer').selectAll('.tile_text').data([]).exit().remove();
		this.svg.select('.draw_layer').selectAll('.tile_text').data([this.title])
			.enter().append(&quot;foreignObject&quot;)
			.attr(&quot;class&quot;,&quot;tile_text&quot;)
			.attr(&quot;x&quot;,x)
			.attr(&quot;y&quot;,y)
			.attr(&quot;height&quot;,height)
			.attr(&quot;width&quot;,width)
			.append(&quot;xhtml:div&quot;)
			.style(&quot;background-color&quot;,this.color)
			.html(html);
	}

};</code></pre></span>
          <section id="AnimatedImageTextTile">
            <h1>AnimatedImageTextTile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>AnimatedImageTextTile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>AnimatedImageTextTile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.image]</td>
                <td>string</td>
                <td><p>the url to use as the image,defaults to &quot;../Bellhop/img.two_circles.png&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.text]</td>
                <td>string</td>
                <td><p>the text to display on the panel, defaults to &quot;Title&quot;</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#f0f0f0&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function AnimatedImageTextTile(options){
	this.title = (options.title !== undefined) ? options.title : &quot;Title&quot;;
	ImageTile.apply(this,arguments);
	var self = this;
	$(window).resize(function() {self.draw();} );
	this.draw();
	this.TextIsAnimatingIn = false;
	this.TextIsAnimatingOut = false;
}
AnimatedImageTextTile.prototype = new ImageTile({display:false});
AnimatedImageTextTile.prototype.constructor = AnimatedImageTextTile;</code></pre></span>
          <section id="draw">
            <h1>draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTextTile.prototype.draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>top level draw wrapper around draw_bg and draw_image and draw_text</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTextTile.prototype.draw = function() {
	this.draw_bg();
	this.draw_image();
	this.draw_text();
	//add callbacks to expose the display of the animated text
	var self = this;
	this.link_selection.on('mouseover',function(){self.show_text();});
	this.link_selection.on('mouseout',function(){self.hide_text();});
};</code></pre></span>
          <section id="show_text">
            <h1>show_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTextTile.prototype.show_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>show the text in the Tile</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTextTile.prototype.show_text = function() {
	if (!this.TextIsAnimating){
		$(&quot;#&quot; + this.div_id + &quot;_tile_text&quot;).animate({opacity:1},500);
	}
	this.TextIsAnimating = true;
	var self = this;
	setTimeout(function(){self.TextIsAnimatingIn = false;},500);
};</code></pre></span>
          <section id="hide_text">
            <h1>hide_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTextTile.prototype.hide_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hide the text in the Tile</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTextTile.prototype.hide_text = function() {
	if (!this.TextIsAnimating){
		$(&quot;#&quot; + this.div_id + &quot;_tile_text&quot;).animate({opacity:0},500);
	}
	this.TextIsAnimating = true;
	var self = this;
	setTimeout(function(){self.TextIsAnimatingOut = false;},500);
};</code></pre></span>
          <section id="draw_text">
            <h1>draw_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>AnimatedImageTextTile.prototype.draw_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws the tile&#39;s text using d3.js</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">AnimatedImageTextTile.prototype.draw_text = function() {
	// get the correct height and width to draw
	this.width = $(&quot;#&quot; + this.div_id).outerWidth();
	if (this.tile_type == &quot;small&quot;){
		this.height = 150;
	}else{
		this.height = 300;
	}

	// set up a top level svg selection if the tile needs to be initialized
	if (!this.init_state){
		this.svg=d3.select(&quot;#&quot; + this.div_id).append(&quot;svg&quot;)
			.attr(&quot;class&quot;,this.div_id + &quot;_tile_svg&quot;)
			.attr(&quot;width&quot;,this.width)
			.attr(&quot;height&quot;,this.height);
	}

	// (re)draw the text
	var x,y,height,width,html;
	x = 0;
	y = 20;
	height = this.height - 40;
	width = this.width;
	if (this.tile_type == &quot;wide&quot;){
		html = '&lt;h2&gt;' + this.title + '&lt;/h2&gt;';
	}
	if (this.tile_type == &quot;medium&quot; || this.tile_type == &quot;small&quot;){
		html = '&lt;h3&gt;' + this.title + '&lt;/h3&gt;';
	}
	this.svg.select('.draw_layer').selectAll('.tile_text').data([]).exit().remove();
	this.svg.select('.draw_layer').selectAll('.tile_text').data([this.title])
		.enter().append(&quot;foreignObject&quot;)
		.attr(&quot;class&quot;,&quot;tile_text&quot;)
		.attr(&quot;x&quot;,x)
		.attr(&quot;y&quot;,y)
		.attr(&quot;height&quot;,height)
		.attr(&quot;width&quot;,width)
		.style(&quot;pointer-events&quot;,&quot;none&quot;)
		.append(&quot;xhtml:div&quot;)
		.attr(&quot;id&quot;,this.div_id + &quot;_tile_text&quot;)
		.style(&quot;opacity&quot;,0)
		.style(&quot;background-color&quot;,&quot;#ffffff&quot;)
		.html(html);

};</code></pre></span>
          <section id="FullAnimatedImageTextTile">
            <h1>FullAnimatedImageTextTile</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-success radius ctx-type">constructor</div><span>FullAnimatedImageTextTile()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>FullAnimatedImageTextTile constructor</p> </div>
          <table class="table table-bordered table-striped">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>[options={}]</td>
                <td>object</td>
                <td><p>options object to set properties</p></td>
              </tr>
              <tr>
                <td>[options.image]</td>
                <td>string</td>
                <td><p>the url to use as the image,defaults to &quot;../Bellhop/img.two_circles.png&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_target]</td>
                <td>string</td>
                <td><p>the div id into which to inject html, defaults to &quot;body&quot;</p></td>
              </tr>
              <tr>
                <td>[options.div_id]</td>
                <td>string</td>
                <td><p>the div id for generated html, defaults to &quot;Tile&quot; plus a random number</p></td>
              </tr>
              <tr>
                <td>[options.text]</td>
                <td>string</td>
                <td><p>the text to display on the panel, defaults to &quot;Title&quot;</p></td>
              </tr>
              <tr>
                <td>[options.style]</td>
                <td>string</td>
                <td><p>inline style specification, defaults to &quot;#f0f0f0&quot;</p></td>
              </tr>
              <tr>
                <td>[options.color]</td>
                <td>string</td>
                <td><p>the background color of the tile, defuaults to</p></td>
              </tr>
              <tr>
                <td>[options.tile_type]</td>
                <td>string</td>
                <td><p>tile type, can be &quot;small&quot;, &quot;medium&quot;, or &quot;wide&quot;, defaults to &quot;medium&quot;</p></td>
              </tr>
            </tbody>
          </table><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">function FullAnimatedImageTextTile(options){
	this.title = (options.title !== undefined) ? options.title : &quot;Title&quot;;
	ImageTile.apply(this,arguments);
	var self = this;
	$(window).resize(function() {self.draw();} );
	this.draw();
	this.start_animation();
	this.TextIsAnimatingIn = false;
	this.TextIsAnimatingOut = false;
}
FullAnimatedImageTextTile.prototype = new AnimatedImageTile({display:false});
FullAnimatedImageTextTile.prototype.constructor = FullAnimatedImageTextTile;</code></pre></span>
          <section id="draw">
            <h1>draw</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>FullAnimatedImageTextTile.prototype.draw()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>top level draw wrapper around draw_bg and draw_image and draw_text</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">FullAnimatedImageTextTile.prototype.draw = function() {
	this.draw_bg();
	this.draw_image();
	this.draw_text();
	//add callbacks to expose the display of the animated text
	var self = this;
	this.link_selection.on('mouseover',function(){self.show_text();});
	this.link_selection.on('mouseout',function(){self.hide_text();});
};</code></pre></span>
          <section id="show_text">
            <h1>show_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>FullAnimatedImageTextTile.prototype.show_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>show the text in the Tile</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">FullAnimatedImageTextTile.prototype.show_text = function() {
	if (!this.TextIsAnimatingIn){
		$(&quot;#&quot; + this.div_id + &quot;_tile_text&quot;).animate({opacity:1},500);
	}
	this.TextIsAnimating = true;
	var self = this;
	setTimeout(function(){self.TextIsAnimatingIn = false;},500);
};</code></pre></span>
          <section id="hide_text">
            <h1>hide_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>FullAnimatedImageTextTile.prototype.hide_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>hide the text in the Tile</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">FullAnimatedImageTextTile.prototype.hide_text = function() {
	if (!this.TextIsAnimatingOut){
		$(&quot;#&quot; + this.div_id + &quot;_tile_text&quot;).animate({opacity:0},500);
	}
	this.TextIsAnimating = true;
	var self = this;
	setTimeout(function(){self.TextIsAnimatingOut = false;},500);
};</code></pre></span>
          <section id="draw_text">
            <h1>draw_text</h1>
            <h5 class="subheader"></h5>
            <p>
              <div class="label label-info radius ctx-type">method</div><span>FullAnimatedImageTextTile.prototype.draw_text()</span>
            </p>
          </section>
          <div style="font-family:Roboto Slab" class="description"><p>draws the tile&#39;s text using d3.js</p> </div><span style="cursor: pointer;color: #ff66cc;font-family: Helvetica Neue;font-weight: bold">CLICK TO TOGGLE CODE
            <pre class="tog"><code class="language-javascript">FullAnimatedImageTextTile.prototype.draw_text = function() {
	// get the correct height and width to draw
	this.width = $(&quot;#&quot; + this.div_id).outerWidth();
	if (this.tile_type == &quot;small&quot;){
		this.height = 150;
	}else{
		this.height = 300;
	}

	// set up a top level svg selection if the tile needs to be initialized
	if (!this.init_state){
		this.svg=d3.select(&quot;#&quot; + this.div_id).append(&quot;svg&quot;)
			.attr(&quot;class&quot;,this.div_id + &quot;_tile_svg&quot;)
			.attr(&quot;width&quot;,this.width)
			.attr(&quot;height&quot;,this.height);
	}

	// (re)draw the text
	var x,y,height,width,html;
	x = 0;
	y = 20;
	height = this.height - 40;
	width = this.width;
	if (this.tile_type == &quot;wide&quot;){
		html = '&lt;h2&gt;' + this.title + '&lt;/h2&gt;';
	}
	if (this.tile_type == &quot;medium&quot; || this.tile_type == &quot;small&quot;){
		html = '&lt;h3&gt;' + this.title + '&lt;/h3&gt;';
	}
	this.svg.select('.draw_layer').selectAll('.tile_text').data([]).exit().remove();
	this.svg.select('.draw_layer').selectAll('.tile_text').data([this.title])
		.enter().append(&quot;foreignObject&quot;)
		.attr(&quot;class&quot;,&quot;tile_text&quot;)
		.attr(&quot;x&quot;,x)
		.attr(&quot;y&quot;,y)
		.attr(&quot;height&quot;,height)
		.attr(&quot;width&quot;,width)
		.style(&quot;pointer-events&quot;,&quot;none&quot;)
		.append(&quot;xhtml:body&quot;)
		.attr(&quot;id&quot;,this.div_id + &quot;_tile_text&quot;)
		.attr(&quot;height&quot;,height)
		.attr(&quot;width&quot;,width)
		.style(&quot;background-color&quot;,&quot;#ffffff&quot;)
		.style(&quot;opacity&quot;,0)
		.html(html);

};


//wrap all of our afterword code so we keep the global namespace clean.  All 'global' variables
//will be exposed in the Barista object
(function (){

    //set the user_key from a local file called barista_config if it is present
    //at either /public or /
    if (!Barista.setUserKey('/public/barista_config.json')){
      Barista.setUserKey('/barista_config.json');
    };

    //find all of the barista_target div elements on the page
    var all_divs = $('div');
    var barista_targets = [];
    Barista.generatedViews = {};
    all_divs.each(function () {
        var data_attrs = $(this).data();
        if (_.keys(data_attrs).indexOf('baristaView') !== -1){
            barista_targets.push(this);
        }
    });

    //for each barista target element, instantiate the view and attempt to call the
    //fetch method of its model. For some views this will not work, but many will.
    //The idea is that we want to populate the views with data when we can on page load
    //since the user is not instantiating the view via javascript.  For each target
    //Element we will also try to bind it to any views that it asks to be bound to. The
    //binding is assumed to be a binding between the any events coming out of the source view.
    //the event's 'val' attribute is fed to the view's model.fetch method
    barista_targets.forEach(function(target){
        //grab the view type and make sure it has a unique view name
        var view_num = 0;
        var view_type = $(target).data().baristaView;
        var view_name;
        if ($(target).attr('id')){
            view_name = $(target).attr('id');
        }else{
            view_name = view_type;
        }
        while (_.keys(Barista.generatedViews).indexOf(view_name) !== -1){
            view_num += 1;
            view_name = view_type + view_num;
        }

        //    instantiate the view and register it to the generatedViews object in
        //    Barista
        var view_params = _.extend({el: target},$(target).data());
        Barista.generatedViews[view_name] = new Barista.Views[view_type](view_params);

        //    try to call the view's fetch method and ignore errors that come up since
        //    we expect them for views that don't have models supporting a fetch
        //    operation
        try {
            Barista.generatedViews[view_name].model.fetch('');
        }catch(err){
        }

        //    try to bind views that are specified
        if (_.keys($(target).data()).indexOf('bind') !== -1){
            var bind_target = $(target).data().bind;
            Barista.generatedViews[view_name].listenTo(Barista.generatedViews[bind_target],'all',function(event_name, e){
                Barista.generatedViews[view_name].model.fetch(e.val);
            });
        }
    });
}());</code></pre></span>
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="container">
        <p>Documentation generated with <a href="https://github.com/FGRibreau/doxx">Doxx </a> created by <a href="https://twitter.com/FGRibreau" data-show-count="false" class="twitter-follow-button">Francois-Guillaume Ribreau </a></p>
        <p>Doxx is sponsored by <a href="http://bringr.net/?btt" title="Outil d'analyse des rseaux sociaux" class="bringr">Bringr </a> and <a href="https://redsmin.com/?btt" title="Full Redis GUI" class="redsmin">Redsmin</a></p>
        <p>Theme borrowed from Twitter Bootstrap</p>
      </div>
    </footer>
    <script src="http://platform.twitter.com/widgets.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    <script src="http://leaverou.github.com/prefixfree/prefixfree.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-transition.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-collapse.js"></script>
    <script src="http://getbootstrap.com/2.3.2/assets/js/bootstrap-affix.js"></script>
    <script>
      /**
       * Prism: Lightweight, robust, elegant syntax highlighting
       * MIT license http://www.opensource.org/licenses/mit-license.php/
       * @author Lea Verou http://lea.verou.me
       */(function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e){n.call(e,r,e[r]);t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;if(a){o=(a.className.match(e)||[,""])[1];u=t.languages[o]}if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o;a=r.parentNode;/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data));l.element.innerHTML=l.highlightedCode;s&&s.call(l.element);t.hooks.run("after-highlight",l)};c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else{l.highlightedCode=t.highlight(l.code,l.grammar);l.element.innerHTML=l.highlightedCode;s&&s.call(r);t.hooks.run("after-highlight",l)}},highlight:function(e,r){return n.stringify(t.tokenize(e,r))},tokenize:function(e,n){var r=t.Token,i=[e],s=n.rest;if(s){for(var o in s)n[o]=s[o];delete n.rest}e:for(var o in n){if(!n.hasOwnProperty(o)||!n[o])continue;var u=n[o],a=u.inside,f=!!u.lookbehind||0;u=u.pattern||u;for(var l=0;l<i.length;l++){var c=i[l];if(i.length>e.length)break e;if(c instanceof r)continue;u.lastIndex=0;var h=u.exec(c);if(h){f&&(f=h[1].length);var p=h.index-1+f,h=h[0].slice(f),d=h.length,v=p+d,m=c.slice(0,p+1),g=c.slice(v+1),y=[l,1];m&&y.push(m);var b=new r(o,a?t.tokenize(h,a):h);y.push(b);g&&y.push(g);Array.prototype.splice.apply(i,y)}}}return i},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[];r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e;this.content=t};n.stringify=function(e){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]"){for(var r=0;r<e.length;r++)e[r]=n.stringify(e[r]);return e.join("")}var i={type:e.type,content:n.stringify(e.content),tag:"span",classes:["token",e.type],attributes:{}};i.type=="comment"&&(i.attributes.spellcheck="true");t.hooks.run("wrap",i);var s="";for(var o in i.attributes)s+=o+'="'+(i.attributes[o]||"")+'"';return"<"+i.tag+' class="'+i.classes.join(" ")+'" '+s+">"+i.content+"</"+i.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r])));self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1];if(r){t.filename=r.src;document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)}})();;
      Prism.languages.markup={comment:/&lt;!--[\w\W]*?--(&gt;|&gt;)/g,prolog:/&lt;\?.+?\?&gt;/,doctype:/&lt;!DOCTYPE.+?&gt;/,cdata:/&lt;!\[CDATA\[[\w\W]+?]]&gt;/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?&gt;/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|&gt;|"/g}},punctuation:/\/?&gt;/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi};Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});;
      Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:/@[\w-]+?(\s+[^;{]+)?(?=\s*{|\s*;)/gi,url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,property:/(\b|\B)[a-z-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g};Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}});;
      Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g};;
      Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|catch|finally|null|break|continue)\b/g,number:/\b(-?(0x)?\d*\.?[\da-f]+|NaN|-?Infinity)\b/g});Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}});Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}});;
    </script>
    <!-- App js-->
    <script>
      $(function(){
        var $window = $(window);
        $('.scrollspy .nav').affix({
          offset: {
            top: function () { return $window.width() <= 980 ? 480 : 400 }
          , bottom: 50
          }
        });
      })
    </script>
  </body>
</html>